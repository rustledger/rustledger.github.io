
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Web interface for rustledger, a Rust-based Beancount parser">
      
      
      
        <link rel="canonical" href="https://rustledger.github.io/rustfava/docs/api/">
      
      
        <link rel="prev" href="../deployment/">
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>API Reference - Rustfava</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Rustfava" class="md-header__button md-logo" aria-label="Rustfava" data-md-component="logo">
      
  <img src="../logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Rustfava
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/rustledger/rustfava" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    rustledger/rustfava
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Rustfava" class="md-nav__button md-logo" aria-label="Rustfava" data-md-component="logo">
      
  <img src="../logo.svg" alt="logo">

    </a>
    Rustfava
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/rustledger/rustfava" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    rustledger/rustfava
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Development
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deployment
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-modules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Modules
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rustfava.core" class="md-nav__link">
    <span class="md-ellipsis">
      
        core
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="core">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.EntryNotFoundForHashError" class="md-nav__link">
    <span class="md-ellipsis">
      
        EntryNotFoundForHashError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.StatementNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      
        StatementNotFoundError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.StatementMetadataInvalidError" class="md-nav__link">
    <span class="md-ellipsis">
      
        StatementMetadataInvalidError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.JournalPage" class="md-nav__link">
    <span class="md-ellipsis">
      
        JournalPage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger" class="md-nav__link">
    <span class="md-ellipsis">
      
        FilteredLedger
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FilteredLedger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.end_date" class="md-nav__link">
    <span class="md-ellipsis">
      
        end_date
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.entries_with_all_prices" class="md-nav__link">
    <span class="md-ellipsis">
      
        entries_with_all_prices
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.entries_without_prices" class="md-nav__link">
    <span class="md-ellipsis">
      
        entries_without_prices
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.root_tree" class="md-nav__link">
    <span class="md-ellipsis">
      
        root_tree
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.root_tree_closed" class="md-nav__link">
    <span class="md-ellipsis">
      
        root_tree_closed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.interval_ranges" class="md-nav__link">
    <span class="md-ellipsis">
      
        interval_ranges
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.prices" class="md-nav__link">
    <span class="md-ellipsis">
      
        prices
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.account_is_closed" class="md-nav__link">
    <span class="md-ellipsis">
      
        account_is_closed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.paginate_journal" class="md-nav__link">
    <span class="md-ellipsis">
      
        paginate_journal
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger" class="md-nav__link">
    <span class="md-ellipsis">
      
        RustfavaLedger
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RustfavaLedger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.mtime" class="md-nav__link">
    <span class="md-ellipsis">
      
        mtime
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        errors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.root_accounts" class="md-nav__link">
    <span class="md-ellipsis">
      
        root_accounts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.load_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.join_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        join_path
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.paths_to_watch" class="md-nav__link">
    <span class="md-ellipsis">
      
        paths_to_watch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.changed" class="md-nav__link">
    <span class="md-ellipsis">
      
        changed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.interval_balances" class="md-nav__link">
    <span class="md-ellipsis">
      
        interval_balances
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.account_journal" class="md-nav__link">
    <span class="md-ellipsis">
      
        account_journal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.context" class="md-nav__link">
    <span class="md-ellipsis">
      
        context
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.commodity_pairs" class="md-nav__link">
    <span class="md-ellipsis">
      
        commodity_pairs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.statement_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        statement_path
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts" class="md-nav__link">
    <span class="md-ellipsis">
      
        accounts
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="accounts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts.LastEntry" class="md-nav__link">
    <span class="md-ellipsis">
      
        LastEntry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts.AccountData" class="md-nav__link">
    <span class="md-ellipsis">
      
        AccountData
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts.AccountDict" class="md-nav__link">
    <span class="md-ellipsis">
      
        AccountDict
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AccountDict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts.AccountDict.setdefault" class="md-nav__link">
    <span class="md-ellipsis">
      
        setdefault
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts.AccountDict.all_balance_directives" class="md-nav__link">
    <span class="md-ellipsis">
      
        all_balance_directives
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts.get_last_entry" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_last_entry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts.uptodate_status" class="md-nav__link">
    <span class="md-ellipsis">
      
        uptodate_status
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts.balance_string" class="md-nav__link">
    <span class="md-ellipsis">
      
        balance_string
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.attributes.AttributesModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        AttributesModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AttributesModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.attributes.AttributesModule.narrations" class="md-nav__link">
    <span class="md-ellipsis">
      
        narrations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.attributes.AttributesModule.payee_accounts" class="md-nav__link">
    <span class="md-ellipsis">
      
        payee_accounts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.attributes.AttributesModule.payee_transaction" class="md-nav__link">
    <span class="md-ellipsis">
      
        payee_transaction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.attributes.AttributesModule.narration_transaction" class="md-nav__link">
    <span class="md-ellipsis">
      
        narration_transaction
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.attributes.get_active_years" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_active_years
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets" class="md-nav__link">
    <span class="md-ellipsis">
      
        budgets
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="budgets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.BudgetDict" class="md-nav__link">
    <span class="md-ellipsis">
      
        BudgetDict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.Budget" class="md-nav__link">
    <span class="md-ellipsis">
      
        Budget
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.BudgetError" class="md-nav__link">
    <span class="md-ellipsis">
      
        BudgetError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.BudgetModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        BudgetModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BudgetModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.BudgetModule.calculate" class="md-nav__link">
    <span class="md-ellipsis">
      
        calculate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.BudgetModule.calculate_children" class="md-nav__link">
    <span class="md-ellipsis">
      
        calculate_children
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.parse_budgets" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_budgets
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.calculate_budget" class="md-nav__link">
    <span class="md-ellipsis">
      
        calculate_budget
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.calculate_budget_children" class="md-nav__link">
    <span class="md-ellipsis">
      
        calculate_budget_children
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts" class="md-nav__link">
    <span class="md-ellipsis">
      
        charts
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="charts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.RustfavaJSONProvider" class="md-nav__link">
    <span class="md-ellipsis">
      
        RustfavaJSONProvider
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.DateAndBalance" class="md-nav__link">
    <span class="md-ellipsis">
      
        DateAndBalance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.DateAndBalanceWithBudget" class="md-nav__link">
    <span class="md-ellipsis">
      
        DateAndBalanceWithBudget
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.ChartModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        ChartModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChartModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.ChartModule.hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      
        hierarchy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.ChartModule.interval_totals" class="md-nav__link">
    <span class="md-ellipsis">
      
        interval_totals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.ChartModule.linechart" class="md-nav__link">
    <span class="md-ellipsis">
      
        linechart
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.ChartModule.net_worth" class="md-nav__link">
    <span class="md-ellipsis">
      
        net_worth
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.dumps" class="md-nav__link">
    <span class="md-ellipsis">
      
        dumps
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.loads" class="md-nav__link">
    <span class="md-ellipsis">
      
        loads
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.commodities" class="md-nav__link">
    <span class="md-ellipsis">
      
        commodities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="commodities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.commodities.CommoditiesModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        CommoditiesModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CommoditiesModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.commodities.CommoditiesModule.name" class="md-nav__link">
    <span class="md-ellipsis">
      
        name
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.conversion" class="md-nav__link">
    <span class="md-ellipsis">
      
        conversion
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="conversion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.conversion.Conversion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conversion
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Conversion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.conversion.Conversion.apply" class="md-nav__link">
    <span class="md-ellipsis">
      
        apply
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.conversion.get_cost" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_cost
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.conversion.get_market_value" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_market_value
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.conversion.convert_position" class="md-nav__link">
    <span class="md-ellipsis">
      
        convert_position
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.conversion.conversion_from_str" class="md-nav__link">
    <span class="md-ellipsis">
      
        conversion_from_str
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.conversion.cost_or_value" class="md-nav__link">
    <span class="md-ellipsis">
      
        cost_or_value
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.documents" class="md-nav__link">
    <span class="md-ellipsis">
      
        documents
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="documents">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.documents.NotADocumentsFolderError" class="md-nav__link">
    <span class="md-ellipsis">
      
        NotADocumentsFolderError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.documents.NotAValidAccountError" class="md-nav__link">
    <span class="md-ellipsis">
      
        NotAValidAccountError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.documents.is_document_or_import_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_document_or_import_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.documents.filepath_in_document_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        filepath_in_document_folder
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions" class="md-nav__link">
    <span class="md-ellipsis">
      
        extensions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extensions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionDetails" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExtensionDetails
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExtensionModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ExtensionModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.extension_details" class="md-nav__link">
    <span class="md-ellipsis">
      
        extension_details
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.get_extension" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_extension
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.after_load_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        after_load_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.before_request" class="md-nav__link">
    <span class="md-ellipsis">
      
        before_request
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.after_entry_modified" class="md-nav__link">
    <span class="md-ellipsis">
      
        after_entry_modified
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.after_insert_entry" class="md-nav__link">
    <span class="md-ellipsis">
      
        after_insert_entry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.after_delete_entry" class="md-nav__link">
    <span class="md-ellipsis">
      
        after_delete_entry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.after_insert_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      
        after_insert_metadata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.after_write_source" class="md-nav__link">
    <span class="md-ellipsis">
      
        after_write_source
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options" class="md-nav__link">
    <span class="md-ellipsis">
      
        fava_options
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="fava_options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.OptionError" class="md-nav__link">
    <span class="md-ellipsis">
      
        OptionError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.InsertEntryOption" class="md-nav__link">
    <span class="md-ellipsis">
      
        InsertEntryOption
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.RustfavaOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        RustfavaOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RustfavaOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.RustfavaOptions.set_collapse_pattern" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_collapse_pattern
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.RustfavaOptions.set_default_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_default_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.RustfavaOptions.set_fiscal_year_end" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_fiscal_year_end
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.RustfavaOptions.set_import_dirs" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_import_dirs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.RustfavaOptions.set_insert_entry" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_insert_entry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.RustfavaOptions.set_language" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_language
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.RustfavaOptions.set_locale" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_locale
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.parse_option_custom_entry" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_option_custom_entry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.parse_options" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_options
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file" class="md-nav__link">
    <span class="md-ellipsis">
      
        file
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.NonSourceFileError" class="md-nav__link">
    <span class="md-ellipsis">
      
        NonSourceFileError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.ExternallyChangedError" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExternallyChangedError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.GeneratedEntryError" class="md-nav__link">
    <span class="md-ellipsis">
      
        GeneratedEntryError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.InvalidUnicodeError" class="md-nav__link">
    <span class="md-ellipsis">
      
        InvalidUnicodeError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.FileModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        FileModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FileModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.FileModule.get_source" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_source
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.FileModule.set_source" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_source
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.FileModule.insert_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_metadata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.FileModule.save_entry_slice" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_entry_slice
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.FileModule.delete_entry_slice" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_entry_slice
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.FileModule.insert_entries" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_entries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.FileModule.render_entries" class="md-nav__link">
    <span class="md-ellipsis">
      
        render_entries
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.insert_metadata_in_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_metadata_in_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.find_entry_lines" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_entry_lines
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.get_entry_slice" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_entry_slice
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.save_entry_slice" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_entry_slice
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.delete_entry_slice" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_entry_slice
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.insert_entry" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_entry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.find_insert_position" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_insert_position
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters" class="md-nav__link">
    <span class="md-ellipsis">
      
        filters
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="filters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterError" class="md-nav__link">
    <span class="md-ellipsis">
      
        FilterError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterParseError" class="md-nav__link">
    <span class="md-ellipsis">
      
        FilterParseError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterIllegalCharError" class="md-nav__link">
    <span class="md-ellipsis">
      
        FilterIllegalCharError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.TimeFilterParseError" class="md-nav__link">
    <span class="md-ellipsis">
      
        TimeFilterParseError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.Token" class="md-nav__link">
    <span class="md-ellipsis">
      
        Token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxLexer" class="md-nav__link">
    <span class="md-ellipsis">
      
        FilterSyntaxLexer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FilterSyntaxLexer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxLexer.lex" class="md-nav__link">
    <span class="md-ellipsis">
      
        lex
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.Match" class="md-nav__link">
    <span class="md-ellipsis">
      
        Match
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.MatchAmount" class="md-nav__link">
    <span class="md-ellipsis">
      
        MatchAmount
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser" class="md-nav__link">
    <span class="md-ellipsis">
      
        FilterSyntaxParser
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FilterSyntaxParser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_filter" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_filter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_expr" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_expr
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_all" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_expr_all
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_any" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_expr_any
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_parentheses" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_expr_parentheses
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_and" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_expr_and
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_or" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_expr_or
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_negated" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_expr_negated
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_simple_expr_TAG" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_simple_expr_TAG
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_simple_expr_LINK" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_simple_expr_LINK
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_simple_expr_STRING" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_simple_expr_STRING
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_simple_expr_key" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_simple_expr_key
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_simple_expr_units" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_simple_expr_units
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.EntryFilter" class="md-nav__link">
    <span class="md-ellipsis">
      
        EntryFilter
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EntryFilter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.EntryFilter.apply" class="md-nav__link">
    <span class="md-ellipsis">
      
        apply
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.TimeFilter" class="md-nav__link">
    <span class="md-ellipsis">
      
        TimeFilter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.AdvancedFilter" class="md-nav__link">
    <span class="md-ellipsis">
      
        AdvancedFilter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.AccountFilter" class="md-nav__link">
    <span class="md-ellipsis">
      
        AccountFilter
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.group_entries" class="md-nav__link">
    <span class="md-ellipsis">
      
        group_entries
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="group_entries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.group_entries.EntriesByType" class="md-nav__link">
    <span class="md-ellipsis">
      
        EntriesByType
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.group_entries.TransactionPosting" class="md-nav__link">
    <span class="md-ellipsis">
      
        TransactionPosting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.group_entries.group_entries_by_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        group_entries_by_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.group_entries.group_entries_by_account" class="md-nav__link">
    <span class="md-ellipsis">
      
        group_entries_by_account
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest" class="md-nav__link">
    <span class="md-ellipsis">
      
        ingest
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ingest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.IngestError" class="md-nav__link">
    <span class="md-ellipsis">
      
        IngestError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.ImporterMethodCallError" class="md-nav__link">
    <span class="md-ellipsis">
      
        ImporterMethodCallError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.ImporterInvalidTypeError" class="md-nav__link">
    <span class="md-ellipsis">
      
        ImporterInvalidTypeError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.ImporterExtractError" class="md-nav__link">
    <span class="md-ellipsis">
      
        ImporterExtractError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.MissingImporterConfigError" class="md-nav__link">
    <span class="md-ellipsis">
      
        MissingImporterConfigError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.MissingImporterDirsError" class="md-nav__link">
    <span class="md-ellipsis">
      
        MissingImporterDirsError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.ImportConfigLoadError" class="md-nav__link">
    <span class="md-ellipsis">
      
        ImportConfigLoadError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.FileImportInfo" class="md-nav__link">
    <span class="md-ellipsis">
      
        FileImportInfo
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.FileImporters" class="md-nav__link">
    <span class="md-ellipsis">
      
        FileImporters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.WrappedImporter" class="md-nav__link">
    <span class="md-ellipsis">
      
        WrappedImporter
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WrappedImporter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.WrappedImporter.name" class="md-nav__link">
    <span class="md-ellipsis">
      
        name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.WrappedImporter.identify" class="md-nav__link">
    <span class="md-ellipsis">
      
        identify
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.WrappedImporter.file_import_info" class="md-nav__link">
    <span class="md-ellipsis">
      
        file_import_info
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.IngestModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        IngestModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IngestModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.IngestModule.module_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        module_path
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.IngestModule.import_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        import_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.IngestModule.extract" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.walk_dir" class="md-nav__link">
    <span class="md-ellipsis">
      
        walk_dir
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.get_cached_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_cached_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.find_imports" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_imports
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.extract_from_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_from_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.load_import_config" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_import_config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.filepath_in_primary_imports_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        filepath_in_primary_imports_folder
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory" class="md-nav__link">
    <span class="md-ellipsis">
      
        inventory
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="inventory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.SimpleCounterInventory" class="md-nav__link">
    <span class="md-ellipsis">
      
        SimpleCounterInventory
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SimpleCounterInventory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.SimpleCounterInventory.is_empty" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_empty
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.SimpleCounterInventory.add" class="md-nav__link">
    <span class="md-ellipsis">
      
        add
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.SimpleCounterInventory.reduce" class="md-nav__link">
    <span class="md-ellipsis">
      
        reduce
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.CounterInventory" class="md-nav__link">
    <span class="md-ellipsis">
      
        CounterInventory
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CounterInventory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.CounterInventory.is_empty" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_empty
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.CounterInventory.add" class="md-nav__link">
    <span class="md-ellipsis">
      
        add
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.CounterInventory.to_strings" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_strings
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.CounterInventory.reduce" class="md-nav__link">
    <span class="md-ellipsis">
      
        reduce
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.CounterInventory.add_amount" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_amount
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.CounterInventory.add_position" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_position
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.CounterInventory.add_inventory" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_inventory
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.misc" class="md-nav__link">
    <span class="md-ellipsis">
      
        misc
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="misc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.misc.FavaError" class="md-nav__link">
    <span class="md-ellipsis">
      
        FavaError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.misc.FavaMisc" class="md-nav__link">
    <span class="md-ellipsis">
      
        FavaMisc
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FavaMisc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.misc.FavaMisc.errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        errors
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.misc.sidebar_links" class="md-nav__link">
    <span class="md-ellipsis">
      
        sidebar_links
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.misc.upcoming_events" class="md-nav__link">
    <span class="md-ellipsis">
      
        upcoming_events
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.misc.align" class="md-nav__link">
    <span class="md-ellipsis">
      
        align
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.module_base" class="md-nav__link">
    <span class="md-ellipsis">
      
        module_base
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="module_base">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.module_base.FavaModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        FavaModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FavaModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.module_base.FavaModule.load_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_file
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.number" class="md-nav__link">
    <span class="md-ellipsis">
      
        number
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="number">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.number.DecimalFormatModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        DecimalFormatModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DecimalFormatModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.number.DecimalFormatModule.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __call__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.number.get_locale_format" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_locale_format
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query" class="md-nav__link">
    <span class="md-ellipsis">
      
        query
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="query">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.QueryResultTable" class="md-nav__link">
    <span class="md-ellipsis">
      
        QueryResultTable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.QueryResultText" class="md-nav__link">
    <span class="md-ellipsis">
      
        QueryResultText
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.BaseColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        BaseColumn
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseColumn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.BaseColumn.serialise" class="md-nav__link">
    <span class="md-ellipsis">
      
        serialise
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.BoolColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        BoolColumn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.DecimalColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        DecimalColumn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.IntColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        IntColumn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.StrColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        StrColumn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.DateColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        DateColumn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.PositionColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        PositionColumn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.SetColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        SetColumn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.AmountColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        AmountColumn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.ObjectColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        ObjectColumn
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ObjectColumn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.ObjectColumn.serialise" class="md-nav__link">
    <span class="md-ellipsis">
      
        serialise
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.InventoryColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        InventoryColumn
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="InventoryColumn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.InventoryColumn.serialise" class="md-nav__link">
    <span class="md-ellipsis">
      
        serialise
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell" class="md-nav__link">
    <span class="md-ellipsis">
      
        query_shell
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="query_shell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.FavaShellError" class="md-nav__link">
    <span class="md-ellipsis">
      
        FavaShellError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.QueryNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      
        QueryNotFoundError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.TooManyRunArgsError" class="md-nav__link">
    <span class="md-ellipsis">
      
        TooManyRunArgsError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.QueryCompilationError" class="md-nav__link">
    <span class="md-ellipsis">
      
        QueryCompilationError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.QueryParseError" class="md-nav__link">
    <span class="md-ellipsis">
      
        QueryParseError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.NonExportableQueryError" class="md-nav__link">
    <span class="md-ellipsis">
      
        NonExportableQueryError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.FavaQueryRunner" class="md-nav__link">
    <span class="md-ellipsis">
      
        FavaQueryRunner
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FavaQueryRunner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.FavaQueryRunner.run" class="md-nav__link">
    <span class="md-ellipsis">
      
        run
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.QueryShell" class="md-nav__link">
    <span class="md-ellipsis">
      
        QueryShell
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QueryShell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.QueryShell.execute_query_serialised" class="md-nav__link">
    <span class="md-ellipsis">
      
        execute_query_serialised
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.QueryShell.query_to_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        query_to_file
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree" class="md-nav__link">
    <span class="md-ellipsis">
      
        tree
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="tree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.SerialisedTreeNode" class="md-nav__link">
    <span class="md-ellipsis">
      
        SerialisedTreeNode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.TreeNode" class="md-nav__link">
    <span class="md-ellipsis">
      
        TreeNode
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TreeNode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.TreeNode.serialise" class="md-nav__link">
    <span class="md-ellipsis">
      
        serialise
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.TreeNode.serialise_with_context" class="md-nav__link">
    <span class="md-ellipsis">
      
        serialise_with_context
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.Tree" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tree
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.Tree.accounts" class="md-nav__link">
    <span class="md-ellipsis">
      
        accounts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.Tree.ancestors" class="md-nav__link">
    <span class="md-ellipsis">
      
        ancestors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.Tree.insert" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.Tree.get" class="md-nav__link">
    <span class="md-ellipsis">
      
        get
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.Tree.net_profit" class="md-nav__link">
    <span class="md-ellipsis">
      
        net_profit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.Tree.cap" class="md-nav__link">
    <span class="md-ellipsis">
      
        cap
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher" class="md-nav__link">
    <span class="md-ellipsis">
      
        watcher
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="watcher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.WatcherBase" class="md-nav__link">
    <span class="md-ellipsis">
      
        WatcherBase
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WatcherBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.WatcherBase.last_checked" class="md-nav__link">
    <span class="md-ellipsis">
      
        last_checked
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.WatcherBase.last_notified" class="md-nav__link">
    <span class="md-ellipsis">
      
        last_notified
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.WatcherBase.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.WatcherBase.check" class="md-nav__link">
    <span class="md-ellipsis">
      
        check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.WatcherBase.notify" class="md-nav__link">
    <span class="md-ellipsis">
      
        notify
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.WatchfilesWatcher" class="md-nav__link">
    <span class="md-ellipsis">
      
        WatchfilesWatcher
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WatchfilesWatcher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.WatchfilesWatcher.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        update
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.Watcher" class="md-nav__link">
    <span class="md-ellipsis">
      
        Watcher
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Watcher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.Watcher.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        update
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#application" class="md-nav__link">
    <span class="md-ellipsis">
      
        Application
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rustfava.application" class="md-nav__link">
    <span class="md-ellipsis">
      
        application
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="application">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.application.static_url" class="md-nav__link">
    <span class="md-ellipsis">
      
        static_url
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.application.url_for" class="md-nav__link">
    <span class="md-ellipsis">
      
        url_for
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.application.translations" class="md-nav__link">
    <span class="md-ellipsis">
      
        translations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.application.create_app" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_app
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cli" class="md-nav__link">
    <span class="md-ellipsis">
      
        CLI
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rustfava.cli" class="md-nav__link">
    <span class="md-ellipsis">
      
        cli
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cli">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.cli.main" class="md-nav__link">
    <span class="md-ellipsis">
      
        main
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-modules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Modules
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rustfava.core" class="md-nav__link">
    <span class="md-ellipsis">
      
        core
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="core">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.EntryNotFoundForHashError" class="md-nav__link">
    <span class="md-ellipsis">
      
        EntryNotFoundForHashError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.StatementNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      
        StatementNotFoundError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.StatementMetadataInvalidError" class="md-nav__link">
    <span class="md-ellipsis">
      
        StatementMetadataInvalidError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.JournalPage" class="md-nav__link">
    <span class="md-ellipsis">
      
        JournalPage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger" class="md-nav__link">
    <span class="md-ellipsis">
      
        FilteredLedger
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FilteredLedger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.end_date" class="md-nav__link">
    <span class="md-ellipsis">
      
        end_date
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.entries_with_all_prices" class="md-nav__link">
    <span class="md-ellipsis">
      
        entries_with_all_prices
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.entries_without_prices" class="md-nav__link">
    <span class="md-ellipsis">
      
        entries_without_prices
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.root_tree" class="md-nav__link">
    <span class="md-ellipsis">
      
        root_tree
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.root_tree_closed" class="md-nav__link">
    <span class="md-ellipsis">
      
        root_tree_closed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.interval_ranges" class="md-nav__link">
    <span class="md-ellipsis">
      
        interval_ranges
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.prices" class="md-nav__link">
    <span class="md-ellipsis">
      
        prices
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.account_is_closed" class="md-nav__link">
    <span class="md-ellipsis">
      
        account_is_closed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.FilteredLedger.paginate_journal" class="md-nav__link">
    <span class="md-ellipsis">
      
        paginate_journal
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger" class="md-nav__link">
    <span class="md-ellipsis">
      
        RustfavaLedger
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RustfavaLedger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.mtime" class="md-nav__link">
    <span class="md-ellipsis">
      
        mtime
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        errors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.root_accounts" class="md-nav__link">
    <span class="md-ellipsis">
      
        root_accounts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.load_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.join_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        join_path
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.paths_to_watch" class="md-nav__link">
    <span class="md-ellipsis">
      
        paths_to_watch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.changed" class="md-nav__link">
    <span class="md-ellipsis">
      
        changed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.interval_balances" class="md-nav__link">
    <span class="md-ellipsis">
      
        interval_balances
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.account_journal" class="md-nav__link">
    <span class="md-ellipsis">
      
        account_journal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.context" class="md-nav__link">
    <span class="md-ellipsis">
      
        context
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.commodity_pairs" class="md-nav__link">
    <span class="md-ellipsis">
      
        commodity_pairs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.RustfavaLedger.statement_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        statement_path
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts" class="md-nav__link">
    <span class="md-ellipsis">
      
        accounts
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="accounts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts.LastEntry" class="md-nav__link">
    <span class="md-ellipsis">
      
        LastEntry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts.AccountData" class="md-nav__link">
    <span class="md-ellipsis">
      
        AccountData
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts.AccountDict" class="md-nav__link">
    <span class="md-ellipsis">
      
        AccountDict
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AccountDict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts.AccountDict.setdefault" class="md-nav__link">
    <span class="md-ellipsis">
      
        setdefault
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts.AccountDict.all_balance_directives" class="md-nav__link">
    <span class="md-ellipsis">
      
        all_balance_directives
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts.get_last_entry" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_last_entry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts.uptodate_status" class="md-nav__link">
    <span class="md-ellipsis">
      
        uptodate_status
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.accounts.balance_string" class="md-nav__link">
    <span class="md-ellipsis">
      
        balance_string
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.attributes.AttributesModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        AttributesModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AttributesModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.attributes.AttributesModule.narrations" class="md-nav__link">
    <span class="md-ellipsis">
      
        narrations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.attributes.AttributesModule.payee_accounts" class="md-nav__link">
    <span class="md-ellipsis">
      
        payee_accounts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.attributes.AttributesModule.payee_transaction" class="md-nav__link">
    <span class="md-ellipsis">
      
        payee_transaction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.attributes.AttributesModule.narration_transaction" class="md-nav__link">
    <span class="md-ellipsis">
      
        narration_transaction
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.attributes.get_active_years" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_active_years
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets" class="md-nav__link">
    <span class="md-ellipsis">
      
        budgets
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="budgets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.BudgetDict" class="md-nav__link">
    <span class="md-ellipsis">
      
        BudgetDict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.Budget" class="md-nav__link">
    <span class="md-ellipsis">
      
        Budget
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.BudgetError" class="md-nav__link">
    <span class="md-ellipsis">
      
        BudgetError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.BudgetModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        BudgetModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BudgetModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.BudgetModule.calculate" class="md-nav__link">
    <span class="md-ellipsis">
      
        calculate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.BudgetModule.calculate_children" class="md-nav__link">
    <span class="md-ellipsis">
      
        calculate_children
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.parse_budgets" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_budgets
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.calculate_budget" class="md-nav__link">
    <span class="md-ellipsis">
      
        calculate_budget
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.budgets.calculate_budget_children" class="md-nav__link">
    <span class="md-ellipsis">
      
        calculate_budget_children
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts" class="md-nav__link">
    <span class="md-ellipsis">
      
        charts
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="charts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.RustfavaJSONProvider" class="md-nav__link">
    <span class="md-ellipsis">
      
        RustfavaJSONProvider
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.DateAndBalance" class="md-nav__link">
    <span class="md-ellipsis">
      
        DateAndBalance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.DateAndBalanceWithBudget" class="md-nav__link">
    <span class="md-ellipsis">
      
        DateAndBalanceWithBudget
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.ChartModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        ChartModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ChartModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.ChartModule.hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      
        hierarchy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.ChartModule.interval_totals" class="md-nav__link">
    <span class="md-ellipsis">
      
        interval_totals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.ChartModule.linechart" class="md-nav__link">
    <span class="md-ellipsis">
      
        linechart
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.ChartModule.net_worth" class="md-nav__link">
    <span class="md-ellipsis">
      
        net_worth
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.dumps" class="md-nav__link">
    <span class="md-ellipsis">
      
        dumps
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.charts.loads" class="md-nav__link">
    <span class="md-ellipsis">
      
        loads
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.commodities" class="md-nav__link">
    <span class="md-ellipsis">
      
        commodities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="commodities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.commodities.CommoditiesModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        CommoditiesModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CommoditiesModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.commodities.CommoditiesModule.name" class="md-nav__link">
    <span class="md-ellipsis">
      
        name
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.conversion" class="md-nav__link">
    <span class="md-ellipsis">
      
        conversion
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="conversion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.conversion.Conversion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conversion
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Conversion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.conversion.Conversion.apply" class="md-nav__link">
    <span class="md-ellipsis">
      
        apply
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.conversion.get_cost" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_cost
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.conversion.get_market_value" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_market_value
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.conversion.convert_position" class="md-nav__link">
    <span class="md-ellipsis">
      
        convert_position
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.conversion.conversion_from_str" class="md-nav__link">
    <span class="md-ellipsis">
      
        conversion_from_str
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.conversion.cost_or_value" class="md-nav__link">
    <span class="md-ellipsis">
      
        cost_or_value
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.documents" class="md-nav__link">
    <span class="md-ellipsis">
      
        documents
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="documents">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.documents.NotADocumentsFolderError" class="md-nav__link">
    <span class="md-ellipsis">
      
        NotADocumentsFolderError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.documents.NotAValidAccountError" class="md-nav__link">
    <span class="md-ellipsis">
      
        NotAValidAccountError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.documents.is_document_or_import_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_document_or_import_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.documents.filepath_in_document_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        filepath_in_document_folder
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions" class="md-nav__link">
    <span class="md-ellipsis">
      
        extensions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extensions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionDetails" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExtensionDetails
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExtensionModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ExtensionModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.extension_details" class="md-nav__link">
    <span class="md-ellipsis">
      
        extension_details
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.get_extension" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_extension
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.after_load_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        after_load_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.before_request" class="md-nav__link">
    <span class="md-ellipsis">
      
        before_request
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.after_entry_modified" class="md-nav__link">
    <span class="md-ellipsis">
      
        after_entry_modified
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.after_insert_entry" class="md-nav__link">
    <span class="md-ellipsis">
      
        after_insert_entry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.after_delete_entry" class="md-nav__link">
    <span class="md-ellipsis">
      
        after_delete_entry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.after_insert_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      
        after_insert_metadata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.extensions.ExtensionModule.after_write_source" class="md-nav__link">
    <span class="md-ellipsis">
      
        after_write_source
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options" class="md-nav__link">
    <span class="md-ellipsis">
      
        fava_options
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="fava_options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.OptionError" class="md-nav__link">
    <span class="md-ellipsis">
      
        OptionError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.InsertEntryOption" class="md-nav__link">
    <span class="md-ellipsis">
      
        InsertEntryOption
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.RustfavaOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        RustfavaOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RustfavaOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.RustfavaOptions.set_collapse_pattern" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_collapse_pattern
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.RustfavaOptions.set_default_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_default_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.RustfavaOptions.set_fiscal_year_end" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_fiscal_year_end
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.RustfavaOptions.set_import_dirs" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_import_dirs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.RustfavaOptions.set_insert_entry" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_insert_entry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.RustfavaOptions.set_language" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_language
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.RustfavaOptions.set_locale" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_locale
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.parse_option_custom_entry" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_option_custom_entry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.fava_options.parse_options" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_options
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file" class="md-nav__link">
    <span class="md-ellipsis">
      
        file
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.NonSourceFileError" class="md-nav__link">
    <span class="md-ellipsis">
      
        NonSourceFileError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.ExternallyChangedError" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExternallyChangedError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.GeneratedEntryError" class="md-nav__link">
    <span class="md-ellipsis">
      
        GeneratedEntryError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.InvalidUnicodeError" class="md-nav__link">
    <span class="md-ellipsis">
      
        InvalidUnicodeError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.FileModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        FileModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FileModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.FileModule.get_source" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_source
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.FileModule.set_source" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_source
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.FileModule.insert_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_metadata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.FileModule.save_entry_slice" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_entry_slice
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.FileModule.delete_entry_slice" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_entry_slice
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.FileModule.insert_entries" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_entries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.FileModule.render_entries" class="md-nav__link">
    <span class="md-ellipsis">
      
        render_entries
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.insert_metadata_in_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_metadata_in_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.find_entry_lines" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_entry_lines
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.get_entry_slice" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_entry_slice
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.save_entry_slice" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_entry_slice
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.delete_entry_slice" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_entry_slice
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.insert_entry" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_entry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.file.find_insert_position" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_insert_position
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters" class="md-nav__link">
    <span class="md-ellipsis">
      
        filters
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="filters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterError" class="md-nav__link">
    <span class="md-ellipsis">
      
        FilterError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterParseError" class="md-nav__link">
    <span class="md-ellipsis">
      
        FilterParseError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterIllegalCharError" class="md-nav__link">
    <span class="md-ellipsis">
      
        FilterIllegalCharError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.TimeFilterParseError" class="md-nav__link">
    <span class="md-ellipsis">
      
        TimeFilterParseError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.Token" class="md-nav__link">
    <span class="md-ellipsis">
      
        Token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxLexer" class="md-nav__link">
    <span class="md-ellipsis">
      
        FilterSyntaxLexer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FilterSyntaxLexer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxLexer.lex" class="md-nav__link">
    <span class="md-ellipsis">
      
        lex
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.Match" class="md-nav__link">
    <span class="md-ellipsis">
      
        Match
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.MatchAmount" class="md-nav__link">
    <span class="md-ellipsis">
      
        MatchAmount
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser" class="md-nav__link">
    <span class="md-ellipsis">
      
        FilterSyntaxParser
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FilterSyntaxParser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_filter" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_filter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_expr" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_expr
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_all" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_expr_all
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_any" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_expr_any
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_parentheses" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_expr_parentheses
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_and" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_expr_and
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_or" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_expr_or
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_negated" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_expr_negated
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_simple_expr_TAG" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_simple_expr_TAG
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_simple_expr_LINK" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_simple_expr_LINK
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_simple_expr_STRING" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_simple_expr_STRING
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_simple_expr_key" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_simple_expr_key
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.FilterSyntaxParser.p_simple_expr_units" class="md-nav__link">
    <span class="md-ellipsis">
      
        p_simple_expr_units
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.EntryFilter" class="md-nav__link">
    <span class="md-ellipsis">
      
        EntryFilter
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EntryFilter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.EntryFilter.apply" class="md-nav__link">
    <span class="md-ellipsis">
      
        apply
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.TimeFilter" class="md-nav__link">
    <span class="md-ellipsis">
      
        TimeFilter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.AdvancedFilter" class="md-nav__link">
    <span class="md-ellipsis">
      
        AdvancedFilter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.filters.AccountFilter" class="md-nav__link">
    <span class="md-ellipsis">
      
        AccountFilter
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.group_entries" class="md-nav__link">
    <span class="md-ellipsis">
      
        group_entries
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="group_entries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.group_entries.EntriesByType" class="md-nav__link">
    <span class="md-ellipsis">
      
        EntriesByType
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.group_entries.TransactionPosting" class="md-nav__link">
    <span class="md-ellipsis">
      
        TransactionPosting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.group_entries.group_entries_by_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        group_entries_by_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.group_entries.group_entries_by_account" class="md-nav__link">
    <span class="md-ellipsis">
      
        group_entries_by_account
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest" class="md-nav__link">
    <span class="md-ellipsis">
      
        ingest
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ingest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.IngestError" class="md-nav__link">
    <span class="md-ellipsis">
      
        IngestError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.ImporterMethodCallError" class="md-nav__link">
    <span class="md-ellipsis">
      
        ImporterMethodCallError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.ImporterInvalidTypeError" class="md-nav__link">
    <span class="md-ellipsis">
      
        ImporterInvalidTypeError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.ImporterExtractError" class="md-nav__link">
    <span class="md-ellipsis">
      
        ImporterExtractError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.MissingImporterConfigError" class="md-nav__link">
    <span class="md-ellipsis">
      
        MissingImporterConfigError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.MissingImporterDirsError" class="md-nav__link">
    <span class="md-ellipsis">
      
        MissingImporterDirsError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.ImportConfigLoadError" class="md-nav__link">
    <span class="md-ellipsis">
      
        ImportConfigLoadError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.FileImportInfo" class="md-nav__link">
    <span class="md-ellipsis">
      
        FileImportInfo
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.FileImporters" class="md-nav__link">
    <span class="md-ellipsis">
      
        FileImporters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.WrappedImporter" class="md-nav__link">
    <span class="md-ellipsis">
      
        WrappedImporter
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WrappedImporter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.WrappedImporter.name" class="md-nav__link">
    <span class="md-ellipsis">
      
        name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.WrappedImporter.identify" class="md-nav__link">
    <span class="md-ellipsis">
      
        identify
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.WrappedImporter.file_import_info" class="md-nav__link">
    <span class="md-ellipsis">
      
        file_import_info
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.IngestModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        IngestModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IngestModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.IngestModule.module_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        module_path
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.IngestModule.import_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        import_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.IngestModule.extract" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.walk_dir" class="md-nav__link">
    <span class="md-ellipsis">
      
        walk_dir
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.get_cached_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_cached_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.find_imports" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_imports
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.extract_from_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_from_file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.load_import_config" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_import_config
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.ingest.filepath_in_primary_imports_folder" class="md-nav__link">
    <span class="md-ellipsis">
      
        filepath_in_primary_imports_folder
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory" class="md-nav__link">
    <span class="md-ellipsis">
      
        inventory
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="inventory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.SimpleCounterInventory" class="md-nav__link">
    <span class="md-ellipsis">
      
        SimpleCounterInventory
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SimpleCounterInventory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.SimpleCounterInventory.is_empty" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_empty
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.SimpleCounterInventory.add" class="md-nav__link">
    <span class="md-ellipsis">
      
        add
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.SimpleCounterInventory.reduce" class="md-nav__link">
    <span class="md-ellipsis">
      
        reduce
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.CounterInventory" class="md-nav__link">
    <span class="md-ellipsis">
      
        CounterInventory
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CounterInventory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.CounterInventory.is_empty" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_empty
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.CounterInventory.add" class="md-nav__link">
    <span class="md-ellipsis">
      
        add
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.CounterInventory.to_strings" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_strings
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.CounterInventory.reduce" class="md-nav__link">
    <span class="md-ellipsis">
      
        reduce
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.CounterInventory.add_amount" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_amount
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.CounterInventory.add_position" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_position
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.inventory.CounterInventory.add_inventory" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_inventory
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.misc" class="md-nav__link">
    <span class="md-ellipsis">
      
        misc
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="misc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.misc.FavaError" class="md-nav__link">
    <span class="md-ellipsis">
      
        FavaError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.misc.FavaMisc" class="md-nav__link">
    <span class="md-ellipsis">
      
        FavaMisc
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FavaMisc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.misc.FavaMisc.errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        errors
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.misc.sidebar_links" class="md-nav__link">
    <span class="md-ellipsis">
      
        sidebar_links
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.misc.upcoming_events" class="md-nav__link">
    <span class="md-ellipsis">
      
        upcoming_events
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.misc.align" class="md-nav__link">
    <span class="md-ellipsis">
      
        align
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.module_base" class="md-nav__link">
    <span class="md-ellipsis">
      
        module_base
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="module_base">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.module_base.FavaModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        FavaModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FavaModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.module_base.FavaModule.load_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_file
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.number" class="md-nav__link">
    <span class="md-ellipsis">
      
        number
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="number">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.number.DecimalFormatModule" class="md-nav__link">
    <span class="md-ellipsis">
      
        DecimalFormatModule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DecimalFormatModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.number.DecimalFormatModule.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __call__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.number.get_locale_format" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_locale_format
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query" class="md-nav__link">
    <span class="md-ellipsis">
      
        query
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="query">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.QueryResultTable" class="md-nav__link">
    <span class="md-ellipsis">
      
        QueryResultTable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.QueryResultText" class="md-nav__link">
    <span class="md-ellipsis">
      
        QueryResultText
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.BaseColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        BaseColumn
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseColumn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.BaseColumn.serialise" class="md-nav__link">
    <span class="md-ellipsis">
      
        serialise
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.BoolColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        BoolColumn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.DecimalColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        DecimalColumn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.IntColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        IntColumn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.StrColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        StrColumn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.DateColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        DateColumn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.PositionColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        PositionColumn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.SetColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        SetColumn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.AmountColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        AmountColumn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.ObjectColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        ObjectColumn
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ObjectColumn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.ObjectColumn.serialise" class="md-nav__link">
    <span class="md-ellipsis">
      
        serialise
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.InventoryColumn" class="md-nav__link">
    <span class="md-ellipsis">
      
        InventoryColumn
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="InventoryColumn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query.InventoryColumn.serialise" class="md-nav__link">
    <span class="md-ellipsis">
      
        serialise
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell" class="md-nav__link">
    <span class="md-ellipsis">
      
        query_shell
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="query_shell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.FavaShellError" class="md-nav__link">
    <span class="md-ellipsis">
      
        FavaShellError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.QueryNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      
        QueryNotFoundError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.TooManyRunArgsError" class="md-nav__link">
    <span class="md-ellipsis">
      
        TooManyRunArgsError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.QueryCompilationError" class="md-nav__link">
    <span class="md-ellipsis">
      
        QueryCompilationError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.QueryParseError" class="md-nav__link">
    <span class="md-ellipsis">
      
        QueryParseError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.NonExportableQueryError" class="md-nav__link">
    <span class="md-ellipsis">
      
        NonExportableQueryError
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.FavaQueryRunner" class="md-nav__link">
    <span class="md-ellipsis">
      
        FavaQueryRunner
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FavaQueryRunner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.FavaQueryRunner.run" class="md-nav__link">
    <span class="md-ellipsis">
      
        run
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.QueryShell" class="md-nav__link">
    <span class="md-ellipsis">
      
        QueryShell
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QueryShell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.QueryShell.execute_query_serialised" class="md-nav__link">
    <span class="md-ellipsis">
      
        execute_query_serialised
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.query_shell.QueryShell.query_to_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        query_to_file
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree" class="md-nav__link">
    <span class="md-ellipsis">
      
        tree
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="tree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.SerialisedTreeNode" class="md-nav__link">
    <span class="md-ellipsis">
      
        SerialisedTreeNode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.TreeNode" class="md-nav__link">
    <span class="md-ellipsis">
      
        TreeNode
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TreeNode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.TreeNode.serialise" class="md-nav__link">
    <span class="md-ellipsis">
      
        serialise
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.TreeNode.serialise_with_context" class="md-nav__link">
    <span class="md-ellipsis">
      
        serialise_with_context
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.Tree" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tree
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.Tree.accounts" class="md-nav__link">
    <span class="md-ellipsis">
      
        accounts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.Tree.ancestors" class="md-nav__link">
    <span class="md-ellipsis">
      
        ancestors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.Tree.insert" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.Tree.get" class="md-nav__link">
    <span class="md-ellipsis">
      
        get
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.Tree.net_profit" class="md-nav__link">
    <span class="md-ellipsis">
      
        net_profit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.tree.Tree.cap" class="md-nav__link">
    <span class="md-ellipsis">
      
        cap
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher" class="md-nav__link">
    <span class="md-ellipsis">
      
        watcher
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="watcher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.WatcherBase" class="md-nav__link">
    <span class="md-ellipsis">
      
        WatcherBase
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WatcherBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.WatcherBase.last_checked" class="md-nav__link">
    <span class="md-ellipsis">
      
        last_checked
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.WatcherBase.last_notified" class="md-nav__link">
    <span class="md-ellipsis">
      
        last_notified
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.WatcherBase.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.WatcherBase.check" class="md-nav__link">
    <span class="md-ellipsis">
      
        check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.WatcherBase.notify" class="md-nav__link">
    <span class="md-ellipsis">
      
        notify
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.WatchfilesWatcher" class="md-nav__link">
    <span class="md-ellipsis">
      
        WatchfilesWatcher
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WatchfilesWatcher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.WatchfilesWatcher.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        update
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.Watcher" class="md-nav__link">
    <span class="md-ellipsis">
      
        Watcher
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Watcher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.core.watcher.Watcher.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        update
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#application" class="md-nav__link">
    <span class="md-ellipsis">
      
        Application
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rustfava.application" class="md-nav__link">
    <span class="md-ellipsis">
      
        application
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="application">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.application.static_url" class="md-nav__link">
    <span class="md-ellipsis">
      
        static_url
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.application.url_for" class="md-nav__link">
    <span class="md-ellipsis">
      
        url_for
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.application.translations" class="md-nav__link">
    <span class="md-ellipsis">
      
        translations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rustfava.application.create_app" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_app
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cli" class="md-nav__link">
    <span class="md-ellipsis">
      
        CLI
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rustfava.cli" class="md-nav__link">
    <span class="md-ellipsis">
      
        cli
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cli">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rustfava.cli.main" class="md-nav__link">
    <span class="md-ellipsis">
      
        main
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There's no stability guarantee as this is just for internal purposes currently.</p>
</div>
<h2 id="core-modules">Core Modules<a class="headerlink" href="#core-modules" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<h2 id="rustfava.core" class="doc doc-heading">
            <code>rustfava.core</code>


<a href="#rustfava.core" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>This module provides the data required by Fava's reports.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="rustfava.core.EntryNotFoundForHashError" class="doc doc-heading">
            <code>EntryNotFoundForHashError</code>


<a href="#rustfava.core.EntryNotFoundForHashError" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code></p>



        <p>Entry not found for hash.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="k">class</span><span class="w"> </span><span class="nc">EntryNotFoundForHashError</span><span class="p">(</span><span class="n">RustfavaAPIError</span><span class="p">):</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Entry not found for hash.&quot;&quot;&quot;</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No entry found for hash &quot;</span><span class="si">{</span><span class="n">entry_hash</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="rustfava.core.StatementNotFoundError" class="doc doc-heading">
            <code>StatementNotFoundError</code>


<a href="#rustfava.core.StatementNotFoundError" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code></p>



        <p>Statement not found.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="k">class</span><span class="w"> </span><span class="nc">StatementNotFoundError</span><span class="p">(</span><span class="n">RustfavaAPIError</span><span class="p">):</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Statement not found.&quot;&quot;&quot;</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;Statement not found.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="rustfava.core.StatementMetadataInvalidError" class="doc doc-heading">
            <code>StatementMetadataInvalidError</code>


<a href="#rustfava.core.StatementMetadataInvalidError" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code></p>



        <p>Statement metadata not found or invalid.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="k">class</span><span class="w"> </span><span class="nc">StatementMetadataInvalidError</span><span class="p">(</span><span class="n">RustfavaAPIError</span><span class="p">):</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Statement metadata not found or invalid.&quot;&quot;&quot;</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>            <span class="sa">f</span><span class="s2">&quot;Statement path at key &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; missing or not a string.&quot;</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="rustfava.core.JournalPage" class="doc doc-heading">
            <code>JournalPage</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.JournalPage" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">



        <p>A page of journal entries.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span>
<span class="normal"><a href="#__codelineno-0-96">96</a></span>
<span class="normal"><a href="#__codelineno-0-97">97</a></span>
<span class="normal"><a href="#__codelineno-0-98">98</a></span>
<span class="normal"><a href="#__codelineno-0-99">99</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="k">class</span><span class="w"> </span><span class="nc">JournalPage</span><span class="p">:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A page of journal entries.&quot;&quot;&quot;</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Directive</span><span class="p">]]</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="n">total_pages</span><span class="p">:</span> <span class="nb">int</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="rustfava.core.FilteredLedger" class="doc doc-heading">
            <code>FilteredLedger</code>


<a href="#rustfava.core.FilteredLedger" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">



        <p>Filtered Beancount ledger.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="k">class</span><span class="w"> </span><span class="nc">FilteredLedger</span><span class="p">:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filtered Beancount ledger.&quot;&quot;&quot;</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="s2">&quot;__dict__&quot;</span><span class="p">,</span>  <span class="c1"># for the cached_property decorator</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="s2">&quot;_date_first&quot;</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="s2">&quot;_date_last&quot;</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="s2">&quot;_pages&quot;</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="s2">&quot;date_range&quot;</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="s2">&quot;entries&quot;</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="s2">&quot;ledger&quot;</span><span class="p">,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="p">)</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">_date_first</span><span class="p">:</span> <span class="n">date</span> <span class="o">|</span> <span class="kc">None</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="n">_date_last</span><span class="p">:</span> <span class="n">date</span> <span class="o">|</span> <span class="kc">None</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="n">ledger</span><span class="p">:</span> <span class="n">RustfavaLedger</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">account</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="nb">filter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa: A002</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">time</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a filtered view of a ledger.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            ledger: The ledger to filter.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            account: The account filter.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">            filter: The advanced filter.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            time: The time filter.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span> <span class="o">=</span> <span class="n">ledger</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span><span class="p">:</span> <span class="n">DateRange</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="nb">tuple</span><span class="p">[</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>                <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>                <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;asc&quot;</span><span class="p">,</span> <span class="s2">&quot;desc&quot;</span><span class="p">],</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>                <span class="nb">list</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Directive</span><span class="p">]]],</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>            <span class="p">]</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="o">|</span> <span class="kc">None</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="p">)</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">entries</span> <span class="o">=</span> <span class="n">ledger</span><span class="o">.</span><span class="n">all_entries</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">if</span> <span class="n">account</span><span class="p">:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>            <span class="n">entries</span> <span class="o">=</span> <span class="n">AccountFilter</span><span class="p">(</span><span class="n">account</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="k">if</span> <span class="nb">filter</span> <span class="ow">and</span> <span class="nb">filter</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="n">entries</span> <span class="o">=</span> <span class="n">AdvancedFilter</span><span class="p">(</span><span class="nb">filter</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="k">if</span> <span class="n">time</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>            <span class="n">time_filter</span> <span class="o">=</span> <span class="n">TimeFilter</span><span class="p">(</span><span class="n">ledger</span><span class="o">.</span><span class="n">options</span><span class="p">,</span> <span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>            <span class="n">entries</span> <span class="o">=</span> <span class="n">time_filter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span> <span class="o">=</span> <span class="n">time_filter</span><span class="o">.</span><span class="n">date_range</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_date_first</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">begin</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_date_last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">end</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="k">return</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_date_first</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_date_last</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">):</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_date_first</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>                <span class="k">break</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">):</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="p">(</span><span class="n">Transaction</span><span class="p">,</span> <span class="n">Price</span><span class="p">)):</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_date_last</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>                <span class="k">break</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">end_date</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">date</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The date to use for prices.&quot;&quot;&quot;</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">date_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="k">if</span> <span class="n">date_range</span><span class="p">:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>            <span class="k">return</span> <span class="n">date_range</span><span class="o">.</span><span class="n">end_inclusive</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="nd">@cached_property</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">entries_with_all_prices</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">]:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The filtered entries, with all prices added back in for queries.&quot;&quot;&quot;</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="n">entries</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Price</span><span class="p">]</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="n">entries</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">_incomplete_sortkey</span><span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="k">return</span> <span class="n">entries</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="nd">@cached_property</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">entries_without_prices</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">]:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The filtered entries, without prices for journals.&quot;&quot;&quot;</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">Price</span><span class="p">)]</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="nd">@cached_property</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">root_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tree</span><span class="p">:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A root tree.&quot;&quot;&quot;</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="k">return</span> <span class="n">Tree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="nd">@cached_property</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">root_tree_closed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tree</span><span class="p">:</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A root tree for the balance sheet.&quot;&quot;&quot;</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">)</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">tree</span><span class="o">.</span><span class="n">cap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">options</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">unrealized</span><span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="k">return</span> <span class="n">tree</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">interval_ranges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="n">Interval</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">DateRange</span><span class="p">]:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Yield date ranges corresponding to interval boundaries.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            interval: The interval to yield ranges for.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_date_first</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_date_last</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="n">complete</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="k">return</span> <span class="n">dateranges</span><span class="p">(</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_date_first</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_date_last</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">complete</span><span class="o">=</span><span class="n">complete</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="p">)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">quote</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">date</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">]]:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List all prices for a pair of commodities.</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">            base: The price base.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">            quote: The price quote.</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="n">all_prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">get_all_prices</span><span class="p">((</span><span class="n">base</span><span class="p">,</span> <span class="n">quote</span><span class="p">))</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="k">if</span> <span class="n">all_prices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">date_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="k">if</span> <span class="n">date_range</span><span class="p">:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                <span class="n">price_point</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>                <span class="k">for</span> <span class="n">price_point</span> <span class="ow">in</span> <span class="n">all_prices</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>                <span class="k">if</span> <span class="n">date_range</span><span class="o">.</span><span class="n">begin</span> <span class="o">&lt;=</span> <span class="n">price_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">date_range</span><span class="o">.</span><span class="n">end</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="p">]</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="k">return</span> <span class="n">all_prices</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">account_is_closed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the account is closed.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">            account_name: An account name.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">            True if the account is closed before the end date of the current</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">            time filter.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="n">date_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="n">close_date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="n">account_name</span><span class="p">]</span><span class="o">.</span><span class="n">close_date</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="k">if</span> <span class="n">close_date</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="k">return</span> <span class="n">close_date</span> <span class="o">&lt;</span> <span class="n">date_range</span><span class="o">.</span><span class="n">end</span> <span class="k">if</span> <span class="n">date_range</span> <span class="k">else</span> <span class="kc">True</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">paginate_journal</span><span class="p">(</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="n">page</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="n">per_page</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="n">order</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;asc&quot;</span><span class="p">,</span> <span class="s2">&quot;desc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;desc&quot;</span><span class="p">,</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JournalPage</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get entries for a journal page with pagination info.</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            page: Page number (1-indexed).</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">            order: Datewise order to sort in</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">            per_page: Number of entries per page.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">            A JournalPage, containing a list of entries as (global_index,</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">            directive) tuples in reverse chronological order and the total</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">            number of pages.</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">per_page</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">order</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="p">):</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>            <span class="n">pages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Directive</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="n">enumerated</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entries_without_prices</span><span class="p">))</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>            <span class="n">entries</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>                <span class="nb">iter</span><span class="p">(</span><span class="n">enumerated</span><span class="p">)</span> <span class="k">if</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">&quot;asc&quot;</span> <span class="k">else</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">enumerated</span><span class="p">)</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>            <span class="p">)</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="k">while</span> <span class="n">batch</span> <span class="o">:=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">islice</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">per_page</span><span class="p">)):</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                <span class="n">pages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">pages</span><span class="p">:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>                <span class="n">pages</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span> <span class="o">=</span> <span class="p">(</span><span class="n">per_page</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">pages</span><span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="n">_per_pages</span><span class="p">,</span> <span class="n">_order</span><span class="p">,</span> <span class="n">pages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pages</span><span class="p">)</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="k">if</span> <span class="n">page</span> <span class="o">&gt;</span> <span class="n">total</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="k">return</span> <span class="n">JournalPage</span><span class="p">(</span><span class="n">pages</span><span class="p">[</span><span class="n">page</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">total</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="rustfava.core.FilteredLedger.end_date" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">end_date</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#rustfava.core.FilteredLedger.end_date" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>The date to use for prices.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="rustfava.core.FilteredLedger.entries_with_all_prices" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">entries_with_all_prices</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#rustfava.core.FilteredLedger.entries_with_all_prices" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>The filtered entries, with all prices added back in for queries.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="rustfava.core.FilteredLedger.entries_without_prices" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">entries_without_prices</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#rustfava.core.FilteredLedger.entries_without_prices" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>The filtered entries, without prices for journals.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="rustfava.core.FilteredLedger.root_tree" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">root_tree</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#rustfava.core.FilteredLedger.root_tree" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>A root tree.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="rustfava.core.FilteredLedger.root_tree_closed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">root_tree_closed</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#rustfava.core.FilteredLedger.root_tree_closed" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>A root tree for the balance sheet.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="rustfava.core.FilteredLedger.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">ledger</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">account</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#rustfava.core.FilteredLedger.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create a filtered view of a ledger.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ledger</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RustfavaLedger (rustfava.core.RustfavaLedger)" href="#rustfava.core.RustfavaLedger">RustfavaLedger</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ledger to filter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>account</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The account filter.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The advanced filter.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>time</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The time filter.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">ledger</span><span class="p">:</span> <span class="n">RustfavaLedger</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="n">account</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="nb">filter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa: A002</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">time</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a filtered view of a ledger.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        ledger: The ledger to filter.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        account: The account filter.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        filter: The advanced filter.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        time: The time filter.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span> <span class="o">=</span> <span class="n">ledger</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span><span class="p">:</span> <span class="n">DateRange</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="nb">tuple</span><span class="p">[</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;asc&quot;</span><span class="p">,</span> <span class="s2">&quot;desc&quot;</span><span class="p">],</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="nb">list</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Directive</span><span class="p">]]],</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="p">]</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="o">|</span> <span class="kc">None</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="p">)</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">entries</span> <span class="o">=</span> <span class="n">ledger</span><span class="o">.</span><span class="n">all_entries</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="k">if</span> <span class="n">account</span><span class="p">:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">entries</span> <span class="o">=</span> <span class="n">AccountFilter</span><span class="p">(</span><span class="n">account</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="k">if</span> <span class="nb">filter</span> <span class="ow">and</span> <span class="nb">filter</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="n">entries</span> <span class="o">=</span> <span class="n">AdvancedFilter</span><span class="p">(</span><span class="nb">filter</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="k">if</span> <span class="n">time</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="n">time_filter</span> <span class="o">=</span> <span class="n">TimeFilter</span><span class="p">(</span><span class="n">ledger</span><span class="o">.</span><span class="n">options</span><span class="p">,</span> <span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="n">entries</span> <span class="o">=</span> <span class="n">time_filter</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span> <span class="o">=</span> <span class="n">time_filter</span><span class="o">.</span><span class="n">date_range</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_date_first</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">begin</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_date_last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">end</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="k">return</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_date_first</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_date_last</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">):</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_date_first</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="k">break</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">):</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="p">(</span><span class="n">Transaction</span><span class="p">,</span> <span class="n">Price</span><span class="p">)):</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_date_last</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>            <span class="k">break</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.FilteredLedger.interval_ranges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interval_ranges</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span></code>

<a href="#rustfava.core.FilteredLedger.interval_ranges" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Yield date ranges corresponding to interval boundaries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="rustfava.util.date.Interval">Interval</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The interval to yield ranges for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="k">def</span><span class="w"> </span><span class="nf">interval_ranges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="n">Interval</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">DateRange</span><span class="p">]:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Yield date ranges corresponding to interval boundaries.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        interval: The interval to yield ranges for.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_date_first</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_date_last</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="n">complete</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="k">return</span> <span class="n">dateranges</span><span class="p">(</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_date_first</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_date_last</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">complete</span><span class="o">=</span><span class="n">complete</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.FilteredLedger.prices" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prices</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">quote</span><span class="p">)</span></code>

<a href="#rustfava.core.FilteredLedger.prices" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>List all prices for a pair of commodities.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>base</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The price base.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>quote</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The price quote.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="k">def</span><span class="w"> </span><span class="nf">prices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">quote</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">date</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">]]:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;List all prices for a pair of commodities.</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        base: The price base.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        quote: The price quote.</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">all_prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">get_all_prices</span><span class="p">((</span><span class="n">base</span><span class="p">,</span> <span class="n">quote</span><span class="p">))</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="k">if</span> <span class="n">all_prices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">date_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="k">if</span> <span class="n">date_range</span><span class="p">:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>            <span class="n">price_point</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="k">for</span> <span class="n">price_point</span> <span class="ow">in</span> <span class="n">all_prices</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="k">if</span> <span class="n">date_range</span><span class="o">.</span><span class="n">begin</span> <span class="o">&lt;=</span> <span class="n">price_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">date_range</span><span class="o">.</span><span class="n">end</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="p">]</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="k">return</span> <span class="n">all_prices</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.FilteredLedger.account_is_closed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">account_is_closed</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span></code>

<a href="#rustfava.core.FilteredLedger.account_is_closed" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Check if the account is closed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>account_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An account name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the account is closed before the end date of the current</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>time filter.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="k">def</span><span class="w"> </span><span class="nf">account_is_closed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the account is closed.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        account_name: An account name.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        True if the account is closed before the end date of the current</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        time filter.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="n">date_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="n">close_date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">accounts</span><span class="p">[</span><span class="n">account_name</span><span class="p">]</span><span class="o">.</span><span class="n">close_date</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="k">if</span> <span class="n">close_date</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="k">return</span> <span class="n">close_date</span> <span class="o">&lt;</span> <span class="n">date_range</span><span class="o">.</span><span class="n">end</span> <span class="k">if</span> <span class="n">date_range</span> <span class="k">else</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.FilteredLedger.paginate_journal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">paginate_journal</span><span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="n">per_page</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;desc&#39;</span><span class="p">)</span></code>

<a href="#rustfava.core.FilteredLedger.paginate_journal" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get entries for a journal page with pagination info.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>page</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Page number (1-indexed).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>order</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;asc&#39;, &#39;desc&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Datewise order to sort in</p>
              </div>
            </td>
            <td>
                  <code>&#39;desc&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>per_page</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of entries per page.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="JournalPage


  
      dataclass
   (rustfava.core.JournalPage)" href="#rustfava.core.JournalPage">JournalPage</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A JournalPage, containing a list of entries as (global_index,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="JournalPage


  
      dataclass
   (rustfava.core.JournalPage)" href="#rustfava.core.JournalPage">JournalPage</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>directive) tuples in reverse chronological order and the total</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="JournalPage


  
      dataclass
   (rustfava.core.JournalPage)" href="#rustfava.core.JournalPage">JournalPage</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>number of pages.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="k">def</span><span class="w"> </span><span class="nf">paginate_journal</span><span class="p">(</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="n">page</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="n">per_page</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="n">order</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;asc&quot;</span><span class="p">,</span> <span class="s2">&quot;desc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;desc&quot;</span><span class="p">,</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JournalPage</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get entries for a journal page with pagination info.</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        page: Page number (1-indexed).</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        order: Datewise order to sort in</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        per_page: Number of entries per page.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        A JournalPage, containing a list of entries as (global_index,</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        directive) tuples in reverse chronological order and the total</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">        number of pages.</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">per_page</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">order</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="p">):</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="n">pages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Directive</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="n">enumerated</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entries_without_prices</span><span class="p">))</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="n">entries</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>            <span class="nb">iter</span><span class="p">(</span><span class="n">enumerated</span><span class="p">)</span> <span class="k">if</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">&quot;asc&quot;</span> <span class="k">else</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">enumerated</span><span class="p">)</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="p">)</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="k">while</span> <span class="n">batch</span> <span class="o">:=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">islice</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">per_page</span><span class="p">)):</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>            <span class="n">pages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">pages</span><span class="p">:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>            <span class="n">pages</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span> <span class="o">=</span> <span class="p">(</span><span class="n">per_page</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">pages</span><span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="n">_per_pages</span><span class="p">,</span> <span class="n">_order</span><span class="p">,</span> <span class="n">pages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pages</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pages</span><span class="p">)</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">if</span> <span class="n">page</span> <span class="o">&gt;</span> <span class="n">total</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="k">return</span> <span class="n">JournalPage</span><span class="p">(</span><span class="n">pages</span><span class="p">[</span><span class="n">page</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">total</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="rustfava.core.RustfavaLedger" class="doc doc-heading">
            <code>RustfavaLedger</code>


<a href="#rustfava.core.RustfavaLedger" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">



        <p>Interface for a Beancount ledger.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="k">class</span><span class="w"> </span><span class="nc">RustfavaLedger</span><span class="p">:</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Interface for a Beancount ledger.&quot;&quot;&quot;</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="s2">&quot;_is_encrypted&quot;</span><span class="p">,</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="s2">&quot;accounts&quot;</span><span class="p">,</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="s2">&quot;accounts&quot;</span><span class="p">,</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="s2">&quot;all_entries&quot;</span><span class="p">,</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="s2">&quot;all_entries_by_type&quot;</span><span class="p">,</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="s2">&quot;attributes&quot;</span><span class="p">,</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="s2">&quot;beancount_file_path&quot;</span><span class="p">,</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="s2">&quot;budgets&quot;</span><span class="p">,</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="s2">&quot;charts&quot;</span><span class="p">,</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="s2">&quot;commodities&quot;</span><span class="p">,</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="s2">&quot;extensions&quot;</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="s2">&quot;fava_options&quot;</span><span class="p">,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="s2">&quot;fava_options_errors&quot;</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="s2">&quot;file&quot;</span><span class="p">,</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="s2">&quot;format_decimal&quot;</span><span class="p">,</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="s2">&quot;get_entry&quot;</span><span class="p">,</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="s2">&quot;get_filtered&quot;</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="s2">&quot;ingest&quot;</span><span class="p">,</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="s2">&quot;load_errors&quot;</span><span class="p">,</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="s2">&quot;misc&quot;</span><span class="p">,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>        <span class="s2">&quot;options&quot;</span><span class="p">,</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="s2">&quot;prices&quot;</span><span class="p">,</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>        <span class="s2">&quot;query_shell&quot;</span><span class="p">,</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="s2">&quot;watcher&quot;</span><span class="p">,</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="p">)</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="c1">#: List of all (unfiltered) entries.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="n">all_entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">]</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>    <span class="c1">#: A list of all errors reported by Beancount.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="n">load_errors</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BeancountError</span><span class="p">]</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="c1">#: The Beancount options map.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="n">options</span><span class="p">:</span> <span class="n">BeancountOptions</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="c1">#: A dict with all of Fava&#39;s option values.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="n">fava_options</span><span class="p">:</span> <span class="n">RustfavaOptions</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="c1">#: A list of all errors from parsing the custom options.</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="n">fava_options_errors</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BeancountError</span><span class="p">]</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="c1">#: The price map.</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="n">prices</span><span class="p">:</span> <span class="n">RustfavaPriceMap</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="c1">#: Dict of list of all (unfiltered) entries by type.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="n">all_entries_by_type</span><span class="p">:</span> <span class="n">EntriesByType</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="c1">#: A :class:`.AccountDict` module - details about the accounts.</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="n">accounts</span><span class="p">:</span> <span class="n">AccountDict</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="c1">#: An :class:`AttributesModule` instance.</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="n">attributes</span><span class="p">:</span> <span class="n">AttributesModule</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="c1">#: A :class:`.BudgetModule` instance.</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="n">budgets</span><span class="p">:</span> <span class="n">BudgetModule</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="c1">#: A :class:`.ChartModule` instance.</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="n">charts</span><span class="p">:</span> <span class="n">ChartModule</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="c1">#: A :class:`.CommoditiesModule` instance.</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="n">commodities</span><span class="p">:</span> <span class="n">CommoditiesModule</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="c1">#: A :class:`.ExtensionModule` instance.</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="n">extensions</span><span class="p">:</span> <span class="n">ExtensionModule</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>    <span class="c1">#: A :class:`.FileModule` instance.</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="n">file</span><span class="p">:</span> <span class="n">FileModule</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>    <span class="c1">#: A :class:`.DecimalFormatModule` instance.</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>    <span class="n">format_decimal</span><span class="p">:</span> <span class="n">DecimalFormatModule</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>    <span class="c1">#: A :class:`.IngestModule` instance.</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="n">ingest</span><span class="p">:</span> <span class="n">IngestModule</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="c1">#: A :class:`.FavaMisc` instance.</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="n">misc</span><span class="p">:</span> <span class="n">FavaMisc</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="c1">#: A :class:`.QueryShell` instance.</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="n">query_shell</span><span class="p">:</span> <span class="n">QueryShell</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">poll_watcher</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an interface for a Beancount ledger.</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        Arguments:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">            path: Path to the main Beancount file.</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">            poll_watcher: Whether to use the polling file watcher.</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="c1">#: The path to the main Beancount file.</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beancount_file_path</span> <span class="o">=</span> <span class="n">path</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_is_encrypted</span> <span class="o">=</span> <span class="n">is_encrypted_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_filtered</span> <span class="o">=</span> <span class="n">lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_filtered</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_entry</span> <span class="o">=</span> <span class="n">lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_entry</span><span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">accounts</span> <span class="o">=</span> <span class="n">AccountDict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span> <span class="o">=</span> <span class="n">AttributesModule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">budgets</span> <span class="o">=</span> <span class="n">BudgetModule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">charts</span> <span class="o">=</span> <span class="n">ChartModule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">commodities</span> <span class="o">=</span> <span class="n">CommoditiesModule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span> <span class="o">=</span> <span class="n">ExtensionModule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">FileModule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">format_decimal</span> <span class="o">=</span> <span class="n">DecimalFormatModule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ingest</span> <span class="o">=</span> <span class="n">IngestModule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">misc</span> <span class="o">=</span> <span class="n">FavaMisc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">query_shell</span> <span class="o">=</span> <span class="n">QueryShell</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">watcher</span> <span class="o">=</span> <span class="n">WatchfilesWatcher</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">poll_watcher</span> <span class="k">else</span> <span class="n">Watcher</span><span class="p">()</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Load the main file and all included files and set attributes.&quot;&quot;&quot;</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_entries</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">load_uncached</span><span class="p">(</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">beancount_file_path</span><span class="p">,</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>            <span class="n">is_encrypted</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_encrypted</span><span class="p">,</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="p">)</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_filtered</span><span class="o">.</span><span class="n">cache_clear</span><span class="p">()</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_entry</span><span class="o">.</span><span class="n">cache_clear</span><span class="p">()</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_entries_by_type</span> <span class="o">=</span> <span class="n">group_entries_by_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_entries</span><span class="p">)</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">prices</span> <span class="o">=</span> <span class="n">RustfavaPriceMap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Price</span><span class="p">)</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fava_options</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fava_options_errors</span> <span class="o">=</span> <span class="n">parse_options</span><span class="p">(</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Custom</span><span class="p">,</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_encrypted</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>            <span class="k">pass</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">watcher</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">paths_to_watch</span><span class="p">())</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="c1"># Call load_file of all modules.</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">accounts</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">budgets</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">charts</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">commodities</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">format_decimal</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">query_shell</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ingest</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">after_load_file</span><span class="p">()</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_filtered</span><span class="p">(</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>        <span class="n">account</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>        <span class="nb">filter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa: A002</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="n">time</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FilteredLedger</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the ledger.</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">            account: The account filter.</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">            filter: The advanced filter.</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">            time: The time filter.</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="k">return</span> <span class="n">FilteredLedger</span><span class="p">(</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>            <span class="n">ledger</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">account</span><span class="o">=</span><span class="n">account</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="nb">filter</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">time</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="p">)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">mtime</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The timestamp to the latest change of the underlying files.&quot;&quot;&quot;</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">watcher</span><span class="o">.</span><span class="n">last_checked</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BeancountError</span><span class="p">]:</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The errors that the Beancount loading plus Fava module errors.&quot;&quot;&quot;</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">load_errors</span><span class="p">,</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">fava_options_errors</span><span class="p">,</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">budgets</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ingest</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="p">]</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">root_accounts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The five root accounts.&quot;&quot;&quot;</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_assets&quot;</span><span class="p">],</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>            <span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_liabilities&quot;</span><span class="p">],</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>            <span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_equity&quot;</span><span class="p">],</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>            <span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_income&quot;</span><span class="p">],</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>            <span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_expenses&quot;</span><span class="p">],</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="p">)</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">join_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Path relative to the directory of the ledger.&quot;&quot;&quot;</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beancount_file_path</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">paths_to_watch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Path</span><span class="p">]]:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get paths to included files and document directories.</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">            A tuple (files, directories).</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;include&quot;</span><span class="p">]]</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingest</span><span class="o">.</span><span class="n">module_path</span><span class="p">:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingest</span><span class="o">.</span><span class="n">module_path</span><span class="p">)</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>            <span class="n">files</span><span class="p">,</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="p">[</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">account</span><span class="p">)</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>                <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_accounts</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>                <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;documents&quot;</span><span class="p">]</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>            <span class="p">],</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="p">)</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">changed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the file needs to be reloaded.</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">            True if a change in one of the included files or a change in a</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">            document folder was detected and the file has been reloaded.</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="c1"># We can&#39;t reload an encrypted file, so act like it never changes.</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_encrypted</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>        <span class="n">changed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watcher</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>        <span class="k">if</span> <span class="n">changed</span><span class="p">:</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>        <span class="k">return</span> <span class="n">changed</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">interval_balances</span><span class="p">(</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>        <span class="n">filtered</span><span class="p">:</span> <span class="n">FilteredLedger</span><span class="p">,</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="n">interval</span><span class="p">:</span> <span class="n">Interval</span><span class="p">,</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>        <span class="n">account_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="n">accumulate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Tree</span><span class="p">],</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">DateRange</span><span class="p">]]:</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Balances by interval.</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">        Arguments:</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">            filtered: The currently filtered ledger.</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">            interval: An interval.</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">            account_name: An account name.</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">            accumulate: A boolean, ``True`` if the balances for an interval</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">                should include all entries up to the end of the interval.</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">            A pair of a list of Tree instances and the intervals.</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="n">min_accounts</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>            <span class="n">account</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>            <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">accounts</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>            <span class="k">if</span> <span class="n">account</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="p">]</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>        <span class="n">interval_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">filtered</span><span class="o">.</span><span class="n">interval_ranges</span><span class="p">(</span><span class="n">interval</span><span class="p">)))</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="n">interval_balances</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>            <span class="n">Tree</span><span class="p">(</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                <span class="n">slice_entry_dates</span><span class="p">(</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>                    <span class="n">filtered</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>                    <span class="n">date</span><span class="o">.</span><span class="n">min</span> <span class="k">if</span> <span class="n">accumulate</span> <span class="k">else</span> <span class="n">date_range</span><span class="o">.</span><span class="n">begin</span><span class="p">,</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>                    <span class="n">date_range</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>                <span class="p">),</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>                <span class="n">min_accounts</span><span class="p">,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>            <span class="p">)</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>            <span class="k">for</span> <span class="n">date_range</span> <span class="ow">in</span> <span class="n">interval_ranges</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>        <span class="p">]</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="k">return</span> <span class="n">interval_balances</span><span class="p">,</span> <span class="n">interval_ranges</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>    <span class="nd">@listify</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">account_journal</span><span class="p">(</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>        <span class="n">filtered</span><span class="p">:</span> <span class="n">FilteredLedger</span><span class="p">,</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>        <span class="n">account_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>        <span class="n">conversion</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Conversion</span><span class="p">,</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>        <span class="n">with_children</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Directive</span><span class="p">,</span> <span class="n">SimpleCounterInventory</span><span class="p">,</span> <span class="n">SimpleCounterInventory</span><span class="p">]</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>    <span class="p">]:</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Journal for an account.</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">            filtered: The currently filtered ledger.</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">            account_name: An account name.</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">            conversion: The conversion to use.</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">            with_children: Whether to include postings of subaccounts of</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">                           the account.</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">        Yields:</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">            Tuples of ``(index, entry, change, balance)``.</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>        <span class="n">conv</span> <span class="o">=</span> <span class="n">conversion_from_str</span><span class="p">(</span><span class="n">conversion</span><span class="p">)</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>        <span class="n">relevant_account</span> <span class="o">=</span> <span class="n">account_tester</span><span class="p">(</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>            <span class="n">account_name</span><span class="p">,</span> <span class="n">with_children</span><span class="o">=</span><span class="n">with_children</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>        <span class="p">)</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>        <span class="n">prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>        <span class="n">balance</span> <span class="o">=</span> <span class="n">CounterInventory</span><span class="p">()</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">filtered</span><span class="o">.</span><span class="n">entries_without_prices</span><span class="p">):</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>            <span class="n">change</span> <span class="o">=</span> <span class="n">CounterInventory</span><span class="p">()</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>            <span class="n">entry_is_relevant</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>            <span class="n">postings</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;postings&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>            <span class="k">if</span> <span class="n">postings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>                <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">postings</span><span class="p">:</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>                    <span class="k">if</span> <span class="n">relevant_account</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">):</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>                        <span class="n">entry_is_relevant</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>                        <span class="n">balance</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>                        <span class="n">change</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>            <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">relevant_account</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">get_entry_accounts</span><span class="p">(</span><span class="n">entry</span><span class="p">)):</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>                <span class="n">entry_is_relevant</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>            <span class="k">if</span> <span class="n">entry_is_relevant</span><span class="p">:</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>                <span class="k">yield</span> <span class="p">(</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>                    <span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>                    <span class="n">entry</span><span class="p">,</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>                    <span class="n">conv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">change</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="p">),</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>                    <span class="n">conv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">balance</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="p">),</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>                <span class="p">)</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Directive</span><span class="p">:</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Find an entry.</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">        Arguments:</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">            entry_hash: Hash of the entry.</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">            The entry with the given hash.</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">            EntryNotFoundForHashError: If there is no entry for the given hash.</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>            <span class="k">return</span> <span class="nb">next</span><span class="p">(</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>                <span class="n">entry</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>                <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_entries</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>                <span class="k">if</span> <span class="n">entry_hash</span> <span class="o">==</span> <span class="n">hash_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>            <span class="p">)</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>        <span class="k">except</span> <span class="ne">StopIteration</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>            <span class="k">raise</span> <span class="n">EntryNotFoundForHashError</span><span class="p">(</span><span class="n">entry_hash</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">context</span><span class="p">(</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>        <span class="n">entry_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>        <span class="n">Directive</span><span class="p">,</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>        <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>        <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>    <span class="p">]:</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Context for an entry.</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">        Arguments:</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">            entry_hash: Hash of entry.</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">            A tuple ``(entry, before, after, source_slice, sha256sum)`` of the</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">            (unique) entry with the given ``entry_hash``. If the entry is a</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">            Balance or Transaction then ``before`` and ``after`` contain</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">            the balances before and after the entry of the affected accounts.</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>        <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_entry</span><span class="p">(</span><span class="n">entry_hash</span><span class="p">)</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="p">(</span><span class="n">Balance</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">)):</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>            <span class="k">return</span> <span class="n">entry</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>        <span class="n">entry_accounts</span> <span class="o">=</span> <span class="n">get_entry_accounts</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>        <span class="n">balances</span> <span class="o">=</span> <span class="p">{</span><span class="n">account</span><span class="p">:</span> <span class="n">CounterInventory</span><span class="p">()</span> <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="n">entry_accounts</span><span class="p">}</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>        <span class="k">for</span> <span class="n">entry_</span> <span class="ow">in</span> <span class="n">takewhile</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">entry</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_entries</span><span class="p">):</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry_</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">):</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>                <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry_</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>                    <span class="n">balance</span> <span class="o">=</span> <span class="n">balances</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>                    <span class="k">if</span> <span class="n">balance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>                        <span class="n">balance</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">visualise</span><span class="p">(</span><span class="n">inv</span><span class="p">:</span> <span class="n">CounterInventory</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>            <span class="k">return</span> <span class="n">inv</span><span class="o">.</span><span class="n">to_strings</span><span class="p">()</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="n">before</span> <span class="o">=</span> <span class="p">{</span><span class="n">acc</span><span class="p">:</span> <span class="n">visualise</span><span class="p">(</span><span class="n">inv</span><span class="p">)</span> <span class="k">for</span> <span class="n">acc</span><span class="p">,</span> <span class="n">inv</span> <span class="ow">in</span> <span class="n">balances</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Balance</span><span class="p">):</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>            <span class="k">return</span> <span class="n">entry</span><span class="p">,</span> <span class="n">before</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>        <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>            <span class="n">balances</span><span class="p">[</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">]</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>        <span class="n">after</span> <span class="o">=</span> <span class="p">{</span><span class="n">acc</span><span class="p">:</span> <span class="n">visualise</span><span class="p">(</span><span class="n">inv</span><span class="p">)</span> <span class="k">for</span> <span class="n">acc</span><span class="p">,</span> <span class="n">inv</span> <span class="ow">in</span> <span class="n">balances</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>        <span class="k">return</span> <span class="n">entry</span><span class="p">,</span> <span class="n">before</span><span class="p">,</span> <span class="n">after</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">commodity_pairs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List pairs of commodities.</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a><span class="sd">            A list of pairs of commodities. Pairs of operating currencies will</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a><span class="sd">            be given in both directions not just in the one found in file.</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">commodity_pairs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;operating_currency&quot;</span><span class="p">])</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">statement_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">metadata_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the path for a statement found in the specified entry.</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="sd">        The entry that we look up should contain a path to a document (absolute</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="sd">        or relative to the filename of the entry) or just its basename. We go</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">        through all documents and match on the full path or if one of the</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">        documents with a matching account has a matching file basename.</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a><span class="sd">        Arguments:</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">            entry_hash: Hash of the entry containing the path in its metadata.</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">            metadata_key: The key that the path should be in.</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">            The filename of the matching document entry.</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">            StatementMetadataInvalidError: If the metadata at the given key is</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a><span class="sd">                                           invalid.</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="sd">            StatementNotFoundError: If no matching document is found.</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>        <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_entry</span><span class="p">(</span><span class="n">entry_hash</span><span class="p">)</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">metadata_key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>            <span class="k">raise</span> <span class="n">StatementMetadataInvalidError</span><span class="p">(</span><span class="n">metadata_key</span><span class="p">)</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>        <span class="n">accounts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">get_entry_accounts</span><span class="p">(</span><span class="n">entry</span><span class="p">))</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>        <span class="n">filename</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_position</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>        <span class="n">full_path</span> <span class="o">=</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="k">for</span> <span class="n">document</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Document</span><span class="p">:</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>            <span class="n">document_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>            <span class="k">if</span> <span class="n">document_path</span> <span class="o">==</span> <span class="n">full_path</span><span class="p">:</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>                <span class="k">return</span> <span class="n">document</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>            <span class="k">if</span> <span class="n">document</span><span class="o">.</span><span class="n">account</span> <span class="ow">in</span> <span class="n">accounts</span> <span class="ow">and</span> <span class="n">document_path</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>                <span class="k">return</span> <span class="n">document</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>        <span class="k">raise</span> <span class="n">StatementNotFoundError</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>    <span class="n">group_entries_by_type</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">group_entries_by_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="rustfava.core.RustfavaLedger.mtime" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mtime</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#rustfava.core.RustfavaLedger.mtime" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>The timestamp to the latest change of the underlying files.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="rustfava.core.RustfavaLedger.errors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">errors</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#rustfava.core.RustfavaLedger.errors" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>The errors that the Beancount loading plus Fava module errors.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="rustfava.core.RustfavaLedger.root_accounts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">root_accounts</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#rustfava.core.RustfavaLedger.root_accounts" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>The five root accounts.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="rustfava.core.RustfavaLedger.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">poll_watcher</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#rustfava.core.RustfavaLedger.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create an interface for a Beancount ledger.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the main Beancount file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>poll_watcher</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use the polling file watcher.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">poll_watcher</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an interface for a Beancount ledger.</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">        path: Path to the main Beancount file.</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">        poll_watcher: Whether to use the polling file watcher.</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="c1">#: The path to the main Beancount file.</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">beancount_file_path</span> <span class="o">=</span> <span class="n">path</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_is_encrypted</span> <span class="o">=</span> <span class="n">is_encrypted_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">get_filtered</span> <span class="o">=</span> <span class="n">lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_filtered</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">get_entry</span> <span class="o">=</span> <span class="n">lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_entry</span><span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">accounts</span> <span class="o">=</span> <span class="n">AccountDict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span> <span class="o">=</span> <span class="n">AttributesModule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">budgets</span> <span class="o">=</span> <span class="n">BudgetModule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">charts</span> <span class="o">=</span> <span class="n">ChartModule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">commodities</span> <span class="o">=</span> <span class="n">CommoditiesModule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span> <span class="o">=</span> <span class="n">ExtensionModule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">FileModule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">format_decimal</span> <span class="o">=</span> <span class="n">DecimalFormatModule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ingest</span> <span class="o">=</span> <span class="n">IngestModule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">misc</span> <span class="o">=</span> <span class="n">FavaMisc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">query_shell</span> <span class="o">=</span> <span class="n">QueryShell</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">watcher</span> <span class="o">=</span> <span class="n">WatchfilesWatcher</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">poll_watcher</span> <span class="k">else</span> <span class="n">Watcher</span><span class="p">()</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.RustfavaLedger.load_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_file</span><span class="p">()</span></code>

<a href="#rustfava.core.RustfavaLedger.load_file" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Load the main file and all included files and set attributes.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the main file and all included files and set attributes.&quot;&quot;&quot;</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">all_entries</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_errors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">load_uncached</span><span class="p">(</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beancount_file_path</span><span class="p">,</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="n">is_encrypted</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_encrypted</span><span class="p">,</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="p">)</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">get_filtered</span><span class="o">.</span><span class="n">cache_clear</span><span class="p">()</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">get_entry</span><span class="o">.</span><span class="n">cache_clear</span><span class="p">()</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">all_entries_by_type</span> <span class="o">=</span> <span class="n">group_entries_by_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_entries</span><span class="p">)</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">prices</span> <span class="o">=</span> <span class="n">RustfavaPriceMap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Price</span><span class="p">)</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fava_options</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fava_options_errors</span> <span class="o">=</span> <span class="n">parse_options</span><span class="p">(</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Custom</span><span class="p">,</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>    <span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_encrypted</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="k">pass</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">watcher</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">paths_to_watch</span><span class="p">())</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>    <span class="c1"># Call load_file of all modules.</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">accounts</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">budgets</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">charts</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">commodities</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">format_decimal</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">query_shell</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ingest</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">after_load_file</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.RustfavaLedger.join_path" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">join_path</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

<a href="#rustfava.core.RustfavaLedger.join_path" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Path relative to the directory of the ledger.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="k">def</span><span class="w"> </span><span class="nf">join_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Path relative to the directory of the ledger.&quot;&quot;&quot;</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beancount_file_path</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.RustfavaLedger.paths_to_watch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">paths_to_watch</span><span class="p">()</span></code>

<a href="#rustfava.core.RustfavaLedger.paths_to_watch" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get paths to included files and document directories.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="collections.abc.Sequence">Sequence</span>[<span title="pathlib.Path">Path</span>], <span title="collections.abc.Sequence">Sequence</span>[<span title="pathlib.Path">Path</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple (files, directories).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="k">def</span><span class="w"> </span><span class="nf">paths_to_watch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Path</span><span class="p">]]:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get paths to included files and document directories.</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">        A tuple (files, directories).</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;include&quot;</span><span class="p">]]</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingest</span><span class="o">.</span><span class="n">module_path</span><span class="p">:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingest</span><span class="o">.</span><span class="n">module_path</span><span class="p">)</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>    <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="n">files</span><span class="p">,</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>        <span class="p">[</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">account</span><span class="p">)</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>            <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_accounts</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;documents&quot;</span><span class="p">]</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>        <span class="p">],</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.RustfavaLedger.changed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">changed</span><span class="p">()</span></code>

<a href="#rustfava.core.RustfavaLedger.changed" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Check if the file needs to be reloaded.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if a change in one of the included files or a change in a</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>document folder was detected and the file has been reloaded.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="k">def</span><span class="w"> </span><span class="nf">changed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the file needs to be reloaded.</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">        True if a change in one of the included files or a change in a</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">        document folder was detected and the file has been reloaded.</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>    <span class="c1"># We can&#39;t reload an encrypted file, so act like it never changes.</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_encrypted</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="n">changed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watcher</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>    <span class="k">if</span> <span class="n">changed</span><span class="p">:</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>    <span class="k">return</span> <span class="n">changed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.RustfavaLedger.interval_balances" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interval_balances</span><span class="p">(</span><span class="n">filtered</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">account_name</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">accumulate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#rustfava.core.RustfavaLedger.interval_balances" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Balances by interval.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filtered</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FilteredLedger (rustfava.core.FilteredLedger)" href="#rustfava.core.FilteredLedger">FilteredLedger</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The currently filtered ledger.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="rustfava.util.date.Interval">Interval</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An interval.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>account_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An account name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>accumulate</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A boolean, <code>True</code> if the balances for an interval
should include all entries up to the end of the interval.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="collections.abc.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="Tree (rustfava.core.tree.Tree)" href="#rustfava.core.tree.Tree">Tree</a>], <span title="collections.abc.Sequence">Sequence</span>[<span title="rustfava.util.date.DateRange">DateRange</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A pair of a list of Tree instances and the intervals.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="k">def</span><span class="w"> </span><span class="nf">interval_balances</span><span class="p">(</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>    <span class="n">filtered</span><span class="p">:</span> <span class="n">FilteredLedger</span><span class="p">,</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>    <span class="n">interval</span><span class="p">:</span> <span class="n">Interval</span><span class="p">,</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>    <span class="n">account_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>    <span class="n">accumulate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Tree</span><span class="p">],</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">DateRange</span><span class="p">]]:</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Balances by interval.</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">        filtered: The currently filtered ledger.</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">        interval: An interval.</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">        account_name: An account name.</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">        accumulate: A boolean, ``True`` if the balances for an interval</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">            should include all entries up to the end of the interval.</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">        A pair of a list of Tree instances and the intervals.</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="n">min_accounts</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="n">account</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>        <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">accounts</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>        <span class="k">if</span> <span class="n">account</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>    <span class="p">]</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>    <span class="n">interval_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">filtered</span><span class="o">.</span><span class="n">interval_ranges</span><span class="p">(</span><span class="n">interval</span><span class="p">)))</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>    <span class="n">interval_balances</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>        <span class="n">Tree</span><span class="p">(</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>            <span class="n">slice_entry_dates</span><span class="p">(</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>                <span class="n">filtered</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>                <span class="n">date</span><span class="o">.</span><span class="n">min</span> <span class="k">if</span> <span class="n">accumulate</span> <span class="k">else</span> <span class="n">date_range</span><span class="o">.</span><span class="n">begin</span><span class="p">,</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>                <span class="n">date_range</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>            <span class="p">),</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>            <span class="n">min_accounts</span><span class="p">,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>        <span class="p">)</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>        <span class="k">for</span> <span class="n">date_range</span> <span class="ow">in</span> <span class="n">interval_ranges</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>    <span class="p">]</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>    <span class="k">return</span> <span class="n">interval_balances</span><span class="p">,</span> <span class="n">interval_ranges</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.RustfavaLedger.account_journal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">account_journal</span><span class="p">(</span><span class="n">filtered</span><span class="p">,</span> <span class="n">account_name</span><span class="p">,</span> <span class="n">conversion</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">with_children</span><span class="p">)</span></code>

<a href="#rustfava.core.RustfavaLedger.account_journal" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Journal for an account.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filtered</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FilteredLedger (rustfava.core.FilteredLedger)" href="#rustfava.core.FilteredLedger">FilteredLedger</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The currently filtered ledger.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>account_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An account name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conversion</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <a class="autorefs autorefs-internal" title="Conversion (rustfava.core.conversion.Conversion)" href="#rustfava.core.conversion.Conversion">Conversion</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The conversion to use.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_children</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include postings of subaccounts of
           the account.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<span title="tuple">tuple</span>[<span title="int">int</span>, <span title="rustfava.beans.abc.Directive">Directive</span>, <a class="autorefs autorefs-internal" title="SimpleCounterInventory (rustfava.core.inventory.SimpleCounterInventory)" href="#rustfava.core.inventory.SimpleCounterInventory">SimpleCounterInventory</a>, <a class="autorefs autorefs-internal" title="SimpleCounterInventory (rustfava.core.inventory.SimpleCounterInventory)" href="#rustfava.core.inventory.SimpleCounterInventory">SimpleCounterInventory</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuples of <code>(index, entry, change, balance)</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="nd">@listify</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="k">def</span><span class="w"> </span><span class="nf">account_journal</span><span class="p">(</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>    <span class="n">filtered</span><span class="p">:</span> <span class="n">FilteredLedger</span><span class="p">,</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>    <span class="n">account_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>    <span class="n">conversion</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Conversion</span><span class="p">,</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>    <span class="n">with_children</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>    <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Directive</span><span class="p">,</span> <span class="n">SimpleCounterInventory</span><span class="p">,</span> <span class="n">SimpleCounterInventory</span><span class="p">]</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="p">]:</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Journal for an account.</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">        filtered: The currently filtered ledger.</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">        account_name: An account name.</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">        conversion: The conversion to use.</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">        with_children: Whether to include postings of subaccounts of</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">                       the account.</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">        Tuples of ``(index, entry, change, balance)``.</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>    <span class="n">conv</span> <span class="o">=</span> <span class="n">conversion_from_str</span><span class="p">(</span><span class="n">conversion</span><span class="p">)</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>    <span class="n">relevant_account</span> <span class="o">=</span> <span class="n">account_tester</span><span class="p">(</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="n">account_name</span><span class="p">,</span> <span class="n">with_children</span><span class="o">=</span><span class="n">with_children</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>    <span class="p">)</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>    <span class="n">prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>    <span class="n">balance</span> <span class="o">=</span> <span class="n">CounterInventory</span><span class="p">()</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">filtered</span><span class="o">.</span><span class="n">entries_without_prices</span><span class="p">):</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="n">change</span> <span class="o">=</span> <span class="n">CounterInventory</span><span class="p">()</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>        <span class="n">entry_is_relevant</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="n">postings</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;postings&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="k">if</span> <span class="n">postings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>            <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">postings</span><span class="p">:</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>                <span class="k">if</span> <span class="n">relevant_account</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">):</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>                    <span class="n">entry_is_relevant</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>                    <span class="n">balance</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>                    <span class="n">change</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">relevant_account</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">get_entry_accounts</span><span class="p">(</span><span class="n">entry</span><span class="p">)):</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>            <span class="n">entry_is_relevant</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>        <span class="k">if</span> <span class="n">entry_is_relevant</span><span class="p">:</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>            <span class="k">yield</span> <span class="p">(</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>                <span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>                <span class="n">entry</span><span class="p">,</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>                <span class="n">conv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">change</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="p">),</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>                <span class="n">conv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">balance</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="p">),</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.RustfavaLedger.context" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">context</span><span class="p">(</span><span class="n">entry_hash</span><span class="p">)</span></code>

<a href="#rustfava.core.RustfavaLedger.context" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Context for an entry.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entry_hash</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hash of entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="rustfava.beans.abc.Directive">Directive</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple <code>(entry, before, after, source_slice, sha256sum)</code> of the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Mapping">Mapping</span>[<span title="str">str</span>, <span title="collections.abc.Sequence">Sequence</span>[<span title="str">str</span>]] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(unique) entry with the given <code>entry_hash</code>. If the entry is a</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Mapping">Mapping</span>[<span title="str">str</span>, <span title="collections.abc.Sequence">Sequence</span>[<span title="str">str</span>]] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Balance or Transaction then <code>before</code> and <code>after</code> contain</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="rustfava.beans.abc.Directive">Directive</span>, <span title="collections.abc.Mapping">Mapping</span>[<span title="str">str</span>, <span title="collections.abc.Sequence">Sequence</span>[<span title="str">str</span>]] | None, <span title="collections.abc.Mapping">Mapping</span>[<span title="str">str</span>, <span title="collections.abc.Sequence">Sequence</span>[<span title="str">str</span>]] | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the balances before and after the entry of the affected accounts.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="k">def</span><span class="w"> </span><span class="nf">context</span><span class="p">(</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>    <span class="n">entry_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>    <span class="n">Directive</span><span class="p">,</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>    <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>    <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="p">]:</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Context for an entry.</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">        entry_hash: Hash of entry.</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">        A tuple ``(entry, before, after, source_slice, sha256sum)`` of the</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">        (unique) entry with the given ``entry_hash``. If the entry is a</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">        Balance or Transaction then ``before`` and ``after`` contain</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">        the balances before and after the entry of the affected accounts.</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>    <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_entry</span><span class="p">(</span><span class="n">entry_hash</span><span class="p">)</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="p">(</span><span class="n">Balance</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">)):</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>        <span class="k">return</span> <span class="n">entry</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>    <span class="n">entry_accounts</span> <span class="o">=</span> <span class="n">get_entry_accounts</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>    <span class="n">balances</span> <span class="o">=</span> <span class="p">{</span><span class="n">account</span><span class="p">:</span> <span class="n">CounterInventory</span><span class="p">()</span> <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="n">entry_accounts</span><span class="p">}</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>    <span class="k">for</span> <span class="n">entry_</span> <span class="ow">in</span> <span class="n">takewhile</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">entry</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_entries</span><span class="p">):</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry_</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">):</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>            <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry_</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>                <span class="n">balance</span> <span class="o">=</span> <span class="n">balances</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>                <span class="k">if</span> <span class="n">balance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>                    <span class="n">balance</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">visualise</span><span class="p">(</span><span class="n">inv</span><span class="p">:</span> <span class="n">CounterInventory</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>        <span class="k">return</span> <span class="n">inv</span><span class="o">.</span><span class="n">to_strings</span><span class="p">()</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>    <span class="n">before</span> <span class="o">=</span> <span class="p">{</span><span class="n">acc</span><span class="p">:</span> <span class="n">visualise</span><span class="p">(</span><span class="n">inv</span><span class="p">)</span> <span class="k">for</span> <span class="n">acc</span><span class="p">,</span> <span class="n">inv</span> <span class="ow">in</span> <span class="n">balances</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Balance</span><span class="p">):</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>        <span class="k">return</span> <span class="n">entry</span><span class="p">,</span> <span class="n">before</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>    <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>        <span class="n">balances</span><span class="p">[</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">]</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>    <span class="n">after</span> <span class="o">=</span> <span class="p">{</span><span class="n">acc</span><span class="p">:</span> <span class="n">visualise</span><span class="p">(</span><span class="n">inv</span><span class="p">)</span> <span class="k">for</span> <span class="n">acc</span><span class="p">,</span> <span class="n">inv</span> <span class="ow">in</span> <span class="n">balances</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>    <span class="k">return</span> <span class="n">entry</span><span class="p">,</span> <span class="n">before</span><span class="p">,</span> <span class="n">after</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.RustfavaLedger.commodity_pairs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">commodity_pairs</span><span class="p">()</span></code>

<a href="#rustfava.core.RustfavaLedger.commodity_pairs" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>List pairs of commodities.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="tuple">tuple</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of pairs of commodities. Pairs of operating currencies will</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="tuple">tuple</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>be given in both directions not just in the one found in file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-683" name="__codelineno-0-683"></a><span class="k">def</span><span class="w"> </span><span class="nf">commodity_pairs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;List pairs of commodities.</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a><span class="sd">        A list of pairs of commodities. Pairs of operating currencies will</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a><span class="sd">        be given in both directions not just in the one found in file.</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">commodity_pairs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;operating_currency&quot;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.RustfavaLedger.statement_path" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">statement_path</span><span class="p">(</span><span class="n">entry_hash</span><span class="p">,</span> <span class="n">metadata_key</span><span class="p">)</span></code>

<a href="#rustfava.core.RustfavaLedger.statement_path" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the path for a statement found in the specified entry.</p>
<p>The entry that we look up should contain a path to a document (absolute
or relative to the filename of the entry) or just its basename. We go
through all documents and match on the full path or if one of the
documents with a matching account has a matching file basename.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entry_hash</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hash of the entry containing the path in its metadata.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metadata_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key that the path should be in.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filename of the matching document entry.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="StatementMetadataInvalidError (rustfava.core.StatementMetadataInvalidError)" href="#rustfava.core.StatementMetadataInvalidError">StatementMetadataInvalidError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the metadata at the given key is
                           invalid.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="StatementNotFoundError (rustfava.core.StatementNotFoundError)" href="#rustfava.core.StatementNotFoundError">StatementNotFoundError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no matching document is found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-692" name="__codelineno-0-692"></a><span class="k">def</span><span class="w"> </span><span class="nf">statement_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">metadata_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the path for a statement found in the specified entry.</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="sd">    The entry that we look up should contain a path to a document (absolute</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="sd">    or relative to the filename of the entry) or just its basename. We go</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">    through all documents and match on the full path or if one of the</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">    documents with a matching account has a matching file basename.</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">        entry_hash: Hash of the entry containing the path in its metadata.</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">        metadata_key: The key that the path should be in.</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">        The filename of the matching document entry.</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">        StatementMetadataInvalidError: If the metadata at the given key is</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a><span class="sd">                                       invalid.</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="sd">        StatementNotFoundError: If no matching document is found.</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>    <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_entry</span><span class="p">(</span><span class="n">entry_hash</span><span class="p">)</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>    <span class="n">value</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">metadata_key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="k">raise</span> <span class="n">StatementMetadataInvalidError</span><span class="p">(</span><span class="n">metadata_key</span><span class="p">)</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>    <span class="n">accounts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">get_entry_accounts</span><span class="p">(</span><span class="n">entry</span><span class="p">))</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>    <span class="n">filename</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_position</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>    <span class="n">full_path</span> <span class="o">=</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>    <span class="k">for</span> <span class="n">document</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Document</span><span class="p">:</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>        <span class="n">document_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>        <span class="k">if</span> <span class="n">document_path</span> <span class="o">==</span> <span class="n">full_path</span><span class="p">:</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>            <span class="k">return</span> <span class="n">document</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>        <span class="k">if</span> <span class="n">document</span><span class="o">.</span><span class="n">account</span> <span class="ow">in</span> <span class="n">accounts</span> <span class="ow">and</span> <span class="n">document_path</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>            <span class="k">return</span> <span class="n">document</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>    <span class="k">raise</span> <span class="n">StatementNotFoundError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>



<div class="doc doc-object doc-module">



<h3 id="rustfava.core.accounts" class="doc doc-heading">
            <code>accounts</code>


<a href="#rustfava.core.accounts" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Account close date and metadata.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.accounts.LastEntry" class="doc doc-heading">
            <code>LastEntry</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.accounts.LastEntry" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>Date and hash of the last entry for an account.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/accounts.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="k">class</span><span class="w"> </span><span class="nc">LastEntry</span><span class="p">:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Date and hash of the last entry for an account.&quot;&quot;&quot;</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="c1">#: The entry date.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="c1">#: The entry hash.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">entry_hash</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.accounts.AccountData" class="doc doc-heading">
            <code>AccountData</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.accounts.AccountData" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>Holds information about an account.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/accounts.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="nd">@dataclass</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="k">class</span><span class="w"> </span><span class="nc">AccountData</span><span class="p">:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Holds information about an account.&quot;&quot;&quot;</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="c1">#: The date on which this account is closed (or datetime.date.max).</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">close_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="c1">#: The metadata of the Open entry of this account.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="n">meta</span><span class="p">:</span> <span class="n">Meta</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="c1">#: Uptodate status. Is only computed if the account has a</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="c1">#: &quot;fava-uptodate-indication&quot; meta attribute.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="n">uptodate_status</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="c1">#: Balance directive if this account has an uptodate status.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="n">balance_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="c1">#: The last entry of the account (unless it is a close Entry)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="n">last_entry</span><span class="p">:</span> <span class="n">LastEntry</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.accounts.AccountDict" class="doc doc-heading">
            <code>AccountDict</code>


<a href="#rustfava.core.accounts.AccountDict" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FavaModule (rustfava.core.module_base.FavaModule)" href="#rustfava.core.module_base.FavaModule">FavaModule</a></code>, <code><span title="dict">dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="AccountData


  
      dataclass
   (rustfava.core.accounts.AccountData)" href="#rustfava.core.accounts.AccountData">AccountData</a>]</code></p>



        <p>Account info dictionary.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/accounts.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="k">class</span><span class="w"> </span><span class="nc">AccountDict</span><span class="p">(</span><span class="n">FavaModule</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AccountData</span><span class="p">]):</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Account info dictionary.&quot;&quot;&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="n">EMPTY</span> <span class="o">=</span> <span class="n">AccountData</span><span class="p">()</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__missing__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AccountData</span><span class="p">:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">EMPTY</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">setdefault</span><span class="p">(</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">_</span><span class="p">:</span> <span class="n">AccountData</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AccountData</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the account of the given name, insert one if it is missing.&quot;&quot;&quot;</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">AccountData</span><span class="p">()</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">entries_by_account</span> <span class="o">=</span> <span class="n">group_entries_by_account</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="n">tree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="k">for</span> <span class="n">open_entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Open</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="n">meta</span> <span class="o">=</span> <span class="n">open_entry</span><span class="o">.</span><span class="n">meta</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="n">account_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">open_entry</span><span class="o">.</span><span class="n">account</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="n">account_data</span><span class="o">.</span><span class="n">meta</span> <span class="o">=</span> <span class="n">meta</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="n">txn_postings</span> <span class="o">=</span> <span class="n">entries_by_account</span><span class="p">[</span><span class="n">open_entry</span><span class="o">.</span><span class="n">account</span><span class="p">]</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>            <span class="n">last</span> <span class="o">=</span> <span class="n">get_last_entry</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="k">if</span> <span class="n">last</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last</span><span class="p">,</span> <span class="n">Close</span><span class="p">):</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                <span class="n">account_data</span><span class="o">.</span><span class="n">last_entry</span> <span class="o">=</span> <span class="n">LastEntry</span><span class="p">(</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>                    <span class="n">date</span><span class="o">=</span><span class="n">last</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>                    <span class="n">entry_hash</span><span class="o">=</span><span class="n">hash_entry</span><span class="p">(</span><span class="n">last</span><span class="p">),</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>                <span class="p">)</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>            <span class="k">if</span> <span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;fava-uptodate-indication&quot;</span><span class="p">):</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>                <span class="n">account_data</span><span class="o">.</span><span class="n">uptodate_status</span> <span class="o">=</span> <span class="n">uptodate_status</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>                <span class="k">if</span> <span class="n">account_data</span><span class="o">.</span><span class="n">uptodate_status</span> <span class="o">!=</span> <span class="s2">&quot;green&quot;</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>                    <span class="n">account_data</span><span class="o">.</span><span class="n">balance_string</span> <span class="o">=</span> <span class="n">balance_string</span><span class="p">(</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>                        <span class="n">tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">open_entry</span><span class="o">.</span><span class="n">account</span><span class="p">),</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>                    <span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="k">for</span> <span class="n">close</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Close</span><span class="p">:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">close</span><span class="o">.</span><span class="n">account</span><span class="p">)</span><span class="o">.</span><span class="n">close_date</span> <span class="o">=</span> <span class="n">close</span><span class="o">.</span><span class="n">date</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">all_balance_directives</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Balance directives for all accounts.&quot;&quot;&quot;</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="n">account_details</span><span class="o">.</span><span class="n">balance_string</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="k">for</span> <span class="n">account_details</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="k">if</span> <span class="n">account_details</span><span class="o">.</span><span class="n">balance_string</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.accounts.AccountDict.setdefault" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">_</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#rustfava.core.accounts.AccountDict.setdefault" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Get the account of the given name, insert one if it is missing.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/accounts.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="k">def</span><span class="w"> </span><span class="nf">setdefault</span><span class="p">(</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">_</span><span class="p">:</span> <span class="n">AccountData</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AccountData</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the account of the given name, insert one if it is missing.&quot;&quot;&quot;</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">AccountData</span><span class="p">()</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.accounts.AccountDict.all_balance_directives" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">all_balance_directives</span><span class="p">()</span></code>

<a href="#rustfava.core.accounts.AccountDict.all_balance_directives" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Balance directives for all accounts.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/accounts.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="k">def</span><span class="w"> </span><span class="nf">all_balance_directives</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Balance directives for all accounts.&quot;&quot;&quot;</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="n">account_details</span><span class="o">.</span><span class="n">balance_string</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="k">for</span> <span class="n">account_details</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="k">if</span> <span class="n">account_details</span><span class="o">.</span><span class="n">balance_string</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="rustfava.core.accounts.get_last_entry" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_last_entry</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">)</span></code>

<a href="#rustfava.core.accounts.get_last_entry" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Last entry.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/accounts.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_last_entry</span><span class="p">(</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">txn_postings</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span> <span class="o">|</span> <span class="n">TransactionPosting</span><span class="p">],</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Directive</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Last entry.&quot;&quot;&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="k">for</span> <span class="n">txn_posting</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">):</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">txn_posting</span><span class="p">,</span> <span class="n">TransactionPosting</span><span class="p">):</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>            <span class="n">transaction</span> <span class="o">=</span> <span class="n">txn_posting</span><span class="o">.</span><span class="n">transaction</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>            <span class="k">if</span> <span class="n">transaction</span><span class="o">.</span><span class="n">flag</span> <span class="o">!=</span> <span class="n">FLAG_UNREALIZED</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>                <span class="k">return</span> <span class="n">transaction</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>            <span class="k">return</span> <span class="n">txn_posting</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.accounts.uptodate_status" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">uptodate_status</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">)</span></code>

<a href="#rustfava.core.accounts.uptodate_status" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Status of the last balance or transaction.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>txn_postings</code>
            </td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="rustfava.beans.abc.Directive">Directive</span> | <a class="autorefs autorefs-internal" title="TransactionPosting (rustfava.core.group_entries.TransactionPosting)" href="#rustfava.core.group_entries.TransactionPosting">TransactionPosting</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The TransactionPosting for the account.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;green&#39;, &#39;yellow&#39;, &#39;red&#39;] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A status string for the last balance or transaction of the account.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;green&#39;, &#39;yellow&#39;, &#39;red&#39;] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>'green':  A balance check that passed.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;green&#39;, &#39;yellow&#39;, &#39;red&#39;] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>'red':    A balance check that failed.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;green&#39;, &#39;yellow&#39;, &#39;red&#39;] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>'yellow': Not a balance check.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/accounts.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="k">def</span><span class="w"> </span><span class="nf">uptodate_status</span><span class="p">(</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="n">txn_postings</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span> <span class="o">|</span> <span class="n">TransactionPosting</span><span class="p">],</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Status of the last balance or transaction.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        txn_postings: The TransactionPosting for the account.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        A status string for the last balance or transaction of the account.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        - &#39;green&#39;:  A balance check that passed.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        - &#39;red&#39;:    A balance check that failed.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        - &#39;yellow&#39;: Not a balance check.</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="k">for</span> <span class="n">txn_posting</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">):</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">txn_posting</span><span class="p">,</span> <span class="n">Balance</span><span class="p">):</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>            <span class="k">return</span> <span class="s2">&quot;red&quot;</span> <span class="k">if</span> <span class="n">txn_posting</span><span class="o">.</span><span class="n">diff_amount</span> <span class="k">else</span> <span class="s2">&quot;green&quot;</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">txn_posting</span><span class="p">,</span> <span class="n">TransactionPosting</span><span class="p">)</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>            <span class="ow">and</span> <span class="n">txn_posting</span><span class="o">.</span><span class="n">transaction</span><span class="o">.</span><span class="n">flag</span> <span class="o">!=</span> <span class="n">FLAG_UNREALIZED</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="p">):</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>            <span class="k">return</span> <span class="s2">&quot;yellow&quot;</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.accounts.balance_string" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">balance_string</span><span class="p">(</span><span class="n">tree_node</span><span class="p">)</span></code>

<a href="#rustfava.core.accounts.balance_string" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Balance directive for the given account for today.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/accounts.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="k">def</span><span class="w"> </span><span class="nf">balance_string</span><span class="p">(</span><span class="n">tree_node</span><span class="p">:</span> <span class="n">TreeNode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Balance directive for the given account for today.&quot;&quot;&quot;</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">account</span> <span class="o">=</span> <span class="n">tree_node</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">today</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">local_today</span><span class="p">())</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="k">for</span> <span class="n">currency</span><span class="p">,</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">UNITS</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">tree_node</span><span class="o">.</span><span class="n">balance</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">res</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">today</span><span class="si">}</span><span class="s2"> balance </span><span class="si">{</span><span class="n">account</span><span class="si">:</span><span class="s2">&lt;28</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">number</span><span class="si">:</span><span class="s2">&gt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">currency</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.attributes" class="doc doc-heading">
            <code>attributes</code>


<a href="#rustfava.core.attributes" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Attributes for auto-completion.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.attributes.AttributesModule" class="doc doc-heading">
            <code>AttributesModule</code>


<a href="#rustfava.core.attributes.AttributesModule" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FavaModule (rustfava.core.module_base.FavaModule)" href="#rustfava.core.module_base.FavaModule">FavaModule</a></code></p>



        <p>Some attributes of the ledger (mostly for auto-completion).</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/attributes.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="k">class</span><span class="w"> </span><span class="nc">AttributesModule</span><span class="p">(</span><span class="n">FavaModule</span><span class="p">):</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Some attributes of the ledger (mostly for auto-completion).&quot;&quot;&quot;</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger</span><span class="p">:</span> <span class="n">RustfavaLedger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ledger</span><span class="p">)</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">accounts</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">currencies</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">payees</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="n">all_entries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">all_links</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="n">all_tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">all_entries</span><span class="p">:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>            <span class="n">links</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;links&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>            <span class="k">if</span> <span class="n">links</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>                <span class="n">all_links</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">links</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>            <span class="n">tags</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>            <span class="k">if</span> <span class="n">tags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>                <span class="n">all_tags</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">links</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">all_links</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">all_tags</span><span class="p">)</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">years</span> <span class="o">=</span> <span class="n">get_active_years</span><span class="p">(</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>            <span class="n">all_entries</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">fiscal_year_end</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="n">account_ranker</span> <span class="o">=</span> <span class="n">ExponentialDecayRanker</span><span class="p">(</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">accounts</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="n">currency_ranker</span> <span class="o">=</span> <span class="n">ExponentialDecayRanker</span><span class="p">()</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="n">payee_ranker</span> <span class="o">=</span> <span class="n">ExponentialDecayRanker</span><span class="p">()</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="k">for</span> <span class="n">txn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Transaction</span><span class="p">:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="k">if</span> <span class="n">txn</span><span class="o">.</span><span class="n">payee</span><span class="p">:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>                <span class="n">payee_ranker</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">txn</span><span class="o">.</span><span class="n">payee</span><span class="p">,</span> <span class="n">txn</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">txn</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>                <span class="n">account_ranker</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="n">txn</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>                <span class="c1"># Skip postings with missing units (can happen with parse errors)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>                <span class="k">if</span> <span class="n">posting</span><span class="o">.</span><span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                    <span class="n">currency_ranker</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">txn</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                <span class="k">if</span> <span class="n">posting</span><span class="o">.</span><span class="n">cost</span> <span class="ow">and</span> <span class="n">posting</span><span class="o">.</span><span class="n">cost</span><span class="o">.</span><span class="n">currency</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>                    <span class="n">currency_ranker</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">cost</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">txn</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">accounts</span> <span class="o">=</span> <span class="n">account_ranker</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">currencies</span> <span class="o">=</span> <span class="n">currency_ranker</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">payees</span> <span class="o">=</span> <span class="n">payee_ranker</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">payee_accounts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payee</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Rank accounts for the given payee.&quot;&quot;&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="n">account_ranker</span> <span class="o">=</span> <span class="n">ExponentialDecayRanker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">accounts</span><span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">transactions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Transaction</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="k">for</span> <span class="n">txn</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="k">if</span> <span class="n">txn</span><span class="o">.</span><span class="n">payee</span> <span class="o">==</span> <span class="n">payee</span><span class="p">:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>                <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">txn</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>                    <span class="n">account_ranker</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="n">txn</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="k">return</span> <span class="n">account_ranker</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">payee_transaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payee</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Transaction</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the last transaction for a payee.&quot;&quot;&quot;</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">transactions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Transaction</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="k">for</span> <span class="n">txn</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">transactions</span><span class="p">):</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>            <span class="k">if</span> <span class="n">txn</span><span class="o">.</span><span class="n">payee</span> <span class="o">==</span> <span class="n">payee</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>                <span class="k">return</span> <span class="n">txn</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">narration_transaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">narration</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Transaction</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the last transaction for a narration.&quot;&quot;&quot;</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">transactions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Transaction</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="k">for</span> <span class="n">txn</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">transactions</span><span class="p">):</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="k">if</span> <span class="n">txn</span><span class="o">.</span><span class="n">narration</span> <span class="o">==</span> <span class="n">narration</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>                <span class="k">return</span> <span class="n">txn</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">narrations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the narrations of all transactions.&quot;&quot;&quot;</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">narration_ranker</span> <span class="o">=</span> <span class="n">ExponentialDecayRanker</span><span class="p">()</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="k">for</span> <span class="n">txn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Transaction</span><span class="p">:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>            <span class="k">if</span> <span class="n">txn</span><span class="o">.</span><span class="n">narration</span><span class="p">:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>                <span class="n">narration_ranker</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">txn</span><span class="o">.</span><span class="n">narration</span><span class="p">,</span> <span class="n">txn</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">return</span> <span class="n">narration_ranker</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="rustfava.core.attributes.AttributesModule.narrations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">narrations</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#rustfava.core.attributes.AttributesModule.narrations" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Get the narrations of all transactions.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h5 id="rustfava.core.attributes.AttributesModule.payee_accounts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">payee_accounts</span><span class="p">(</span><span class="n">payee</span><span class="p">)</span></code>

<a href="#rustfava.core.attributes.AttributesModule.payee_accounts" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Rank accounts for the given payee.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/attributes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="k">def</span><span class="w"> </span><span class="nf">payee_accounts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payee</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Rank accounts for the given payee.&quot;&quot;&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">account_ranker</span> <span class="o">=</span> <span class="n">ExponentialDecayRanker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">accounts</span><span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="n">transactions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Transaction</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="k">for</span> <span class="n">txn</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="k">if</span> <span class="n">txn</span><span class="o">.</span><span class="n">payee</span> <span class="o">==</span> <span class="n">payee</span><span class="p">:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">txn</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>                <span class="n">account_ranker</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="n">txn</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">return</span> <span class="n">account_ranker</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.attributes.AttributesModule.payee_transaction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">payee_transaction</span><span class="p">(</span><span class="n">payee</span><span class="p">)</span></code>

<a href="#rustfava.core.attributes.AttributesModule.payee_transaction" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Get the last transaction for a payee.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/attributes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="k">def</span><span class="w"> </span><span class="nf">payee_transaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payee</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Transaction</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the last transaction for a payee.&quot;&quot;&quot;</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">transactions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Transaction</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="k">for</span> <span class="n">txn</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">transactions</span><span class="p">):</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">if</span> <span class="n">txn</span><span class="o">.</span><span class="n">payee</span> <span class="o">==</span> <span class="n">payee</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="k">return</span> <span class="n">txn</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.attributes.AttributesModule.narration_transaction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">narration_transaction</span><span class="p">(</span><span class="n">narration</span><span class="p">)</span></code>

<a href="#rustfava.core.attributes.AttributesModule.narration_transaction" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Get the last transaction for a narration.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/attributes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="k">def</span><span class="w"> </span><span class="nf">narration_transaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">narration</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Transaction</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the last transaction for a narration.&quot;&quot;&quot;</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="n">transactions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Transaction</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="k">for</span> <span class="n">txn</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">transactions</span><span class="p">):</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="k">if</span> <span class="n">txn</span><span class="o">.</span><span class="n">narration</span> <span class="o">==</span> <span class="n">narration</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="k">return</span> <span class="n">txn</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="rustfava.core.attributes.get_active_years" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_active_years</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">fye</span><span class="p">)</span></code>

<a href="#rustfava.core.attributes.get_active_years" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return active years, with support for fiscal years.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entries</code>
            </td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="rustfava.beans.abc.Directive">Directive</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Beancount entries</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fye</code>
            </td>
            <td>
                  <code><span title="rustfava.util.date.FiscalYearEnd">FiscalYearEnd</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>fiscal year end</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A reverse sorted list of years or fiscal years that occur in the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>entries.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/attributes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_active_years</span><span class="p">(</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">],</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="n">fye</span><span class="p">:</span> <span class="n">FiscalYearEnd</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return active years, with support for fiscal years.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        entries: Beancount entries</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        fye: fiscal year end</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        A reverse sorted list of years or fiscal years that occur in the</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        entries.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="n">years</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="k">if</span> <span class="n">fye</span> <span class="o">==</span> <span class="n">END_OF_YEAR</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        <span class="n">prev_year</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>            <span class="n">year</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">year</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>            <span class="k">if</span> <span class="n">year</span> <span class="o">!=</span> <span class="n">prev_year</span><span class="p">:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>                <span class="n">prev_year</span> <span class="o">=</span> <span class="n">year</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>                <span class="n">years</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="k">return</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">years</span><span class="p">)]</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">month</span> <span class="o">=</span> <span class="n">fye</span><span class="o">.</span><span class="n">month</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">day</span> <span class="o">=</span> <span class="n">fye</span><span class="o">.</span><span class="n">day</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="n">prev_year</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="n">date</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="n">year</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>            <span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">year</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>            <span class="k">if</span> <span class="n">date</span><span class="o">.</span><span class="n">month</span> <span class="o">&gt;</span> <span class="n">month</span> <span class="ow">or</span> <span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="n">month</span> <span class="ow">and</span> <span class="n">date</span><span class="o">.</span><span class="n">day</span> <span class="o">&gt;</span> <span class="n">day</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>            <span class="k">else</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">year</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="k">if</span> <span class="n">year</span> <span class="o">!=</span> <span class="n">prev_year</span><span class="p">:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>            <span class="n">prev_year</span> <span class="o">=</span> <span class="n">year</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>            <span class="n">years</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">return</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;FY</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">years</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.budgets" class="doc doc-heading">
            <code>budgets</code>


<a href="#rustfava.core.budgets" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Parsing and computing budgets.</p>










<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="rustfava.core.budgets.BudgetDict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">BudgetDict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Budget</span><span class="p">]]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#rustfava.core.budgets.BudgetDict" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>A map of account names to lists of budget entries.</p>

    </div>

</div>



<div class="doc doc-object doc-class">



<h4 id="rustfava.core.budgets.Budget" class="doc doc-heading">
            <code>Budget</code>


<a href="#rustfava.core.budgets.Budget" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>



        <p>A budget entry.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/budgets.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="k">class</span><span class="w"> </span><span class="nc">Budget</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A budget entry.&quot;&quot;&quot;</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">account</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">date_start</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">period</span><span class="p">:</span> <span class="n">Interval</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="n">number</span><span class="p">:</span> <span class="n">Decimal</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">currency</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.budgets.BudgetError" class="doc doc-heading">
            <code>BudgetError</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.budgets.BudgetError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.BeancountError">BeancountError</span></code></p>



        <p>Error with a budget.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/budgets.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="k">class</span><span class="w"> </span><span class="nc">BudgetError</span><span class="p">(</span><span class="n">BeancountError</span><span class="p">):</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Error with a budget.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.budgets.BudgetModule" class="doc doc-heading">
            <code>BudgetModule</code>


<a href="#rustfava.core.budgets.BudgetModule" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FavaModule (rustfava.core.module_base.FavaModule)" href="#rustfava.core.module_base.FavaModule">FavaModule</a></code></p>



        <p>Parses budget entries.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/budgets.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="k">class</span><span class="w"> </span><span class="nc">BudgetModule</span><span class="p">(</span><span class="n">FavaModule</span><span class="p">):</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parses budget entries.&quot;&quot;&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger</span><span class="p">:</span> <span class="n">RustfavaLedger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ledger</span><span class="p">)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_budget_entries</span><span class="p">:</span> <span class="n">BudgetDict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BudgetError</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_budget_entries</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">parse_budgets</span><span class="p">(</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Custom</span><span class="p">,</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="p">)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate</span><span class="p">(</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="n">account</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="n">begin_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="n">end_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">]:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the budget for an account in an interval.&quot;&quot;&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="k">return</span> <span class="n">calculate_budget</span><span class="p">(</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_budget_entries</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>            <span class="n">account</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>            <span class="n">begin_date</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>            <span class="n">end_date</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="p">)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_children</span><span class="p">(</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">account</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">begin_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="n">end_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">]:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the budget for an account including its children.&quot;&quot;&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="k">return</span> <span class="n">calculate_budget_children</span><span class="p">(</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_budget_entries</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>            <span class="n">account</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>            <span class="n">begin_date</span><span class="p">,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>            <span class="n">end_date</span><span class="p">,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.budgets.BudgetModule.calculate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">begin_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span></code>

<a href="#rustfava.core.budgets.BudgetModule.calculate" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Calculate the budget for an account in an interval.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/budgets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="k">def</span><span class="w"> </span><span class="nf">calculate</span><span class="p">(</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">account</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">begin_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">end_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">]:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the budget for an account in an interval.&quot;&quot;&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="k">return</span> <span class="n">calculate_budget</span><span class="p">(</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_budget_entries</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">account</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">begin_date</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">end_date</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.budgets.BudgetModule.calculate_children" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_children</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">begin_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span></code>

<a href="#rustfava.core.budgets.BudgetModule.calculate_children" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Calculate the budget for an account including its children.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/budgets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="k">def</span><span class="w"> </span><span class="nf">calculate_children</span><span class="p">(</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">account</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">begin_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">end_date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">]:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the budget for an account including its children.&quot;&quot;&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="k">return</span> <span class="n">calculate_budget_children</span><span class="p">(</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_budget_entries</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="n">account</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">begin_date</span><span class="p">,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="n">end_date</span><span class="p">,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="rustfava.core.budgets.parse_budgets" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_budgets</span><span class="p">(</span><span class="n">custom_entries</span><span class="p">)</span></code>

<a href="#rustfava.core.budgets.parse_budgets" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Parse budget directives from custom entries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>custom_entries</code>
            </td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="rustfava.beans.abc.Custom">Custom</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the Custom entries to parse budgets from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<a class="autorefs autorefs-internal" title="BudgetDict = dict[str, list[Budget]]

  
      module-attribute
   (rustfava.core.budgets.BudgetDict)" href="#rustfava.core.budgets.BudgetDict">BudgetDict</a>, <span title="collections.abc.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="BudgetError


  
      dataclass
   (rustfava.core.budgets.BudgetError)" href="#rustfava.core.budgets.BudgetError">BudgetError</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dict of accounts to lists of budgets.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>2015-04-09 custom "budget" Expenses:Books "monthly" 20.00 EUR</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/budgets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="k">def</span><span class="w"> </span><span class="nf">parse_budgets</span><span class="p">(</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">custom_entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Custom</span><span class="p">],</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">BudgetDict</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BudgetError</span><span class="p">]]:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse budget directives from custom entries.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        custom_entries: the Custom entries to parse budgets from.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        A dict of accounts to lists of budgets.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        2015-04-09 custom &quot;budget&quot; Expenses:Books &quot;monthly&quot; 20.00 EUR</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="n">budgets</span><span class="p">:</span> <span class="n">BudgetDict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="p">(</span><span class="n">entry</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">custom_entries</span> <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;budget&quot;</span><span class="p">):</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="n">interval</span> <span class="o">=</span> <span class="n">INTERVALS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">interval</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                    <span class="n">BudgetError</span><span class="p">(</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                        <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>                        <span class="s2">&quot;Invalid interval for budget entry&quot;</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>                        <span class="n">entry</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>                    <span class="p">),</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                <span class="p">)</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>                <span class="k">continue</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="n">budget</span> <span class="o">=</span> <span class="n">Budget</span><span class="p">(</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>                <span class="n">entry</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>                <span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>                <span class="n">interval</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>                <span class="n">entry</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">number</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>                <span class="n">entry</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="n">budgets</span><span class="p">[</span><span class="n">budget</span><span class="o">.</span><span class="n">account</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">budget</span><span class="p">)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>                <span class="n">BudgetError</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">,</span> <span class="s2">&quot;Failed to parse budget entry&quot;</span><span class="p">,</span> <span class="n">entry</span><span class="p">),</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>            <span class="p">)</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">return</span> <span class="n">budgets</span><span class="p">,</span> <span class="n">errors</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.budgets.calculate_budget" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_budget</span><span class="p">(</span><span class="n">budgets</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">date_from</span><span class="p">,</span> <span class="n">date_to</span><span class="p">)</span></code>

<a href="#rustfava.core.budgets.calculate_budget" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Calculate budget for an account.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>budgets</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="BudgetDict = dict[str, list[Budget]]

  
      module-attribute
   (rustfava.core.budgets.BudgetDict)" href="#rustfava.core.budgets.BudgetDict">BudgetDict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of :class:<code>Budget</code> entries.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>account</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An account name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_from</code>
            </td>
            <td>
                  <code><span title="datetime.date">date</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Starting date.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_to</code>
            </td>
            <td>
                  <code><span title="datetime.date">date</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>End date (exclusive).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Mapping">Mapping</span>[<span title="str">str</span>, <span title="decimal.Decimal">Decimal</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of currency to Decimal with the budget for the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Mapping">Mapping</span>[<span title="str">str</span>, <span title="decimal.Decimal">Decimal</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specified account and period.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/budgets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="k">def</span><span class="w"> </span><span class="nf">calculate_budget</span><span class="p">(</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="n">budgets</span><span class="p">:</span> <span class="n">BudgetDict</span><span class="p">,</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="n">account</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="n">date_from</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="n">date_to</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">]:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate budget for an account.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        budgets: A list of :class:`Budget` entries.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        account: An account name.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        date_from: Starting date.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        date_to: End date (exclusive).</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        A dictionary of currency to Decimal with the budget for the</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        specified account and period.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="n">budget_list</span> <span class="o">=</span> <span class="n">budgets</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="k">if</span> <span class="n">budget_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="k">return</span> <span class="p">{}</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="n">currency_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Decimal</span><span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">days_in_daterange</span><span class="p">(</span><span class="n">date_from</span><span class="p">,</span> <span class="n">date_to</span><span class="p">):</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">matches</span> <span class="o">=</span> <span class="n">_matching_budgets</span><span class="p">(</span><span class="n">budget_list</span><span class="p">,</span> <span class="n">day</span><span class="p">)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="k">for</span> <span class="n">budget</span> <span class="ow">in</span> <span class="n">matches</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>            <span class="n">days_in_period</span> <span class="o">=</span> <span class="n">budget</span><span class="o">.</span><span class="n">period</span><span class="o">.</span><span class="n">number_of_days</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>            <span class="n">currency_dict</span><span class="p">[</span><span class="n">budget</span><span class="o">.</span><span class="n">currency</span><span class="p">]</span> <span class="o">+=</span> <span class="n">budget</span><span class="o">.</span><span class="n">number</span> <span class="o">/</span> <span class="n">days_in_period</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">currency_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.budgets.calculate_budget_children" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_budget_children</span><span class="p">(</span><span class="n">budgets</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">date_from</span><span class="p">,</span> <span class="n">date_to</span><span class="p">)</span></code>

<a href="#rustfava.core.budgets.calculate_budget_children" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Calculate budget for an account including budgets of its children.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>budgets</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="BudgetDict = dict[str, list[Budget]]

  
      module-attribute
   (rustfava.core.budgets.BudgetDict)" href="#rustfava.core.budgets.BudgetDict">BudgetDict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of :class:<code>Budget</code> entries.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>account</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An account name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_from</code>
            </td>
            <td>
                  <code><span title="datetime.date">date</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Starting date.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_to</code>
            </td>
            <td>
                  <code><span title="datetime.date">date</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>End date (exclusive).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Mapping">Mapping</span>[<span title="str">str</span>, <span title="decimal.Decimal">Decimal</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of currency to Decimal with the budget for the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Mapping">Mapping</span>[<span title="str">str</span>, <span title="decimal.Decimal">Decimal</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specified account and period.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/budgets.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="k">def</span><span class="w"> </span><span class="nf">calculate_budget_children</span><span class="p">(</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="n">budgets</span><span class="p">:</span> <span class="n">BudgetDict</span><span class="p">,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="n">account</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="n">date_from</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="n">date_to</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">]:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate budget for an account including budgets of its children.</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        budgets: A list of :class:`Budget` entries.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        account: An account name.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        date_from: Starting date.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        date_to: End date (exclusive).</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        A dictionary of currency to Decimal with the budget for the</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        specified account and period.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="n">currency_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">]</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>  <span class="c1"># type: ignore[assignment]</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">budgets</span><span class="p">:</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">account</span><span class="p">):</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span class="n">currency_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                <span class="n">calculate_budget</span><span class="p">(</span><span class="n">budgets</span><span class="p">,</span> <span class="n">child</span><span class="p">,</span> <span class="n">date_from</span><span class="p">,</span> <span class="n">date_to</span><span class="p">),</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="p">)</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">currency_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.charts" class="doc doc-heading">
            <code>charts</code>


<a href="#rustfava.core.charts" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Provide data suitable for rustfava's charts.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.charts.RustfavaJSONProvider" class="doc doc-heading">
            <code>RustfavaJSONProvider</code>


<a href="#rustfava.core.charts.RustfavaJSONProvider" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flask.json.provider.JSONProvider">JSONProvider</span></code></p>



        <p>Use custom JSON encoder and decoder.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/charts.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="k">class</span><span class="w"> </span><span class="nc">RustfavaJSONProvider</span><span class="p">(</span><span class="n">JSONProvider</span><span class="p">):</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Use custom JSON encoder and decoder.&quot;&quot;&quot;</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">_kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>            <span class="n">obj</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="n">_json_default</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">,</span> <span class="o">**</span><span class="n">_kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.charts.DateAndBalance" class="doc doc-heading">
            <code>DateAndBalance</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.charts.DateAndBalance" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>Balance at a date.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/charts.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="k">class</span><span class="w"> </span><span class="nc">DateAndBalance</span><span class="p">:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Balance at a date.&quot;&quot;&quot;</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">date</span><span class="p">:</span> <span class="n">date</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">balance</span><span class="p">:</span> <span class="n">SimpleCounterInventory</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.charts.DateAndBalanceWithBudget" class="doc doc-heading">
            <code>DateAndBalanceWithBudget</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.charts.DateAndBalanceWithBudget" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>Balance at a date with a budget.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/charts.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="k">class</span><span class="w"> </span><span class="nc">DateAndBalanceWithBudget</span><span class="p">:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Balance at a date with a budget.&quot;&quot;&quot;</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="n">date</span><span class="p">:</span> <span class="n">date</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="n">balance</span><span class="p">:</span> <span class="n">SimpleCounterInventory</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="n">account_balances</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">SimpleCounterInventory</span><span class="p">]</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">budgets</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.charts.ChartModule" class="doc doc-heading">
            <code>ChartModule</code>


<a href="#rustfava.core.charts.ChartModule" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FavaModule (rustfava.core.module_base.FavaModule)" href="#rustfava.core.module_base.FavaModule">FavaModule</a></code></p>



        <p>Return data for the various charts in rustfava.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/charts.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="k">class</span><span class="w"> </span><span class="nc">ChartModule</span><span class="p">(</span><span class="n">FavaModule</span><span class="p">):</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return data for the various charts in rustfava.&quot;&quot;&quot;</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">hierarchy</span><span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="n">filtered</span><span class="p">:</span> <span class="n">FilteredLedger</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="n">account_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="n">conversion</span><span class="p">:</span> <span class="n">Conversion</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SerialisedTreeNode</span><span class="p">:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Render an account tree.&quot;&quot;&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="n">tree</span> <span class="o">=</span> <span class="n">filtered</span><span class="o">.</span><span class="n">root_tree</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="k">return</span> <span class="n">tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span><span class="o">.</span><span class="n">serialise</span><span class="p">(</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="n">conversion</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">prices</span><span class="p">,</span> <span class="n">filtered</span><span class="o">.</span><span class="n">end_date</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="nd">@listify</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">interval_totals</span><span class="p">(</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">filtered</span><span class="p">:</span> <span class="n">FilteredLedger</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">interval</span><span class="p">:</span> <span class="n">Interval</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">accounts</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">conversion</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Conversion</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">DateAndBalanceWithBudget</span><span class="p">]:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Render totals for account (or accounts) in the intervals.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            filtered: The filtered ledger.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">            interval: An interval.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">            accounts: A single account (str) or a tuple of accounts.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            conversion: The conversion to use.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            invert: invert all numbers.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        Yields:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            The balances and budgets for the intervals.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">conv</span> <span class="o">=</span> <span class="n">conversion_from_str</span><span class="p">(</span><span class="n">conversion</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">prices</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="c1"># limit the bar charts to 100 intervals</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">intervals</span> <span class="o">=</span> <span class="n">filtered</span><span class="o">.</span><span class="n">interval_ranges</span><span class="p">(</span><span class="n">interval</span><span class="p">)[</span><span class="o">-</span><span class="mi">100</span><span class="p">:]</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="k">for</span> <span class="n">date_range</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">:</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="n">inventory</span> <span class="o">=</span> <span class="n">CounterInventory</span><span class="p">()</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>            <span class="n">entries</span> <span class="o">=</span> <span class="n">slice_entry_dates</span><span class="p">(</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>                <span class="n">filtered</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span> <span class="n">date_range</span><span class="o">.</span><span class="n">begin</span><span class="p">,</span> <span class="n">date_range</span><span class="o">.</span><span class="n">end</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>            <span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="n">account_inventories</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">CounterInventory</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>                <span class="n">CounterInventory</span><span class="p">,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="p">)</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>                <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;postings&quot;</span><span class="p">,</span> <span class="p">[]):</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>                    <span class="k">if</span> <span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">accounts</span><span class="p">):</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                        <span class="n">account_inventories</span><span class="p">[</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">]</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                            <span class="n">posting</span><span class="p">,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                        <span class="p">)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>                        <span class="n">inventory</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="n">balance</span> <span class="o">=</span> <span class="n">conv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>                <span class="n">inventory</span><span class="p">,</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>                <span class="n">prices</span><span class="p">,</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>                <span class="n">date_range</span><span class="o">.</span><span class="n">end_inclusive</span><span class="p">,</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="p">)</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>            <span class="n">account_balances</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>                <span class="n">account</span><span class="p">:</span> <span class="n">conv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>                    <span class="n">acct_value</span><span class="p">,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>                    <span class="n">prices</span><span class="p">,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>                    <span class="n">date_range</span><span class="o">.</span><span class="n">end_inclusive</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>                <span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>                <span class="k">for</span> <span class="n">account</span><span class="p">,</span> <span class="n">acct_value</span> <span class="ow">in</span> <span class="n">account_inventories</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>            <span class="p">}</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>            <span class="n">budgets</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">budgets</span><span class="o">.</span><span class="n">calculate_children</span><span class="p">(</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>                    <span class="n">accounts</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>                    <span class="n">date_range</span><span class="o">.</span><span class="n">begin</span><span class="p">,</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>                    <span class="n">date_range</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>                <span class="p">)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">accounts</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                <span class="k">else</span> <span class="p">{}</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="k">if</span> <span class="n">invert</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                <span class="n">balance</span> <span class="o">=</span> <span class="o">-</span><span class="n">balance</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                <span class="n">budgets</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="o">-</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">budgets</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                <span class="n">account_balances</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="o">-</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">account_balances</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>            <span class="k">yield</span> <span class="n">DateAndBalanceWithBudget</span><span class="p">(</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                <span class="n">date_range</span><span class="o">.</span><span class="n">end_inclusive</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                <span class="n">balance</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>                <span class="n">account_balances</span><span class="p">,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>                <span class="n">budgets</span><span class="p">,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>            <span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="nd">@listify</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">linechart</span><span class="p">(</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">filtered</span><span class="p">:</span> <span class="n">FilteredLedger</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="n">account_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="n">conversion</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Conversion</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">DateAndBalance</span><span class="p">]:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the balance of an account as a line chart.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            filtered: The filtered ledger.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">            account_name: A string.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">            conversion: The conversion to use.</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        Yields:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">            Dicts for all dates on which the balance of the given</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">            account has changed containing the balance (in units) of the</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">            account at that date.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="n">conv</span> <span class="o">=</span> <span class="n">conversion_from_str</span><span class="p">(</span><span class="n">conversion</span><span class="p">)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">_balances</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">date</span><span class="p">,</span> <span class="n">CounterInventory</span><span class="p">]]:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>            <span class="n">last_date</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="n">running_balance</span> <span class="o">=</span> <span class="n">CounterInventory</span><span class="p">()</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="n">is_child_account</span> <span class="o">=</span> <span class="n">account_tester</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="n">with_children</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">filtered</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>                <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;postings&quot;</span><span class="p">,</span> <span class="p">[]):</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>                    <span class="k">if</span> <span class="n">is_child_account</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">):</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>                        <span class="n">new_date</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>                        <span class="k">if</span> <span class="n">last_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">new_date</span> <span class="o">&gt;</span> <span class="n">last_date</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>                            <span class="k">yield</span> <span class="p">(</span><span class="n">last_date</span><span class="p">,</span> <span class="n">running_balance</span><span class="p">)</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>                        <span class="n">running_balance</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                        <span class="n">last_date</span> <span class="o">=</span> <span class="n">new_date</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="k">if</span> <span class="n">last_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>                <span class="k">yield</span> <span class="p">(</span><span class="n">last_date</span><span class="p">,</span> <span class="n">running_balance</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="c1"># When the balance for a commodity just went to zero, it will be</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="c1"># missing from the &#39;balance&#39; so keep track of currencies that last had</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="c1"># a balance.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="n">last_currencies</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="n">prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">prices</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">running_bal</span> <span class="ow">in</span> <span class="n">_balances</span><span class="p">():</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>            <span class="n">balance</span> <span class="o">=</span> <span class="n">conv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">running_bal</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>            <span class="n">currencies</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">balance</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>            <span class="k">if</span> <span class="n">last_currencies</span><span class="p">:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>                <span class="k">for</span> <span class="n">currency</span> <span class="ow">in</span> <span class="n">last_currencies</span> <span class="o">-</span> <span class="n">currencies</span><span class="p">:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>                    <span class="n">balance</span><span class="p">[</span><span class="n">currency</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZERO</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>            <span class="n">last_currencies</span> <span class="o">=</span> <span class="n">currencies</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="k">yield</span> <span class="n">DateAndBalance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">balance</span><span class="p">)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="nd">@listify</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">net_worth</span><span class="p">(</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="n">filtered</span><span class="p">:</span> <span class="n">FilteredLedger</span><span class="p">,</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="n">interval</span><span class="p">:</span> <span class="n">Interval</span><span class="p">,</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="n">conversion</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Conversion</span><span class="p">,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">DateAndBalance</span><span class="p">]:</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute net worth.</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">            filtered: The filtered ledger.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            interval: A string for the interval.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">            conversion: The conversion to use.</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        Yields:</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">            Dicts for all ends of the given interval containing the</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">            net worth (Assets + Liabilities) separately converted to all</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">            operating currencies.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="n">conv</span> <span class="o">=</span> <span class="n">conversion_from_str</span><span class="p">(</span><span class="n">conversion</span><span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="n">transactions</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>            <span class="n">entry</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">filtered</span><span class="o">.</span><span class="n">entries</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>                <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>                <span class="ow">and</span> <span class="n">entry</span><span class="o">.</span><span class="n">flag</span> <span class="o">!=</span> <span class="n">FLAG_UNREALIZED</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="p">)</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="n">types</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_assets&quot;</span><span class="p">],</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_liabilities&quot;</span><span class="p">],</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="p">)</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="n">txn</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">transactions</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="n">inventory</span> <span class="o">=</span> <span class="n">CounterInventory</span><span class="p">()</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="n">prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">prices</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="k">for</span> <span class="n">date_range</span> <span class="ow">in</span> <span class="n">filtered</span><span class="o">.</span><span class="n">interval_ranges</span><span class="p">(</span><span class="n">interval</span><span class="p">):</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="k">while</span> <span class="n">txn</span> <span class="ow">and</span> <span class="n">txn</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;</span> <span class="n">date_range</span><span class="o">.</span><span class="n">end</span><span class="p">:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>                <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">txn</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>                    <span class="k">if</span> <span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">types</span><span class="p">):</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>                        <span class="n">inventory</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>                <span class="n">txn</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">transactions</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>            <span class="k">yield</span> <span class="n">DateAndBalance</span><span class="p">(</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>                <span class="n">date_range</span><span class="o">.</span><span class="n">end_inclusive</span><span class="p">,</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>                <span class="n">conv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>                    <span class="n">inventory</span><span class="p">,</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>                    <span class="n">prices</span><span class="p">,</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>                    <span class="n">date_range</span><span class="o">.</span><span class="n">end_inclusive</span><span class="p">,</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>                <span class="p">),</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.charts.ChartModule.hierarchy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hierarchy</span><span class="p">(</span><span class="n">filtered</span><span class="p">,</span> <span class="n">account_name</span><span class="p">,</span> <span class="n">conversion</span><span class="p">)</span></code>

<a href="#rustfava.core.charts.ChartModule.hierarchy" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Render an account tree.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/charts.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="k">def</span><span class="w"> </span><span class="nf">hierarchy</span><span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="n">filtered</span><span class="p">:</span> <span class="n">FilteredLedger</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="n">account_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="n">conversion</span><span class="p">:</span> <span class="n">Conversion</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SerialisedTreeNode</span><span class="p">:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Render an account tree.&quot;&quot;&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">tree</span> <span class="o">=</span> <span class="n">filtered</span><span class="o">.</span><span class="n">root_tree</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="k">return</span> <span class="n">tree</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span><span class="o">.</span><span class="n">serialise</span><span class="p">(</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">conversion</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">prices</span><span class="p">,</span> <span class="n">filtered</span><span class="o">.</span><span class="n">end_date</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.charts.ChartModule.interval_totals" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interval_totals</span><span class="p">(</span><span class="n">filtered</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">accounts</span><span class="p">,</span> <span class="n">conversion</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#rustfava.core.charts.ChartModule.interval_totals" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Render totals for account (or accounts) in the intervals.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filtered</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FilteredLedger (rustfava.core.FilteredLedger)" href="#rustfava.core.FilteredLedger">FilteredLedger</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filtered ledger.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="rustfava.util.date.Interval">Interval</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An interval.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>accounts</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="tuple">tuple</span>[<span title="str">str</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A single account (str) or a tuple of accounts.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conversion</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <a class="autorefs autorefs-internal" title="Conversion (rustfava.core.conversion.Conversion)" href="#rustfava.core.conversion.Conversion">Conversion</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The conversion to use.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>invert</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>invert all numbers.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="DateAndBalanceWithBudget


  
      dataclass
   (rustfava.core.charts.DateAndBalanceWithBudget)" href="#rustfava.core.charts.DateAndBalanceWithBudget">DateAndBalanceWithBudget</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The balances and budgets for the intervals.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/charts.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="nd">@listify</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="k">def</span><span class="w"> </span><span class="nf">interval_totals</span><span class="p">(</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="n">filtered</span><span class="p">:</span> <span class="n">FilteredLedger</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">interval</span><span class="p">:</span> <span class="n">Interval</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">accounts</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="n">conversion</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Conversion</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">invert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">DateAndBalanceWithBudget</span><span class="p">]:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Render totals for account (or accounts) in the intervals.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        filtered: The filtered ledger.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        interval: An interval.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        accounts: A single account (str) or a tuple of accounts.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        conversion: The conversion to use.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        invert: invert all numbers.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        The balances and budgets for the intervals.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="n">conv</span> <span class="o">=</span> <span class="n">conversion_from_str</span><span class="p">(</span><span class="n">conversion</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="n">prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">prices</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="c1"># limit the bar charts to 100 intervals</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">intervals</span> <span class="o">=</span> <span class="n">filtered</span><span class="o">.</span><span class="n">interval_ranges</span><span class="p">(</span><span class="n">interval</span><span class="p">)[</span><span class="o">-</span><span class="mi">100</span><span class="p">:]</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="k">for</span> <span class="n">date_range</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">:</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="n">inventory</span> <span class="o">=</span> <span class="n">CounterInventory</span><span class="p">()</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="n">entries</span> <span class="o">=</span> <span class="n">slice_entry_dates</span><span class="p">(</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>            <span class="n">filtered</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span> <span class="n">date_range</span><span class="o">.</span><span class="n">begin</span><span class="p">,</span> <span class="n">date_range</span><span class="o">.</span><span class="n">end</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="n">account_inventories</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">CounterInventory</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="n">CounterInventory</span><span class="p">,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="p">)</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>            <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;postings&quot;</span><span class="p">,</span> <span class="p">[]):</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>                <span class="k">if</span> <span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">accounts</span><span class="p">):</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                    <span class="n">account_inventories</span><span class="p">[</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">]</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                        <span class="n">posting</span><span class="p">,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                    <span class="p">)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>                    <span class="n">inventory</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">balance</span> <span class="o">=</span> <span class="n">conv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="n">inventory</span><span class="p">,</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="n">prices</span><span class="p">,</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="n">date_range</span><span class="o">.</span><span class="n">end_inclusive</span><span class="p">,</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="p">)</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">account_balances</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="n">account</span><span class="p">:</span> <span class="n">conv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>                <span class="n">acct_value</span><span class="p">,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>                <span class="n">prices</span><span class="p">,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>                <span class="n">date_range</span><span class="o">.</span><span class="n">end_inclusive</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>            <span class="k">for</span> <span class="n">account</span><span class="p">,</span> <span class="n">acct_value</span> <span class="ow">in</span> <span class="n">account_inventories</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="p">}</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">budgets</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">budgets</span><span class="o">.</span><span class="n">calculate_children</span><span class="p">(</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>                <span class="n">accounts</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>                <span class="n">date_range</span><span class="o">.</span><span class="n">begin</span><span class="p">,</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>                <span class="n">date_range</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>            <span class="p">)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">accounts</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="k">else</span> <span class="p">{}</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="k">if</span> <span class="n">invert</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="n">balance</span> <span class="o">=</span> <span class="o">-</span><span class="n">balance</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="n">budgets</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="o">-</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">budgets</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="n">account_balances</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="o">-</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">account_balances</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="k">yield</span> <span class="n">DateAndBalanceWithBudget</span><span class="p">(</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="n">date_range</span><span class="o">.</span><span class="n">end_inclusive</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="n">balance</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="n">account_balances</span><span class="p">,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="n">budgets</span><span class="p">,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.charts.ChartModule.linechart" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">linechart</span><span class="p">(</span><span class="n">filtered</span><span class="p">,</span> <span class="n">account_name</span><span class="p">,</span> <span class="n">conversion</span><span class="p">)</span></code>

<a href="#rustfava.core.charts.ChartModule.linechart" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Get the balance of an account as a line chart.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filtered</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FilteredLedger (rustfava.core.FilteredLedger)" href="#rustfava.core.FilteredLedger">FilteredLedger</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filtered ledger.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>account_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conversion</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <a class="autorefs autorefs-internal" title="Conversion (rustfava.core.conversion.Conversion)" href="#rustfava.core.conversion.Conversion">Conversion</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The conversion to use.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="DateAndBalance


  
      dataclass
   (rustfava.core.charts.DateAndBalance)" href="#rustfava.core.charts.DateAndBalance">DateAndBalance</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dicts for all dates on which the balance of the given</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="DateAndBalance


  
      dataclass
   (rustfava.core.charts.DateAndBalance)" href="#rustfava.core.charts.DateAndBalance">DateAndBalance</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>account has changed containing the balance (in units) of the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="DateAndBalance


  
      dataclass
   (rustfava.core.charts.DateAndBalance)" href="#rustfava.core.charts.DateAndBalance">DateAndBalance</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>account at that date.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/charts.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="nd">@listify</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="k">def</span><span class="w"> </span><span class="nf">linechart</span><span class="p">(</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="n">filtered</span><span class="p">:</span> <span class="n">FilteredLedger</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="n">account_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="n">conversion</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Conversion</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">DateAndBalance</span><span class="p">]:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the balance of an account as a line chart.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        filtered: The filtered ledger.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        account_name: A string.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        conversion: The conversion to use.</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        Dicts for all dates on which the balance of the given</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        account has changed containing the balance (in units) of the</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        account at that date.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">conv</span> <span class="o">=</span> <span class="n">conversion_from_str</span><span class="p">(</span><span class="n">conversion</span><span class="p">)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_balances</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">date</span><span class="p">,</span> <span class="n">CounterInventory</span><span class="p">]]:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">last_date</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">running_balance</span> <span class="o">=</span> <span class="n">CounterInventory</span><span class="p">()</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="n">is_child_account</span> <span class="o">=</span> <span class="n">account_tester</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="n">with_children</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">filtered</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;postings&quot;</span><span class="p">,</span> <span class="p">[]):</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>                <span class="k">if</span> <span class="n">is_child_account</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">):</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>                    <span class="n">new_date</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>                    <span class="k">if</span> <span class="n">last_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">new_date</span> <span class="o">&gt;</span> <span class="n">last_date</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>                        <span class="k">yield</span> <span class="p">(</span><span class="n">last_date</span><span class="p">,</span> <span class="n">running_balance</span><span class="p">)</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>                    <span class="n">running_balance</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                    <span class="n">last_date</span> <span class="o">=</span> <span class="n">new_date</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="k">if</span> <span class="n">last_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="k">yield</span> <span class="p">(</span><span class="n">last_date</span><span class="p">,</span> <span class="n">running_balance</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="c1"># When the balance for a commodity just went to zero, it will be</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="c1"># missing from the &#39;balance&#39; so keep track of currencies that last had</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="c1"># a balance.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="n">last_currencies</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="n">prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">prices</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">running_bal</span> <span class="ow">in</span> <span class="n">_balances</span><span class="p">():</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">balance</span> <span class="o">=</span> <span class="n">conv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">running_bal</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="n">currencies</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">balance</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="k">if</span> <span class="n">last_currencies</span><span class="p">:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>            <span class="k">for</span> <span class="n">currency</span> <span class="ow">in</span> <span class="n">last_currencies</span> <span class="o">-</span> <span class="n">currencies</span><span class="p">:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>                <span class="n">balance</span><span class="p">[</span><span class="n">currency</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZERO</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="n">last_currencies</span> <span class="o">=</span> <span class="n">currencies</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="k">yield</span> <span class="n">DateAndBalance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">balance</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.charts.ChartModule.net_worth" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">net_worth</span><span class="p">(</span><span class="n">filtered</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">conversion</span><span class="p">)</span></code>

<a href="#rustfava.core.charts.ChartModule.net_worth" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Compute net worth.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filtered</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FilteredLedger (rustfava.core.FilteredLedger)" href="#rustfava.core.FilteredLedger">FilteredLedger</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filtered ledger.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="rustfava.util.date.Interval">Interval</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the interval.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conversion</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <a class="autorefs autorefs-internal" title="Conversion (rustfava.core.conversion.Conversion)" href="#rustfava.core.conversion.Conversion">Conversion</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The conversion to use.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="DateAndBalance


  
      dataclass
   (rustfava.core.charts.DateAndBalance)" href="#rustfava.core.charts.DateAndBalance">DateAndBalance</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dicts for all ends of the given interval containing the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="DateAndBalance


  
      dataclass
   (rustfava.core.charts.DateAndBalance)" href="#rustfava.core.charts.DateAndBalance">DateAndBalance</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>net worth (Assets + Liabilities) separately converted to all</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="DateAndBalance


  
      dataclass
   (rustfava.core.charts.DateAndBalance)" href="#rustfava.core.charts.DateAndBalance">DateAndBalance</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>operating currencies.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/charts.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="nd">@listify</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="k">def</span><span class="w"> </span><span class="nf">net_worth</span><span class="p">(</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="n">filtered</span><span class="p">:</span> <span class="n">FilteredLedger</span><span class="p">,</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="n">interval</span><span class="p">:</span> <span class="n">Interval</span><span class="p">,</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="n">conversion</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Conversion</span><span class="p">,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">DateAndBalance</span><span class="p">]:</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute net worth.</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        filtered: The filtered ledger.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        interval: A string for the interval.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        conversion: The conversion to use.</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        Dicts for all ends of the given interval containing the</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        net worth (Assets + Liabilities) separately converted to all</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        operating currencies.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="n">conv</span> <span class="o">=</span> <span class="n">conversion_from_str</span><span class="p">(</span><span class="n">conversion</span><span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="n">transactions</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="n">entry</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">filtered</span><span class="o">.</span><span class="n">entries</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>            <span class="ow">and</span> <span class="n">entry</span><span class="o">.</span><span class="n">flag</span> <span class="o">!=</span> <span class="n">FLAG_UNREALIZED</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="p">)</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="n">types</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_assets&quot;</span><span class="p">],</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_liabilities&quot;</span><span class="p">],</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="p">)</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="n">txn</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">transactions</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="n">inventory</span> <span class="o">=</span> <span class="n">CounterInventory</span><span class="p">()</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="n">prices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">prices</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="k">for</span> <span class="n">date_range</span> <span class="ow">in</span> <span class="n">filtered</span><span class="o">.</span><span class="n">interval_ranges</span><span class="p">(</span><span class="n">interval</span><span class="p">):</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="k">while</span> <span class="n">txn</span> <span class="ow">and</span> <span class="n">txn</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;</span> <span class="n">date_range</span><span class="o">.</span><span class="n">end</span><span class="p">:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>            <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">txn</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>                <span class="k">if</span> <span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">types</span><span class="p">):</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>                    <span class="n">inventory</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="n">txn</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">transactions</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="k">yield</span> <span class="n">DateAndBalance</span><span class="p">(</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>            <span class="n">date_range</span><span class="o">.</span><span class="n">end_inclusive</span><span class="p">,</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>            <span class="n">conv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>                <span class="n">inventory</span><span class="p">,</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>                <span class="n">prices</span><span class="p">,</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>                <span class="n">date_range</span><span class="o">.</span><span class="n">end_inclusive</span><span class="p">,</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>            <span class="p">),</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="rustfava.core.charts.dumps" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="o">**</span><span class="n">_kwargs</span><span class="p">)</span></code>

<a href="#rustfava.core.charts.dumps" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Dump as a JSON string.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/charts.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="k">def</span><span class="w"> </span><span class="nf">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">_kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dump as a JSON string.&quot;&quot;&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">obj</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="n">_json_default</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.charts.loads" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></code>

<a href="#rustfava.core.charts.loads" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Load a JSON string.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/charts.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="k">def</span><span class="w"> </span><span class="nf">loads</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a JSON string.&quot;&quot;&quot;</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.commodities" class="doc doc-heading">
            <code>commodities</code>


<a href="#rustfava.core.commodities" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Attributes for auto-completion.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.commodities.CommoditiesModule" class="doc doc-heading">
            <code>CommoditiesModule</code>


<a href="#rustfava.core.commodities.CommoditiesModule" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FavaModule (rustfava.core.module_base.FavaModule)" href="#rustfava.core.module_base.FavaModule">FavaModule</a></code></p>



        <p>Details about the currencies and commodities.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/commodities.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">class</span><span class="w"> </span><span class="nc">CommoditiesModule</span><span class="p">(</span><span class="n">FavaModule</span><span class="p">):</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Details about the currencies and commodities.&quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger</span><span class="p">:</span> <span class="n">RustfavaLedger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ledger</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">precisions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">precisions</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="k">for</span> <span class="n">commodity</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Commodity</span><span class="p">:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">commodity</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>            <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">commodity</span><span class="o">.</span><span class="n">currency</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>            <span class="n">precision</span> <span class="o">=</span> <span class="n">commodity</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;precision&quot;</span><span class="p">)</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">precision</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">)):</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>                <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">precisions</span><span class="p">[</span><span class="n">commodity</span><span class="o">.</span><span class="n">currency</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">commodity</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of a commodity (or the commodity itself if not set).&quot;&quot;&quot;</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">commodity</span><span class="p">,</span> <span class="n">commodity</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.commodities.CommoditiesModule.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span><span class="p">(</span><span class="n">commodity</span><span class="p">)</span></code>

<a href="#rustfava.core.commodities.CommoditiesModule.name" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Get the name of a commodity (or the commodity itself if not set).</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/commodities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">commodity</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the name of a commodity (or the commodity itself if not set).&quot;&quot;&quot;</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">commodity</span><span class="p">,</span> <span class="n">commodity</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.conversion" class="doc doc-heading">
            <code>conversion</code>


<a href="#rustfava.core.conversion" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Commodity conversion helpers for Fava.</p>
<p>All functions in this module will be automatically added as template filters.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.conversion.Conversion" class="doc doc-heading">
            <code>Conversion</code>


<a href="#rustfava.core.conversion.Conversion" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>



        <p>A conversion.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/conversion.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="k">class</span><span class="w"> </span><span class="nc">Conversion</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A conversion.&quot;&quot;&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">inventory</span><span class="p">:</span> <span class="n">CounterInventory</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">prices</span><span class="p">:</span> <span class="n">RustfavaPriceMap</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SimpleCounterInventory</span><span class="p">:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply the conversion to an inventory (CounterInventory).&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.conversion.Conversion.apply" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply</span><span class="p">(</span><span class="n">inventory</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#rustfava.core.conversion.Conversion.apply" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Apply the conversion to an inventory (CounterInventory).</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/conversion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="n">inventory</span><span class="p">:</span> <span class="n">CounterInventory</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="n">prices</span><span class="p">:</span> <span class="n">RustfavaPriceMap</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SimpleCounterInventory</span><span class="p">:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply the conversion to an inventory (CounterInventory).&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="rustfava.core.conversion.get_cost" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_cost</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></code>

<a href="#rustfava.core.conversion.get_cost" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Return the total cost of a Position.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/conversion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_cost</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span> <span class="n">Position</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Amount</span><span class="p">:</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the total cost of a Position.&quot;&quot;&quot;</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">cost_</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">cost</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="n">_Amount</span><span class="p">(</span><span class="n">cost_</span><span class="o">.</span><span class="n">number</span> <span class="o">*</span> <span class="n">pos</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">cost_</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        <span class="k">if</span> <span class="n">cost_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="k">else</span> <span class="n">pos</span><span class="o">.</span><span class="n">units</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.conversion.get_market_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_market_value</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#rustfava.core.conversion.get_market_value" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the market value of a Position.</p>
<p>This differs from the convert.get_value function in Beancount by returning
the cost value if no price can be found.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pos</code>
            </td>
            <td>
                  <code><span title="rustfava.beans.protocols.Position">Position</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Position.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prices</code>
            </td>
            <td>
                  <code><span title="rustfava.beans.prices.RustfavaPriceMap">RustfavaPriceMap</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A rustfavaPriceMap</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date</code>
            </td>
            <td>
                  <code><span title="datetime.date">date</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A datetime.date instance to evaluate the value at, or None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="rustfava.beans.protocols.Amount">Amount</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An Amount, with value converted or if the conversion failed just the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="rustfava.beans.protocols.Amount">Amount</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>cost value (or the units if the position has no cost).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/conversion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_market_value</span><span class="p">(</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">pos</span><span class="p">:</span> <span class="n">Position</span><span class="p">,</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">prices</span><span class="p">:</span> <span class="n">RustfavaPriceMap</span><span class="p">,</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Amount</span><span class="p">:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the market value of a Position.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    This differs from the convert.get_value function in Beancount by returning</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    the cost value if no price can be found.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        pos: A Position.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        prices: A rustfavaPriceMap</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        date: A datetime.date instance to evaluate the value at, or None.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        An Amount, with value converted or if the conversion failed just the</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        cost value (or the units if the position has no cost).</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">units_</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">units</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">cost_</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">cost</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="k">if</span> <span class="n">cost_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="n">value_currency</span> <span class="o">=</span> <span class="n">cost_</span><span class="o">.</span><span class="n">currency</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">base_quote</span> <span class="o">=</span> <span class="p">(</span><span class="n">units_</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">value_currency</span><span class="p">)</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">price_number</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">get_price</span><span class="p">(</span><span class="n">base_quote</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="k">if</span> <span class="n">price_number</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>            <span class="k">return</span> <span class="n">_Amount</span><span class="p">(</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>                <span class="n">units_</span><span class="o">.</span><span class="n">number</span> <span class="o">*</span> <span class="n">price_number</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>                <span class="n">value_currency</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>            <span class="p">)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="k">return</span> <span class="n">_Amount</span><span class="p">(</span><span class="n">units_</span><span class="o">.</span><span class="n">number</span> <span class="o">*</span> <span class="n">cost_</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">value_currency</span><span class="p">)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="k">return</span> <span class="n">units_</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.conversion.convert_position" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_position</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">target_currency</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#rustfava.core.conversion.convert_position" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the value of a Position in a particular currency.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pos</code>
            </td>
            <td>
                  <code><span title="rustfava.beans.protocols.Position">Position</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Position.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_currency</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target currency to convert to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prices</code>
            </td>
            <td>
                  <code><span title="rustfava.beans.prices.RustfavaPriceMap">RustfavaPriceMap</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A rustfavaPriceMap</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date</code>
            </td>
            <td>
                  <code><span title="datetime.date">date</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A datetime.date instance to evaluate the value at, or None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="rustfava.beans.protocols.Amount">Amount</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An Amount, with value converted or if the conversion failed just the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="rustfava.beans.protocols.Amount">Amount</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>cost value (or the units if the position has no cost).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/conversion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="k">def</span><span class="w"> </span><span class="nf">convert_position</span><span class="p">(</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">pos</span><span class="p">:</span> <span class="n">Position</span><span class="p">,</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">target_currency</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">prices</span><span class="p">:</span> <span class="n">RustfavaPriceMap</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Amount</span><span class="p">:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the value of a Position in a particular currency.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        pos: A Position.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        target_currency: The target currency to convert to.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        prices: A rustfavaPriceMap</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        date: A datetime.date instance to evaluate the value at, or None.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        An Amount, with value converted or if the conversion failed just the</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        cost value (or the units if the position has no cost).</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">units_</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">units</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="c1"># try the direct conversion</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">base_quote</span> <span class="o">=</span> <span class="p">(</span><span class="n">units_</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">target_currency</span><span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="n">price_number</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">get_price</span><span class="p">(</span><span class="n">base_quote</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="k">if</span> <span class="n">price_number</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="k">return</span> <span class="n">_Amount</span><span class="p">(</span><span class="n">units_</span><span class="o">.</span><span class="n">number</span> <span class="o">*</span> <span class="n">price_number</span><span class="p">,</span> <span class="n">target_currency</span><span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="n">cost_</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">cost</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="k">if</span> <span class="n">cost_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">cost_currency</span> <span class="o">=</span> <span class="n">cost_</span><span class="o">.</span><span class="n">currency</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="k">if</span> <span class="n">cost_currency</span> <span class="o">!=</span> <span class="n">target_currency</span><span class="p">:</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="n">base_quote1</span> <span class="o">=</span> <span class="p">(</span><span class="n">units_</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">cost_currency</span><span class="p">)</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="n">rate1</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">get_price</span><span class="p">(</span><span class="n">base_quote1</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="k">if</span> <span class="n">rate1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                <span class="n">base_quote2</span> <span class="o">=</span> <span class="p">(</span><span class="n">cost_currency</span><span class="p">,</span> <span class="n">target_currency</span><span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>                <span class="n">rate2</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">get_price</span><span class="p">(</span><span class="n">base_quote2</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>                <span class="k">if</span> <span class="n">rate2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>                    <span class="k">return</span> <span class="n">_Amount</span><span class="p">(</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                        <span class="n">units_</span><span class="o">.</span><span class="n">number</span> <span class="o">*</span> <span class="n">rate1</span> <span class="o">*</span> <span class="n">rate2</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>                        <span class="n">target_currency</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>                    <span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="k">return</span> <span class="n">units_</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.conversion.conversion_from_str" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">conversion_from_str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

<a href="#rustfava.core.conversion.conversion_from_str" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Parse a conversion string.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/conversion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="k">def</span><span class="w"> </span><span class="nf">conversion_from_str</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Conversion</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Conversion</span><span class="p">:</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse a conversion string.&quot;&quot;&quot;</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="k">return</span> <span class="n">value</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;at_cost&quot;</span><span class="p">:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="k">return</span> <span class="n">AT_COST</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;at_value&quot;</span><span class="p">:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="k">return</span> <span class="n">AT_VALUE</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="k">return</span> <span class="n">UNITS</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="k">return</span> <span class="n">_CurrencyConversion</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.conversion.cost_or_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cost_or_value</span><span class="p">(</span><span class="n">inventory</span><span class="p">,</span> <span class="n">conversion</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#rustfava.core.conversion.cost_or_value" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the cost or value of an inventory.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/conversion.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="k">def</span><span class="w"> </span><span class="nf">cost_or_value</span><span class="p">(</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">inventory</span><span class="p">:</span> <span class="n">CounterInventory</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">conversion</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Conversion</span><span class="p">,</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">prices</span><span class="p">:</span> <span class="n">RustfavaPriceMap</span><span class="p">,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SimpleCounterInventory</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the cost or value of an inventory.&quot;&quot;&quot;</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="n">conversion</span> <span class="o">=</span> <span class="n">conversion_from_str</span><span class="p">(</span><span class="n">conversion</span><span class="p">)</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="k">return</span> <span class="n">conversion</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">inventory</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.documents" class="doc doc-heading">
            <code>documents</code>


<a href="#rustfava.core.documents" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Document path related helpers.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.documents.NotADocumentsFolderError" class="doc doc-heading">
            <code>NotADocumentsFolderError</code>


<a href="#rustfava.core.documents.NotADocumentsFolderError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code></p>



        <p>Not a documents folder.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/documents.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="k">class</span><span class="w"> </span><span class="nc">NotADocumentsFolderError</span><span class="p">(</span><span class="n">RustfavaAPIError</span><span class="p">):</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Not a documents folder.&quot;&quot;&quot;</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Not a documents folder: </span><span class="si">{</span><span class="n">folder</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.documents.NotAValidAccountError" class="doc doc-heading">
            <code>NotAValidAccountError</code>


<a href="#rustfava.core.documents.NotAValidAccountError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code></p>



        <p>Not a valid account.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/documents.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="k">class</span><span class="w"> </span><span class="nc">NotAValidAccountError</span><span class="p">(</span><span class="n">RustfavaAPIError</span><span class="p">):</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Not a valid account.&quot;&quot;&quot;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Not a valid account: &#39;</span><span class="si">{</span><span class="n">account</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="rustfava.core.documents.is_document_or_import_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_document_or_import_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ledger</span><span class="p">)</span></code>

<a href="#rustfava.core.documents.is_document_or_import_file" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Check whether the filename is a document or in an import directory.</p>
<p>This is a security validation function that prevents path traversal.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filename to check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ledger</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RustfavaLedger (rustfava.core.RustfavaLedger)" href="#rustfava.core.RustfavaLedger">RustfavaLedger</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The RustfavaLedger.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether this is one of the documents or a path in an import dir.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/documents.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_document_or_import_file</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ledger</span><span class="p">:</span> <span class="n">RustfavaLedger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether the filename is a document or in an import directory.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    This is a security validation function that prevents path traversal.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        filename: The filename to check.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        ledger: The RustfavaLedger.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        Whether this is one of the documents or a path in an import dir.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="c1"># Check if it&#39;s an exact match for a known document</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="n">filename</span> <span class="o">==</span> <span class="n">d</span><span class="o">.</span><span class="n">filename</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Document</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="p">):</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="c1"># Check if resolved path is within an import directory (prevents path traversal)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="k">for</span> <span class="n">import_dir</span> <span class="ow">in</span> <span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">import_dirs</span><span class="p">:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="n">resolved_dir</span> <span class="o">=</span> <span class="n">ledger</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="n">import_dir</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">is_relative_to</span><span class="p">(</span><span class="n">resolved_dir</span><span class="p">):</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.documents.filepath_in_document_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filepath_in_document_folder</span><span class="p">(</span><span class="n">documents_folder</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">ledger</span><span class="p">)</span></code>

<a href="#rustfava.core.documents.filepath_in_document_folder" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>File path for a document in the folder for an account.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>documents_folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The documents folder.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>account</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The account to choose the subfolder for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filename of the document.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ledger</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RustfavaLedger (rustfava.core.RustfavaLedger)" href="#rustfava.core.RustfavaLedger">RustfavaLedger</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The RustfavaLedger.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path that the document should be saved at.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/documents.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="k">def</span><span class="w"> </span><span class="nf">filepath_in_document_folder</span><span class="p">(</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">documents_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">account</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">ledger</span><span class="p">:</span> <span class="n">RustfavaLedger</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;File path for a document in the folder for an account.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        documents_folder: The documents folder.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        account: The account to choose the subfolder for.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        filename: The filename of the document.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        ledger: The RustfavaLedger.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        The path that the document should be saved at.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="k">if</span> <span class="n">documents_folder</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ledger</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;documents&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="k">raise</span> <span class="n">NotADocumentsFolderError</span><span class="p">(</span><span class="n">documents_folder</span><span class="p">)</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="k">if</span> <span class="n">account</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ledger</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">accounts</span><span class="p">:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="k">raise</span> <span class="n">NotAValidAccountError</span><span class="p">(</span><span class="n">account</span><span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="k">if</span> <span class="n">altsep</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">altsep</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="k">return</span> <span class="n">ledger</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="n">documents_folder</span><span class="p">,</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="o">*</span><span class="n">account</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">),</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="n">filename</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.extensions" class="doc doc-heading">
            <code>extensions</code>


<a href="#rustfava.core.extensions" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Fava extensions.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.extensions.ExtensionDetails" class="doc doc-heading">
            <code>ExtensionDetails</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.extensions.ExtensionDetails" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>The information about an extension that is needed for the frontend.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/extensions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="nd">@dataclass</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="k">class</span><span class="w"> </span><span class="nc">ExtensionDetails</span><span class="p">:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The information about an extension that is needed for the frontend.&quot;&quot;&quot;</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="n">report_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">has_js_module</span><span class="p">:</span> <span class="nb">bool</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.extensions.ExtensionModule" class="doc doc-heading">
            <code>ExtensionModule</code>


<a href="#rustfava.core.extensions.ExtensionModule" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FavaModule (rustfava.core.module_base.FavaModule)" href="#rustfava.core.module_base.FavaModule">FavaModule</a></code></p>



        <p>Fava extensions.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/extensions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="k">class</span><span class="w"> </span><span class="nc">ExtensionModule</span><span class="p">(</span><span class="n">FavaModule</span><span class="p">):</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Fava extensions.&quot;&quot;&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger</span><span class="p">:</span> <span class="n">RustfavaLedger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ledger</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_instances</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RustfavaExtensionBase</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded_extensions</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">RustfavaExtensionBase</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">RustfavaExtensionError</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="n">custom_entries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Custom</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="p">(</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">custom_entries</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;fava-extension&quot;</span><span class="p">):</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>            <span class="n">extension</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>            <span class="k">if</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>                    <span class="n">RustfavaExtensionError</span><span class="p">(</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>                        <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Duplicate extension &#39;</span><span class="si">{</span><span class="n">extension</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="n">entry</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>                    <span class="p">)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>                <span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>                <span class="k">continue</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>            <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>            <span class="n">extensions</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">find_extensions</span><span class="p">(</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>                <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">beancount_file_path</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>                <span class="n">extension</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>            <span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>            <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">extensions</span><span class="p">:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>                <span class="n">ext_config</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>                    <span class="n">entry</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>                <span class="p">)</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>                <span class="k">if</span> <span class="bp">cls</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loaded_extensions</span><span class="p">:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_loaded_extensions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>                    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>                        <span class="n">ext</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="p">,</span> <span class="n">ext_config</span><span class="p">)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_instances</span><span class="p">[</span><span class="n">ext</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ext</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>                    <span class="k">except</span> <span class="n">ExtensionConfigError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>                            <span class="n">RustfavaExtensionError</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">),</span> <span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>                        <span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_exts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">RustfavaExtensionBase</span><span class="p">]:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instances</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extension_details</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ExtensionDetails</span><span class="p">]:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Extension information to provide to the Frontend.&quot;&quot;&quot;</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="n">ExtensionDetails</span><span class="p">(</span><span class="n">ext</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ext</span><span class="o">.</span><span class="n">report_title</span><span class="p">,</span> <span class="n">ext</span><span class="o">.</span><span class="n">has_js_module</span><span class="p">)</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>            <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exts</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="p">]</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_extension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RustfavaExtensionBase</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the extension with the given name.&quot;&quot;&quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instances</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">after_load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run all `after_load_file` hooks.&quot;&quot;&quot;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exts</span><span class="p">:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>            <span class="n">ext</span><span class="o">.</span><span class="n">after_load_file</span><span class="p">()</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">before_request</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run all `before_request` hooks.&quot;&quot;&quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exts</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="n">ext</span><span class="o">.</span><span class="n">before_request</span><span class="p">()</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">after_entry_modified</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">,</span> <span class="n">new_lines</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run all `after_entry_modified` hooks.&quot;&quot;&quot;</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exts</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="n">ext</span><span class="o">.</span><span class="n">after_entry_modified</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">new_lines</span><span class="p">)</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">after_insert_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run all `after_insert_entry` hooks.&quot;&quot;&quot;</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exts</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="n">ext</span><span class="o">.</span><span class="n">after_insert_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">after_delete_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run all `after_delete_entry` hooks.&quot;&quot;&quot;</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exts</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="n">ext</span><span class="o">.</span><span class="n">after_delete_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">after_insert_metadata</span><span class="p">(</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run all `after_insert_metadata` hooks.&quot;&quot;&quot;</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exts</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="n">ext</span><span class="o">.</span><span class="n">after_insert_metadata</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">after_write_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run all `after_write_source` hooks.&quot;&quot;&quot;</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exts</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="n">ext</span><span class="o">.</span><span class="n">after_write_source</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="rustfava.core.extensions.ExtensionModule.extension_details" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extension_details</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#rustfava.core.extensions.ExtensionModule.extension_details" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Extension information to provide to the Frontend.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h5 id="rustfava.core.extensions.ExtensionModule.get_extension" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_extension</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#rustfava.core.extensions.ExtensionModule.get_extension" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Get the extension with the given name.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/extensions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_extension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RustfavaExtensionBase</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the extension with the given name.&quot;&quot;&quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instances</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.extensions.ExtensionModule.after_load_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">after_load_file</span><span class="p">()</span></code>

<a href="#rustfava.core.extensions.ExtensionModule.after_load_file" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Run all <code>after_load_file</code> hooks.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/extensions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span>
<span class="normal"><a href="#__codelineno-0-96">96</a></span>
<span class="normal"><a href="#__codelineno-0-97">97</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="k">def</span><span class="w"> </span><span class="nf">after_load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run all `after_load_file` hooks.&quot;&quot;&quot;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exts</span><span class="p">:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="n">ext</span><span class="o">.</span><span class="n">after_load_file</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.extensions.ExtensionModule.before_request" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">before_request</span><span class="p">()</span></code>

<a href="#rustfava.core.extensions.ExtensionModule.before_request" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Run all <code>before_request</code> hooks.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/extensions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="k">def</span><span class="w"> </span><span class="nf">before_request</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run all `before_request` hooks.&quot;&quot;&quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exts</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">ext</span><span class="o">.</span><span class="n">before_request</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.extensions.ExtensionModule.after_entry_modified" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">after_entry_modified</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">new_lines</span><span class="p">)</span></code>

<a href="#rustfava.core.extensions.ExtensionModule.after_entry_modified" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Run all <code>after_entry_modified</code> hooks.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/extensions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="k">def</span><span class="w"> </span><span class="nf">after_entry_modified</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">,</span> <span class="n">new_lines</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run all `after_entry_modified` hooks.&quot;&quot;&quot;</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exts</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="n">ext</span><span class="o">.</span><span class="n">after_entry_modified</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">new_lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.extensions.ExtensionModule.after_insert_entry" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">after_insert_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span></code>

<a href="#rustfava.core.extensions.ExtensionModule.after_insert_entry" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Run all <code>after_insert_entry</code> hooks.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/extensions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="k">def</span><span class="w"> </span><span class="nf">after_insert_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run all `after_insert_entry` hooks.&quot;&quot;&quot;</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exts</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="n">ext</span><span class="o">.</span><span class="n">after_insert_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.extensions.ExtensionModule.after_delete_entry" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">after_delete_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span></code>

<a href="#rustfava.core.extensions.ExtensionModule.after_delete_entry" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Run all <code>after_delete_entry</code> hooks.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/extensions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="k">def</span><span class="w"> </span><span class="nf">after_delete_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run all `after_delete_entry` hooks.&quot;&quot;&quot;</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exts</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">ext</span><span class="o">.</span><span class="n">after_delete_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.extensions.ExtensionModule.after_insert_metadata" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">after_insert_metadata</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

<a href="#rustfava.core.extensions.ExtensionModule.after_insert_metadata" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Run all <code>after_insert_metadata</code> hooks.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/extensions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="k">def</span><span class="w"> </span><span class="nf">after_insert_metadata</span><span class="p">(</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run all `after_insert_metadata` hooks.&quot;&quot;&quot;</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exts</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">ext</span><span class="o">.</span><span class="n">after_insert_metadata</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.extensions.ExtensionModule.after_write_source" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">after_write_source</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span></code>

<a href="#rustfava.core.extensions.ExtensionModule.after_write_source" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Run all <code>after_write_source</code> hooks.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/extensions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="k">def</span><span class="w"> </span><span class="nf">after_write_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run all `after_write_source` hooks.&quot;&quot;&quot;</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exts</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">ext</span><span class="o">.</span><span class="n">after_write_source</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.fava_options" class="doc doc-heading">
            <code>fava_options</code>


<a href="#rustfava.core.fava_options" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>rustfava's options.</p>
<p>Options for rustfava can be specified through Custom entries in the Beancount file.
This module contains a list of possible options, the defaults and the code for
parsing the options.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.fava_options.OptionError" class="doc doc-heading">
            <code>OptionError</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.fava_options.OptionError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.BeancountError">BeancountError</span></code></p>



        <p>An error for one of the rustfava options.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/fava_options.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="k">class</span><span class="w"> </span><span class="nc">OptionError</span><span class="p">(</span><span class="n">BeancountError</span><span class="p">):</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;An error for one of the rustfava options.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.fava_options.InsertEntryOption" class="doc doc-heading">
            <code>InsertEntryOption</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.fava_options.InsertEntryOption" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>Insert option.</p>
<p>An option that determines where entries for matching accounts should be
inserted.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/fava_options.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="k">class</span><span class="w"> </span><span class="nc">InsertEntryOption</span><span class="p">:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert option.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    An option that determines where entries for matching accounts should be</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    inserted.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">re</span><span class="p">:</span> <span class="n">Pattern</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">lineno</span><span class="p">:</span> <span class="nb">int</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.fava_options.RustfavaOptions" class="doc doc-heading">
            <code>RustfavaOptions</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.fava_options.RustfavaOptions" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>Options for rustfava that can be set in the Beancount file.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/fava_options.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="nd">@dataclass</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="k">class</span><span class="w"> </span><span class="nc">RustfavaOptions</span><span class="p">:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Options for rustfava that can be set in the Beancount file.&quot;&quot;&quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="n">account_journal_include_children</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">auto_reload</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">collapse_pattern</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Pattern</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">conversion_currencies</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">currency_column</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">61</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="n">default_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="n">default_page</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;income_statement/&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="n">fiscal_year_end</span><span class="p">:</span> <span class="n">FiscalYearEnd</span> <span class="o">=</span> <span class="n">END_OF_YEAR</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">import_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="n">import_dirs</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="n">indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="n">insert_entry</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">InsertEntryOption</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">invert_gains_losses_colors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="n">invert_income_liabilities_equity</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="n">show_accounts_with_zero_balance</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="n">show_accounts_with_zero_transactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="n">show_closed_accounts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="n">sidebar_show_queries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="n">unrealized</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Unrealized&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">upcoming_events</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">7</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="n">uptodate_indicator_grey_lookback_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="n">use_external_editor</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_collapse_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the collapse_pattern option.&quot;&quot;&quot;</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="k">except</span> <span class="n">re</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="k">raise</span> <span class="n">NotARegularExpressionError</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="c1"># It&#39;s typed as Sequence so that it&#39;s not externally mutated</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">collapse_pattern</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>  <span class="c1"># type: ignore[attr-defined]</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_default_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the default_file option.&quot;&quot;&quot;</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">default_file</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="nb">str</span><span class="p">((</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="k">if</span> <span class="n">value</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="k">else</span> <span class="n">filename</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_fiscal_year_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the fiscal_year_end option.&quot;&quot;&quot;</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">fye</span> <span class="o">=</span> <span class="n">parse_fye_string</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="k">if</span> <span class="n">fye</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="k">raise</span> <span class="n">InvalidFiscalYearEndOptionError</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fiscal_year_end</span> <span class="o">=</span> <span class="n">fye</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_import_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add an import directory.&quot;&quot;&quot;</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="c1"># It&#39;s typed as Sequence so that it&#39;s not externally mutated</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">import_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># type: ignore[attr-defined]</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_insert_entry</span><span class="p">(</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lineno</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the insert_entry option.&quot;&quot;&quot;</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="k">except</span> <span class="n">re</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="k">raise</span> <span class="n">NotARegularExpressionError</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="n">opt</span> <span class="o">=</span> <span class="n">InsertEntryOption</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span><span class="p">)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="c1"># It&#39;s typed as Sequence so that it&#39;s not externally mutated</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">insert_entry</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span>  <span class="c1"># type: ignore[attr-defined]</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_language</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the locale option.&quot;&quot;&quot;</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="n">locale</span> <span class="o">=</span> <span class="n">Locale</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>                <span class="ow">not</span> <span class="n">locale</span><span class="o">.</span><span class="n">language</span> <span class="o">==</span> <span class="s2">&quot;en&quot;</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>                <span class="ow">and</span> <span class="n">get_translations</span><span class="p">(</span><span class="n">locale</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="p">):</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                <span class="k">raise</span> <span class="n">UnsupportedLanguageOptionError</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">language</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="k">except</span> <span class="n">UnknownLocaleError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="k">raise</span> <span class="n">UnknownLocaleOptionError</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_locale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the locale option.&quot;&quot;&quot;</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>            <span class="n">Locale</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="k">except</span> <span class="n">UnknownLocaleError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>            <span class="k">raise</span> <span class="n">UnknownLocaleOptionError</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.fava_options.RustfavaOptions.set_collapse_pattern" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_collapse_pattern</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

<a href="#rustfava.core.fava_options.RustfavaOptions.set_collapse_pattern" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Set the collapse_pattern option.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/fava_options.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_collapse_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the collapse_pattern option.&quot;&quot;&quot;</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="k">except</span> <span class="n">re</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="k">raise</span> <span class="n">NotARegularExpressionError</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="c1"># It&#39;s typed as Sequence so that it&#39;s not externally mutated</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">collapse_pattern</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>  <span class="c1"># type: ignore[attr-defined]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.fava_options.RustfavaOptions.set_default_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_default_file</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span></code>

<a href="#rustfava.core.fava_options.RustfavaOptions.set_default_file" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Set the default_file option.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/fava_options.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_default_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the default_file option.&quot;&quot;&quot;</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">default_file</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="nb">str</span><span class="p">((</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="k">if</span> <span class="n">value</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">else</span> <span class="n">filename</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.fava_options.RustfavaOptions.set_fiscal_year_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_fiscal_year_end</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

<a href="#rustfava.core.fava_options.RustfavaOptions.set_fiscal_year_end" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Set the fiscal_year_end option.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/fava_options.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_fiscal_year_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the fiscal_year_end option.&quot;&quot;&quot;</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="n">fye</span> <span class="o">=</span> <span class="n">parse_fye_string</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="k">if</span> <span class="n">fye</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="k">raise</span> <span class="n">InvalidFiscalYearEndOptionError</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fiscal_year_end</span> <span class="o">=</span> <span class="n">fye</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.fava_options.RustfavaOptions.set_import_dirs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_import_dirs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

<a href="#rustfava.core.fava_options.RustfavaOptions.set_import_dirs" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Add an import directory.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/fava_options.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_import_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add an import directory.&quot;&quot;&quot;</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="c1"># It&#39;s typed as Sequence so that it&#39;s not externally mutated</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">import_dirs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># type: ignore[attr-defined]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.fava_options.RustfavaOptions.set_insert_entry" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_insert_entry</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span><span class="p">)</span></code>

<a href="#rustfava.core.fava_options.RustfavaOptions.set_insert_entry" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Set the insert_entry option.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/fava_options.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_insert_entry</span><span class="p">(</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lineno</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the insert_entry option.&quot;&quot;&quot;</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="k">except</span> <span class="n">re</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="k">raise</span> <span class="n">NotARegularExpressionError</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="n">opt</span> <span class="o">=</span> <span class="n">InsertEntryOption</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span><span class="p">)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="c1"># It&#39;s typed as Sequence so that it&#39;s not externally mutated</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">insert_entry</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span>  <span class="c1"># type: ignore[attr-defined]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.fava_options.RustfavaOptions.set_language" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_language</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

<a href="#rustfava.core.fava_options.RustfavaOptions.set_language" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Set the locale option.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/fava_options.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_language</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the locale option.&quot;&quot;&quot;</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">locale</span> <span class="o">=</span> <span class="n">Locale</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="ow">not</span> <span class="n">locale</span><span class="o">.</span><span class="n">language</span> <span class="o">==</span> <span class="s2">&quot;en&quot;</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="ow">and</span> <span class="n">get_translations</span><span class="p">(</span><span class="n">locale</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="p">):</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>            <span class="k">raise</span> <span class="n">UnsupportedLanguageOptionError</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">language</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="k">except</span> <span class="n">UnknownLocaleError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="k">raise</span> <span class="n">UnknownLocaleOptionError</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.fava_options.RustfavaOptions.set_locale" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_locale</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

<a href="#rustfava.core.fava_options.RustfavaOptions.set_locale" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Set the locale option.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/fava_options.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_locale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the locale option.&quot;&quot;&quot;</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">Locale</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="k">except</span> <span class="n">UnknownLocaleError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="k">raise</span> <span class="n">UnknownLocaleOptionError</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="rustfava.core.fava_options.parse_option_custom_entry" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_option_custom_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></code>

<a href="#rustfava.core.fava_options.parse_option_custom_entry" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Parse a single custom fava-option entry and set option accordingly.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/fava_options.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="k">def</span><span class="w"> </span><span class="nf">parse_option_custom_entry</span><span class="p">(</span>  <span class="c1"># noqa: PLR0912</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="n">entry</span><span class="p">:</span> <span class="n">Custom</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="n">options</span><span class="p">:</span> <span class="n">RustfavaOptions</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse a single custom fava-option entry and set option accordingly.&quot;&quot;&quot;</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="n">key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">All_OPTS</span><span class="p">:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="k">raise</span> <span class="n">UnknownOptionError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="n">value</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="k">raise</span> <span class="n">NotAStringOptionError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="n">get_position</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;collapse_pattern&quot;</span><span class="p">:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="n">options</span><span class="o">.</span><span class="n">set_collapse_pattern</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;default_file&quot;</span><span class="p">:</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="n">options</span><span class="o">.</span><span class="n">set_default_file</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;fiscal_year_end&quot;</span><span class="p">:</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="n">options</span><span class="o">.</span><span class="n">set_fiscal_year_end</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;import_dirs&quot;</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="n">options</span><span class="o">.</span><span class="n">set_import_dirs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;insert_entry&quot;</span><span class="p">:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="n">options</span><span class="o">.</span><span class="n">set_insert_entry</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span><span class="p">)</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;language&quot;</span><span class="p">:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="n">options</span><span class="o">.</span><span class="n">set_language</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;locale&quot;</span><span class="p">:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="n">options</span><span class="o">.</span><span class="n">set_locale</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">STR_OPTS</span><span class="p">:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="nb">setattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">BOOL_OPTS</span><span class="p">:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="nb">setattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span><span class="p">)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">INT_OPTS</span><span class="p">:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="nb">setattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># key in TUPLE_OPTS</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="nb">setattr</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.fava_options.parse_options" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_options</span><span class="p">(</span><span class="n">custom_entries</span><span class="p">)</span></code>

<a href="#rustfava.core.fava_options.parse_options" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Parse custom entries for rustfava options.</p>
<p>The format for option entries is the following::</p>
<div class="highlight"><pre><span></span><code>2016-04-01 custom &quot;fava-option&quot; &quot;[name]&quot; &quot;[value]&quot;
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>custom_entries</code>
            </td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="rustfava.beans.abc.Custom">Custom</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of Custom entries.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RustfavaOptions


  
      dataclass
   (rustfava.core.fava_options.RustfavaOptions)" href="#rustfava.core.fava_options.RustfavaOptions">RustfavaOptions</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple (options, errors) where options is a dictionary of all options</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="OptionError


  
      dataclass
   (rustfava.core.fava_options.OptionError)" href="#rustfava.core.fava_options.OptionError">OptionError</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>to values, and errors contains possible parsing errors.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/fava_options.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="k">def</span><span class="w"> </span><span class="nf">parse_options</span><span class="p">(</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="n">custom_entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Custom</span><span class="p">],</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">RustfavaOptions</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">OptionError</span><span class="p">]]:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse custom entries for rustfava options.</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">    The format for option entries is the following::</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        2016-04-01 custom &quot;fava-option&quot; &quot;[name]&quot; &quot;[value]&quot;</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        custom_entries: A list of Custom entries.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        A tuple (options, errors) where options is a dictionary of all options</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        to values, and errors contains possible parsing errors.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="n">options</span> <span class="o">=</span> <span class="n">RustfavaOptions</span><span class="p">()</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="p">(</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">custom_entries</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;fava-option&quot;</span><span class="p">):</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">entry</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>                <span class="k">raise</span> <span class="n">MissingOptionError</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="n">parse_option_custom_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to parse fava-option entry: </span><span class="si">{</span><span class="n">err</span><span class="si">!s}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">OptionError</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">entry</span><span class="p">))</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="k">return</span> <span class="n">options</span><span class="p">,</span> <span class="n">errors</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.file" class="doc doc-heading">
            <code>file</code>


<a href="#rustfava.core.file" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Reading/writing Beancount files.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.file.NonSourceFileError" class="doc doc-heading">
            <code>NonSourceFileError</code>


<a href="#rustfava.core.file.NonSourceFileError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code></p>



        <p>Trying to read a non-source file.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="k">class</span><span class="w"> </span><span class="nc">NonSourceFileError</span><span class="p">(</span><span class="n">RustfavaAPIError</span><span class="p">):</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Trying to read a non-source file.&quot;&quot;&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trying to read a non-source file at &#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.file.ExternallyChangedError" class="doc doc-heading">
            <code>ExternallyChangedError</code>


<a href="#rustfava.core.file.ExternallyChangedError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code></p>



        <p>The file changed externally.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="k">class</span><span class="w"> </span><span class="nc">ExternallyChangedError</span><span class="p">(</span><span class="n">RustfavaAPIError</span><span class="p">):</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The file changed externally.&quot;&quot;&quot;</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The file at &#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39; changed externally.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.file.GeneratedEntryError" class="doc doc-heading">
            <code>GeneratedEntryError</code>


<a href="#rustfava.core.file.GeneratedEntryError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code></p>



        <p>The entry is generated and cannot be edited.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="k">class</span><span class="w"> </span><span class="nc">GeneratedEntryError</span><span class="p">(</span><span class="n">RustfavaAPIError</span><span class="p">):</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The entry is generated and cannot be edited.&quot;&quot;&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;The entry is generated and cannot be edited.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.file.InvalidUnicodeError" class="doc doc-heading">
            <code>InvalidUnicodeError</code>


<a href="#rustfava.core.file.InvalidUnicodeError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code></p>



        <p>The source file contains invalid unicode.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="k">class</span><span class="w"> </span><span class="nc">InvalidUnicodeError</span><span class="p">(</span><span class="n">RustfavaAPIError</span><span class="p">):</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The source file contains invalid unicode.&quot;&quot;&quot;</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reason</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>            <span class="sa">f</span><span class="s2">&quot;The source file contains invalid unicode: </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.file.FileModule" class="doc doc-heading">
            <code>FileModule</code>


<a href="#rustfava.core.file.FileModule" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FavaModule (rustfava.core.module_base.FavaModule)" href="#rustfava.core.module_base.FavaModule">FavaModule</a></code></p>



        <p>Functions related to reading/writing to Beancount files.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="k">class</span><span class="w"> </span><span class="nc">FileModule</span><span class="p">(</span><span class="n">FavaModule</span><span class="p">):</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Functions related to reading/writing to Beancount files.&quot;&quot;&quot;</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger</span><span class="p">:</span> <span class="n">RustfavaLedger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ledger</span><span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get source files.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">            path: The path of the file.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">            A string with the file contents and the `sha256sum` of the file.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            NonSourceFileError: If the file is not one of the source files.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            InvalidUnicodeError: If the file contains invalid unicode.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;include&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="k">raise</span> <span class="n">NonSourceFileError</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="n">source</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">read_text</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="k">except</span> <span class="ne">UnicodeDecodeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="k">raise</span> <span class="n">InvalidUnicodeError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">))</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="k">return</span> <span class="n">source</span><span class="p">,</span> <span class="n">_sha256_str</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sha256sum</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Write to source file.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">            path: The path of the file.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            source: A string with the file contents.</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">            sha256sum: Hash of the file.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            The `sha256sum` of the updated file.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            NonSourceFileError: If the file is not one of the source files.</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">            InvalidUnicodeError: If the file contains invalid unicode.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            ExternallyChangedError: If the file was changed externally.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="n">_</span><span class="p">,</span> <span class="n">original_sha256sum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_source</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="k">if</span> <span class="n">original_sha256sum</span> <span class="o">!=</span> <span class="n">sha256sum</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                <span class="k">raise</span> <span class="n">ExternallyChangedError</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="n">newline</span> <span class="o">=</span> <span class="n">_file_newline_character</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="n">newline</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">watcher</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">after_write_source</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">source</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="k">return</span> <span class="n">_sha256_str</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">insert_metadata</span><span class="p">(</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">entry_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">basekey</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Insert metadata into a file at lineno.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        Also, prevent duplicate keys.</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">            entry_hash: Hash of an entry.</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">            basekey: Key to insert metadata for.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">            value: Metadate value to insert.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">changed</span><span class="p">()</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">get_entry</span><span class="p">(</span><span class="n">entry_hash</span><span class="p">)</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>            <span class="n">key</span> <span class="o">=</span> <span class="n">next_key</span><span class="p">(</span><span class="n">basekey</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="n">indent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">indent</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="n">path</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="n">_get_position</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="n">insert_metadata_in_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">lineno</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">watcher</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">after_insert_metadata</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_entry_slice</span><span class="p">(</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="n">entry_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">source_slice</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="n">sha256sum</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Save slice of the source file for an entry.</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">            entry_hash: Hash of an entry.</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            source_slice: The lines that the entry should be replaced with.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">            sha256sum: The sha256sum of the current lines of the entry.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">            The `sha256sum` of the new lines of the entry.</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">            RustfavaAPIError: If the entry is not found or the file changed.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>            <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">get_entry</span><span class="p">(</span><span class="n">entry_hash</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>            <span class="n">new_sha256sum</span> <span class="o">=</span> <span class="n">save_entry_slice</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">source_slice</span><span class="p">,</span> <span class="n">sha256sum</span><span class="p">)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">watcher</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">get_position</span><span class="p">(</span><span class="n">entry</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">after_entry_modified</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">source_slice</span><span class="p">)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="k">return</span> <span class="n">new_sha256sum</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">delete_entry_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sha256sum</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete slice of the source file for an entry.</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">            entry_hash: Hash of an entry.</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">            sha256sum: The sha256sum of the current lines of the entry.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">            RustfavaAPIError: If the entry is not found or the file changed.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">get_entry</span><span class="p">(</span><span class="n">entry_hash</span><span class="p">)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="n">delete_entry_slice</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">sha256sum</span><span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">watcher</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">get_position</span><span class="p">(</span><span class="n">entry</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">after_delete_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">insert_entries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Insert entries.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">            entries: A list of entries.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">changed</span><span class="p">()</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>            <span class="n">fava_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">_incomplete_sortkey</span><span class="p">):</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>                <span class="n">path</span><span class="p">,</span> <span class="n">updated_insert_options</span> <span class="o">=</span> <span class="n">insert_entry</span><span class="p">(</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>                    <span class="n">entry</span><span class="p">,</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>                    <span class="p">(</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">default_file</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>                        <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">beancount_file_path</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>                    <span class="p">),</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>                    <span class="n">insert_options</span><span class="o">=</span><span class="n">fava_options</span><span class="o">.</span><span class="n">insert_entry</span><span class="p">,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>                    <span class="n">currency_column</span><span class="o">=</span><span class="n">fava_options</span><span class="o">.</span><span class="n">currency_column</span><span class="p">,</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>                    <span class="n">indent</span><span class="o">=</span><span class="n">fava_options</span><span class="o">.</span><span class="n">indent</span><span class="p">,</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>                <span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">watcher</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">insert_entry</span> <span class="o">=</span> <span class="n">updated_insert_options</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">after_insert_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">render_entries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Markup</span><span class="p">]:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return entries in Beancount format.</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        Only renders :class:`.Balance` and :class:`.Transaction`.</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">            entries: A list of entries.</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">        Yields:</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">            The entries rendered in Beancount format.</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="n">indent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">indent</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="p">(</span><span class="n">Balance</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">)):</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>                <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>                    <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">)</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>                    <span class="ow">and</span> <span class="n">entry</span><span class="o">.</span><span class="n">flag</span> <span class="ow">in</span> <span class="n">_EXCL_FLAGS</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>                <span class="p">):</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>                    <span class="k">yield</span> <span class="n">Markup</span><span class="p">(</span><span class="n">get_entry_slice</span><span class="p">(</span><span class="n">entry</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># noqa: S704</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>                <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">FileNotFoundError</span><span class="p">):</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>                    <span class="k">yield</span> <span class="n">Markup</span><span class="p">(</span>  <span class="c1"># noqa: S704</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>                        <span class="n">to_string</span><span class="p">(</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>                            <span class="n">entry</span><span class="p">,</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">currency_column</span><span class="p">,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>                            <span class="n">indent</span><span class="p">,</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>                        <span class="p">),</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>                    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.file.FileModule.get_source" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_source</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

<a href="#rustfava.core.file.FileModule.get_source" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Get source files.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path of the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string with the file contents and the <code>sha256sum</code> of the file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="NonSourceFileError (rustfava.core.file.NonSourceFileError)" href="#rustfava.core.file.NonSourceFileError">NonSourceFileError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file is not one of the source files.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="InvalidUnicodeError (rustfava.core.file.InvalidUnicodeError)" href="#rustfava.core.file.InvalidUnicodeError">InvalidUnicodeError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file contains invalid unicode.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get source files.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        path: The path of the file.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        A string with the file contents and the `sha256sum` of the file.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        NonSourceFileError: If the file is not one of the source files.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        InvalidUnicodeError: If the file contains invalid unicode.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;include&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">raise</span> <span class="n">NonSourceFileError</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">source</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">read_text</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="k">except</span> <span class="ne">UnicodeDecodeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="k">raise</span> <span class="n">InvalidUnicodeError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">))</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">return</span> <span class="n">source</span><span class="p">,</span> <span class="n">_sha256_str</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.file.FileModule.set_source" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_source</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">sha256sum</span><span class="p">)</span></code>

<a href="#rustfava.core.file.FileModule.set_source" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Write to source file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path of the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string with the file contents.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sha256sum</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hash of the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The <code>sha256sum</code> of the updated file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="NonSourceFileError (rustfava.core.file.NonSourceFileError)" href="#rustfava.core.file.NonSourceFileError">NonSourceFileError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file is not one of the source files.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="InvalidUnicodeError (rustfava.core.file.InvalidUnicodeError)" href="#rustfava.core.file.InvalidUnicodeError">InvalidUnicodeError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file contains invalid unicode.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ExternallyChangedError (rustfava.core.file.ExternallyChangedError)" href="#rustfava.core.file.ExternallyChangedError">ExternallyChangedError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file was changed externally.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sha256sum</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Write to source file.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        path: The path of the file.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        source: A string with the file contents.</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        sha256sum: Hash of the file.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        The `sha256sum` of the updated file.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        NonSourceFileError: If the file is not one of the source files.</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        InvalidUnicodeError: If the file contains invalid unicode.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        ExternallyChangedError: If the file was changed externally.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="n">_</span><span class="p">,</span> <span class="n">original_sha256sum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_source</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="k">if</span> <span class="n">original_sha256sum</span> <span class="o">!=</span> <span class="n">sha256sum</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="k">raise</span> <span class="n">ExternallyChangedError</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">newline</span> <span class="o">=</span> <span class="n">_file_newline_character</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="n">newline</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">watcher</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">after_write_source</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">source</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="k">return</span> <span class="n">_sha256_str</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.file.FileModule.insert_metadata" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">insert_metadata</span><span class="p">(</span><span class="n">entry_hash</span><span class="p">,</span> <span class="n">basekey</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

<a href="#rustfava.core.file.FileModule.insert_metadata" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Insert metadata into a file at lineno.</p>
<p>Also, prevent duplicate keys.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entry_hash</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hash of an entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>basekey</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Key to insert metadata for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metadate value to insert.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="k">def</span><span class="w"> </span><span class="nf">insert_metadata</span><span class="p">(</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="n">entry_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="n">basekey</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert metadata into a file at lineno.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">    Also, prevent duplicate keys.</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        entry_hash: Hash of an entry.</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        basekey: Key to insert metadata for.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        value: Metadate value to insert.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">changed</span><span class="p">()</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">get_entry</span><span class="p">(</span><span class="n">entry_hash</span><span class="p">)</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="n">key</span> <span class="o">=</span> <span class="n">next_key</span><span class="p">(</span><span class="n">basekey</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="n">indent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">indent</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="n">path</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="n">_get_position</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="n">insert_metadata_in_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">lineno</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">watcher</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">after_insert_metadata</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.file.FileModule.save_entry_slice" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_entry_slice</span><span class="p">(</span><span class="n">entry_hash</span><span class="p">,</span> <span class="n">source_slice</span><span class="p">,</span> <span class="n">sha256sum</span><span class="p">)</span></code>

<a href="#rustfava.core.file.FileModule.save_entry_slice" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Save slice of the source file for an entry.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entry_hash</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hash of an entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_slice</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The lines that the entry should be replaced with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sha256sum</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sha256sum of the current lines of the entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The <code>sha256sum</code> of the new lines of the entry.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the entry is not found or the file changed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_entry_slice</span><span class="p">(</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="n">entry_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="n">source_slice</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="n">sha256sum</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save slice of the source file for an entry.</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        entry_hash: Hash of an entry.</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        source_slice: The lines that the entry should be replaced with.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        sha256sum: The sha256sum of the current lines of the entry.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        The `sha256sum` of the new lines of the entry.</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        RustfavaAPIError: If the entry is not found or the file changed.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">get_entry</span><span class="p">(</span><span class="n">entry_hash</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="n">new_sha256sum</span> <span class="o">=</span> <span class="n">save_entry_slice</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">source_slice</span><span class="p">,</span> <span class="n">sha256sum</span><span class="p">)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">watcher</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">get_position</span><span class="p">(</span><span class="n">entry</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">after_entry_modified</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">source_slice</span><span class="p">)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="k">return</span> <span class="n">new_sha256sum</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.file.FileModule.delete_entry_slice" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_entry_slice</span><span class="p">(</span><span class="n">entry_hash</span><span class="p">,</span> <span class="n">sha256sum</span><span class="p">)</span></code>

<a href="#rustfava.core.file.FileModule.delete_entry_slice" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Delete slice of the source file for an entry.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entry_hash</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hash of an entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sha256sum</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sha256sum of the current lines of the entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the entry is not found or the file changed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="k">def</span><span class="w"> </span><span class="nf">delete_entry_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sha256sum</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete slice of the source file for an entry.</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">        entry_hash: Hash of an entry.</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        sha256sum: The sha256sum of the current lines of the entry.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        RustfavaAPIError: If the entry is not found or the file changed.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">get_entry</span><span class="p">(</span><span class="n">entry_hash</span><span class="p">)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="n">delete_entry_slice</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">sha256sum</span><span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">watcher</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">get_position</span><span class="p">(</span><span class="n">entry</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">after_delete_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.file.FileModule.insert_entries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">insert_entries</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>

<a href="#rustfava.core.file.FileModule.insert_entries" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Insert entries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entries</code>
            </td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="rustfava.beans.abc.Directive">Directive</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of entries.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="k">def</span><span class="w"> </span><span class="nf">insert_entries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert entries.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        entries: A list of entries.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">changed</span><span class="p">()</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="n">fava_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">_incomplete_sortkey</span><span class="p">):</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="n">path</span><span class="p">,</span> <span class="n">updated_insert_options</span> <span class="o">=</span> <span class="n">insert_entry</span><span class="p">(</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>                <span class="n">entry</span><span class="p">,</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>                <span class="p">(</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">default_file</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>                    <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">beancount_file_path</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>                <span class="p">),</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>                <span class="n">insert_options</span><span class="o">=</span><span class="n">fava_options</span><span class="o">.</span><span class="n">insert_entry</span><span class="p">,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>                <span class="n">currency_column</span><span class="o">=</span><span class="n">fava_options</span><span class="o">.</span><span class="n">currency_column</span><span class="p">,</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>                <span class="n">indent</span><span class="o">=</span><span class="n">fava_options</span><span class="o">.</span><span class="n">indent</span><span class="p">,</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">watcher</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">insert_entry</span> <span class="o">=</span> <span class="n">updated_insert_options</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">after_insert_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.file.FileModule.render_entries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">render_entries</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>

<a href="#rustfava.core.file.FileModule.render_entries" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Return entries in Beancount format.</p>
<p>Only renders :class:<code>.Balance</code> and :class:<code>.Transaction</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entries</code>
            </td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="rustfava.beans.abc.Directive">Directive</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of entries.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<span title="markupsafe.Markup">Markup</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The entries rendered in Beancount format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="k">def</span><span class="w"> </span><span class="nf">render_entries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Markup</span><span class="p">]:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return entries in Beancount format.</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    Only renders :class:`.Balance` and :class:`.Transaction`.</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">        entries: A list of entries.</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        The entries rendered in Beancount format.</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="n">indent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">indent</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="p">(</span><span class="n">Balance</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">)):</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>                <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">)</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>                <span class="ow">and</span> <span class="n">entry</span><span class="o">.</span><span class="n">flag</span> <span class="ow">in</span> <span class="n">_EXCL_FLAGS</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="p">):</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                <span class="k">continue</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>                <span class="k">yield</span> <span class="n">Markup</span><span class="p">(</span><span class="n">get_entry_slice</span><span class="p">(</span><span class="n">entry</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># noqa: S704</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">FileNotFoundError</span><span class="p">):</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>                <span class="k">yield</span> <span class="n">Markup</span><span class="p">(</span>  <span class="c1"># noqa: S704</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>                    <span class="n">to_string</span><span class="p">(</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>                        <span class="n">entry</span><span class="p">,</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">currency_column</span><span class="p">,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>                        <span class="n">indent</span><span class="p">,</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>                    <span class="p">),</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>                <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="rustfava.core.file.insert_metadata_in_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">insert_metadata_in_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">lineno</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

<a href="#rustfava.core.file.insert_metadata_in_file" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Insert the specified metadata in the file below lineno.</p>
<p>Takes the whitespace in front of the line that lineno into account.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="k">def</span><span class="w"> </span><span class="nf">insert_metadata_in_file</span><span class="p">(</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="n">lineno</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="n">indent</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert the specified metadata in the file below lineno.</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">    Takes the whitespace in front of the line that lineno into account.</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="n">contents</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>    <span class="n">contents</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">lineno</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot; &quot;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">indent</span><span class="si">}{</span><span class="n">key</span><span class="si">}</span><span class="s1">: &quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&quot;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="n">newline</span> <span class="o">=</span> <span class="n">_file_newline_character</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="n">newline</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">contents</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.file.find_entry_lines" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_entry_lines</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">lineno</span><span class="p">)</span></code>

<a href="#rustfava.core.file.find_entry_lines" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Lines of entry starting at lineno.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lines</code>
            </td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of lines.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lineno</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 0-based line-index to start at.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="k">def</span><span class="w"> </span><span class="nf">find_entry_lines</span><span class="p">(</span><span class="n">lines</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">lineno</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lines of entry starting at lineno.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        lines: A list of lines.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        lineno: The 0-based line-index to start at.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="n">entry_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">lines</span><span class="p">[</span><span class="n">lineno</span><span class="p">]]</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="n">lineno</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>            <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">lineno</span><span class="p">]</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>            <span class="k">return</span> <span class="n">entry_lines</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\S&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="k">return</span> <span class="n">entry_lines</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="n">entry_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.file.get_entry_slice" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_entry_slice</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span></code>

<a href="#rustfava.core.file.get_entry_slice" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get slice of the source file for an entry.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entry</code>
            </td>
            <td>
                  <code><span title="rustfava.beans.abc.Directive">Directive</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string containing the lines of the entry and the <code>sha256sum</code> of</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>these lines.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="GeneratedEntryError (rustfava.core.file.GeneratedEntryError)" href="#rustfava.core.file.GeneratedEntryError">GeneratedEntryError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the entry is generated and cannot be edited.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_entry_slice</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get slice of the source file for an entry.</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        entry: An entry.</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">        A string containing the lines of the entry and the `sha256sum` of</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        these lines.</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        GeneratedEntryError: If the entry is generated and cannot be edited.</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="n">path</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="n">_get_position</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="n">entry_lines</span> <span class="o">=</span> <span class="n">find_entry_lines</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>    <span class="n">entry_source</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entry_lines</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="k">return</span> <span class="n">entry_source</span><span class="p">,</span> <span class="n">_sha256_str</span><span class="p">(</span><span class="n">entry_source</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.file.save_entry_slice" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_entry_slice</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">source_slice</span><span class="p">,</span> <span class="n">sha256sum</span><span class="p">)</span></code>

<a href="#rustfava.core.file.save_entry_slice" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Save slice of the source file for an entry.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entry</code>
            </td>
            <td>
                  <code><span title="rustfava.beans.abc.Directive">Directive</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_slice</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The lines that the entry should be replaced with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sha256sum</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sha256sum of the current lines of the entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The <code>sha256sum</code> of the new lines of the entry.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ExternallyChangedError (rustfava.core.file.ExternallyChangedError)" href="#rustfava.core.file.ExternallyChangedError">ExternallyChangedError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file was changed externally.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="GeneratedEntryError (rustfava.core.file.GeneratedEntryError)" href="#rustfava.core.file.GeneratedEntryError">GeneratedEntryError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the entry is generated and cannot be edited.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_entry_slice</span><span class="p">(</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">,</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="n">source_slice</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="n">sha256sum</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save slice of the source file for an entry.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">        entry: An entry.</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">        source_slice: The lines that the entry should be replaced with.</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        sha256sum: The sha256sum of the current lines of the entry.</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">        The `sha256sum` of the new lines of the entry.</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">        ExternallyChangedError: If the file was changed externally.</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">        GeneratedEntryError: If the entry is generated and cannot be edited.</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="n">path</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="n">_get_position</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>    <span class="n">first_entry_line</span> <span class="o">=</span> <span class="n">lineno</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="n">entry_lines</span> <span class="o">=</span> <span class="n">find_entry_lines</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">first_entry_line</span><span class="p">)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="n">entry_source</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entry_lines</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="k">if</span> <span class="n">_sha256_str</span><span class="p">(</span><span class="n">entry_source</span><span class="p">)</span> <span class="o">!=</span> <span class="n">sha256sum</span><span class="p">:</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="k">raise</span> <span class="n">ExternallyChangedError</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="o">*</span><span class="n">lines</span><span class="p">[:</span><span class="n">first_entry_line</span><span class="p">],</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="n">source_slice</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="o">*</span><span class="n">lines</span><span class="p">[</span><span class="n">first_entry_line</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry_lines</span><span class="p">)</span> <span class="p">:],</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>    <span class="p">]</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="n">newline</span> <span class="o">=</span> <span class="n">_file_newline_character</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>    <span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="n">newline</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="n">file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="k">return</span> <span class="n">_sha256_str</span><span class="p">(</span><span class="n">source_slice</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.file.delete_entry_slice" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_entry_slice</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">sha256sum</span><span class="p">)</span></code>

<a href="#rustfava.core.file.delete_entry_slice" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Delete slice of the source file for an entry.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entry</code>
            </td>
            <td>
                  <code><span title="rustfava.beans.abc.Directive">Directive</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sha256sum</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sha256sum of the current lines of the entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ExternallyChangedError (rustfava.core.file.ExternallyChangedError)" href="#rustfava.core.file.ExternallyChangedError">ExternallyChangedError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file was changed externally.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="GeneratedEntryError (rustfava.core.file.GeneratedEntryError)" href="#rustfava.core.file.GeneratedEntryError">GeneratedEntryError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the entry is generated and cannot be edited.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="k">def</span><span class="w"> </span><span class="nf">delete_entry_slice</span><span class="p">(</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">,</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>    <span class="n">sha256sum</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete slice of the source file for an entry.</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">        entry: An entry.</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">        sha256sum: The sha256sum of the current lines of the entry.</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">        ExternallyChangedError: If the file was changed externally.</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">        GeneratedEntryError: If the entry is generated and cannot be edited.</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>    <span class="n">path</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="n">_get_position</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="n">first_entry_line</span> <span class="o">=</span> <span class="n">lineno</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>    <span class="n">entry_lines</span> <span class="o">=</span> <span class="n">find_entry_lines</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">first_entry_line</span><span class="p">)</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="n">entry_source</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entry_lines</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>    <span class="k">if</span> <span class="n">_sha256_str</span><span class="p">(</span><span class="n">entry_source</span><span class="p">)</span> <span class="o">!=</span> <span class="n">sha256sum</span><span class="p">:</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="k">raise</span> <span class="n">ExternallyChangedError</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>    <span class="c1"># Also delete the whitespace following this entry</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="n">last_entry_line</span> <span class="o">=</span> <span class="n">first_entry_line</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry_lines</span><span class="p">)</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>            <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">last_entry_line</span><span class="p">]</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>            <span class="k">break</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>            <span class="k">break</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>        <span class="n">last_entry_line</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[:</span><span class="n">first_entry_line</span><span class="p">]</span> <span class="o">+</span> <span class="n">lines</span><span class="p">[</span><span class="n">last_entry_line</span><span class="p">:]</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="n">newline</span> <span class="o">=</span> <span class="n">_file_newline_character</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="n">newline</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>        <span class="n">file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.file.insert_entry" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">insert_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">default_filename</span><span class="p">,</span> <span class="n">insert_options</span><span class="p">,</span> <span class="n">currency_column</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span></code>

<a href="#rustfava.core.file.insert_entry" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Insert an entry.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entry</code>
            </td>
            <td>
                  <code><span title="rustfava.beans.abc.Directive">Directive</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The default file to insert into if no option matches.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>insert_options</code>
            </td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="InsertEntryOption


  
      dataclass
   (rustfava.core.fava_options.InsertEntryOption)" href="#rustfava.core.fava_options.InsertEntryOption">InsertEntryOption</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Insert options.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>currency_column</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column to align currencies at.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>indent</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of indent spaces.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="pathlib.Path">Path</span>, <span title="collections.abc.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="InsertEntryOption


  
      dataclass
   (rustfava.core.fava_options.InsertEntryOption)" href="#rustfava.core.fava_options.InsertEntryOption">InsertEntryOption</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A changed path and list of updated insert options.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="k">def</span><span class="w"> </span><span class="nf">insert_entry</span><span class="p">(</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">,</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="n">default_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="n">insert_options</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">InsertEntryOption</span><span class="p">],</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>    <span class="n">currency_column</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="n">indent</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">InsertEntryOption</span><span class="p">]]:</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert an entry.</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">        entry: An entry.</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        default_filename: The default file to insert into if no option matches.</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">        insert_options: Insert options.</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">        currency_column: The column to align currencies at.</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">        indent: Number of indent spaces.</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">        A changed path and list of updated insert options.</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span> <span class="o">=</span> <span class="n">find_insert_position</span><span class="p">(</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>        <span class="n">entry</span><span class="p">,</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>        <span class="n">insert_options</span><span class="p">,</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="n">default_filename</span><span class="p">,</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="p">)</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="n">content</span> <span class="o">=</span> <span class="n">to_string</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">currency_column</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="n">contents</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>    <span class="k">if</span> <span class="n">lineno</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="c1"># Appending</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="n">contents</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">content</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="n">contents</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">lineno</span><span class="p">,</span> <span class="n">content</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>    <span class="n">newline</span> <span class="o">=</span> <span class="n">_file_newline_character</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="n">newline</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="n">file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>    <span class="k">if</span> <span class="n">lineno</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">insert_options</span><span class="p">)</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="n">added_lines</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>    <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="n">path</span><span class="p">,</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="p">[</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>            <span class="p">(</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>                <span class="n">replace</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">lineno</span><span class="o">=</span><span class="n">option</span><span class="o">.</span><span class="n">lineno</span> <span class="o">+</span> <span class="n">added_lines</span><span class="p">)</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>                <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">filename</span> <span class="o">==</span> <span class="n">filename</span> <span class="ow">and</span> <span class="n">option</span><span class="o">.</span><span class="n">lineno</span> <span class="o">&gt;</span> <span class="n">lineno</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>                <span class="k">else</span> <span class="n">option</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>            <span class="p">)</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">insert_options</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>        <span class="p">],</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.file.find_insert_position" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_insert_position</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">insert_options</span><span class="p">,</span> <span class="n">default_filename</span><span class="p">)</span></code>

<a href="#rustfava.core.file.find_insert_position" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Find insert position for an entry.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entry</code>
            </td>
            <td>
                  <code><span title="rustfava.beans.abc.Directive">Directive</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>insert_options</code>
            </td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="InsertEntryOption


  
      dataclass
   (rustfava.core.fava_options.InsertEntryOption)" href="#rustfava.core.fava_options.InsertEntryOption">InsertEntryOption</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of InsertOption.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The default file to insert into if no option matches.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="str">str</span>, <span title="int">int</span> | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple of the filename and the line number.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="k">def</span><span class="w"> </span><span class="nf">find_insert_position</span><span class="p">(</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>    <span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">,</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>    <span class="n">insert_options</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">InsertEntryOption</span><span class="p">],</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>    <span class="n">default_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find insert position for an entry.</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">        entry: An entry.</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">        insert_options: A list of InsertOption.</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">        default_filename: The default file to insert into if no option matches.</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">        A tuple of the filename and the line number.</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>    <span class="c1"># Get the list of accounts that should be considered for the entry.</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>    <span class="c1"># For transactions, we want the reversed list of posting accounts.</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>    <span class="n">accounts</span> <span class="o">=</span> <span class="n">get_entry_accounts</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>    <span class="c1"># Make no assumptions about the order of insert_options entries and instead</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>    <span class="c1"># sort them ourselves (by descending dates)</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>    <span class="n">insert_options</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="n">insert_options</span><span class="p">,</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">),</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>        <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>    <span class="p">)</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>    <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="n">accounts</span><span class="p">:</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>        <span class="k">for</span> <span class="n">insert_option</span> <span class="ow">in</span> <span class="n">insert_options</span><span class="p">:</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>            <span class="c1"># Only consider InsertOptions before the entry date.</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>            <span class="k">if</span> <span class="n">insert_option</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="p">:</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>                <span class="k">continue</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>            <span class="k">if</span> <span class="n">insert_option</span><span class="o">.</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">account</span><span class="p">):</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>                <span class="k">return</span> <span class="p">(</span><span class="n">insert_option</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">insert_option</span><span class="o">.</span><span class="n">lineno</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">default_filename</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.filters" class="doc doc-heading">
            <code>filters</code>


<a href="#rustfava.core.filters" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Entry filters.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.filters.FilterError" class="doc doc-heading">
            <code>FilterError</code>


<a href="#rustfava.core.filters.FilterError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code></p>



        <p>Filter exception.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="k">class</span><span class="w"> </span><span class="nc">FilterError</span><span class="p">(</span><span class="n">RustfavaAPIError</span><span class="p">):</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter exception.&quot;&quot;&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_type</span> <span class="o">=</span> <span class="n">filter_type</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.filters.FilterParseError" class="doc doc-heading">
            <code>FilterParseError</code>


<a href="#rustfava.core.filters.FilterParseError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FilterError (rustfava.core.filters.FilterError)" href="#rustfava.core.filters.FilterError">FilterError</a></code></p>



        <p>Filter parse error.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="k">class</span><span class="w"> </span><span class="nc">FilterParseError</span><span class="p">(</span><span class="n">FilterError</span><span class="p">):</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter parse error.&quot;&quot;&quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;filter&quot;</span><span class="p">,</span> <span class="s2">&quot;Failed to parse filter: &quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.filters.FilterIllegalCharError" class="doc doc-heading">
            <code>FilterIllegalCharError</code>


<a href="#rustfava.core.filters.FilterIllegalCharError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FilterError (rustfava.core.filters.FilterError)" href="#rustfava.core.filters.FilterError">FilterError</a></code></p>



        <p>Filter illegal char error.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="k">class</span><span class="w"> </span><span class="nc">FilterIllegalCharError</span><span class="p">(</span><span class="n">FilterError</span><span class="p">):</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter illegal char error.&quot;&quot;&quot;</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>            <span class="s2">&quot;filter&quot;</span><span class="p">,</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>            <span class="sa">f</span><span class="s1">&#39;Illegal character &quot;</span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="s1">&quot; in filter.&#39;</span><span class="p">,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.filters.TimeFilterParseError" class="doc doc-heading">
            <code>TimeFilterParseError</code>


<a href="#rustfava.core.filters.TimeFilterParseError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FilterError (rustfava.core.filters.FilterError)" href="#rustfava.core.filters.FilterError">FilterError</a></code></p>



        <p>Time filter parse error.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="k">class</span><span class="w"> </span><span class="nc">TimeFilterParseError</span><span class="p">(</span><span class="n">FilterError</span><span class="p">):</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Time filter parse error.&quot;&quot;&quot;</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Failed to parse date: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.filters.Token" class="doc doc-heading">
            <code>Token</code>


<a href="#rustfava.core.filters.Token" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>A token having a certain type and value.</p>
<p>The lexer attribute only exists since PLY writes to it in case of a parser
error.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="k">class</span><span class="w"> </span><span class="nc">Token</span><span class="p">:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A token having a certain type and value.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    The lexer attribute only exists since PLY writes to it in case of a parser</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    error.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;lexer&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">type_</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Token(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.filters.FilterSyntaxLexer" class="doc doc-heading">
            <code>FilterSyntaxLexer</code>


<a href="#rustfava.core.filters.FilterSyntaxLexer" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>Lexer for Fava's filter syntax.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="k">class</span><span class="w"> </span><span class="nc">FilterSyntaxLexer</span><span class="p">:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lexer for Fava&#39;s filter syntax.&quot;&quot;&quot;</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">tokens</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="s2">&quot;ANY&quot;</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="s2">&quot;ALL&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="s2">&quot;CMP_OP&quot;</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="s2">&quot;EQ_OP&quot;</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="s2">&quot;KEY&quot;</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="s2">&quot;LINK&quot;</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="s2">&quot;NUMBER&quot;</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="s2">&quot;STRING&quot;</span><span class="p">,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="s2">&quot;TAG&quot;</span><span class="p">,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">RULES</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="p">(</span><span class="s2">&quot;LINK&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\^[A-Za-z0-9\-_/.]+&quot;</span><span class="p">),</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="p">(</span><span class="s2">&quot;TAG&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\#[A-Za-z0-9\-_/.]+&quot;</span><span class="p">),</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="p">(</span><span class="s2">&quot;ALL&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;all\(&quot;</span><span class="p">),</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="p">(</span><span class="s2">&quot;ANY&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;any\(&quot;</span><span class="p">),</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="p">(</span><span class="s2">&quot;KEY&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;[a-z][a-zA-Z0-9\-_]+(?=\s*(:|=|&gt;=|&lt;=|&lt;|&gt;))&quot;</span><span class="p">),</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="p">(</span><span class="s2">&quot;EQ_OP&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;:&quot;</span><span class="p">),</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="p">(</span><span class="s2">&quot;CMP_OP&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;(=|&gt;=|&lt;=|&lt;|&gt;)&quot;</span><span class="p">),</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="p">(</span><span class="s2">&quot;NUMBER&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\d*\.?\d+&quot;</span><span class="p">),</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="p">(</span><span class="s2">&quot;STRING&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;\w[-\w]*|&quot;[^&quot;]*&quot;|&#39;[^&#39;]*&#39;&quot;&quot;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="p">)</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="n">regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="sa">f</span><span class="s2">&quot;(?P&lt;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">rule</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">RULES</span><span class="p">)),</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">LINK</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>  <span class="c1"># noqa: N802</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="k">return</span> <span class="n">token</span><span class="p">,</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">TAG</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>  <span class="c1"># noqa: N802</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="k">return</span> <span class="n">token</span><span class="p">,</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">KEY</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>  <span class="c1"># noqa: N802</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="k">return</span> <span class="n">token</span><span class="p">,</span> <span class="n">value</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">ALL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>  <span class="c1"># noqa: N802</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="k">return</span> <span class="n">token</span><span class="p">,</span> <span class="n">token</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">ANY</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>  <span class="c1"># noqa: N802</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="k">return</span> <span class="n">token</span><span class="p">,</span> <span class="n">token</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">EQ_OP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>  <span class="c1"># noqa: N802</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="k">return</span> <span class="n">token</span><span class="p">,</span> <span class="n">value</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">CMP_OP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>  <span class="c1"># noqa: N802</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="k">return</span> <span class="n">token</span><span class="p">,</span> <span class="n">value</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">NUMBER</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">]:</span>  <span class="c1"># noqa: N802</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="k">return</span> <span class="n">token</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">STRING</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>  <span class="c1"># noqa: N802</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">}:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="k">return</span> <span class="n">token</span><span class="p">,</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="k">return</span> <span class="n">token</span><span class="p">,</span> <span class="n">value</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">lex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A generator yielding all tokens in a given line.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        Arguments:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">            data: A string, the line to lex.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        Yields:</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            All Tokens in the line.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="n">ignore</span> <span class="o">=</span> <span class="s2">&quot; </span><span class="se">\t</span><span class="s2">&quot;</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="n">literals</span> <span class="o">=</span> <span class="s2">&quot;-,()&quot;</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="n">regex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex</span><span class="o">.</span><span class="n">match</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="k">while</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="n">char</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">ignore</span><span class="p">:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                <span class="k">continue</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="n">match</span> <span class="o">=</span> <span class="n">regex</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>                <span class="n">pos</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>                <span class="n">token</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">lastgroup</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>                <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Internal Error&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>                <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>                    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>                    <span class="n">token</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>                <span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>                <span class="n">ret</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>                <span class="k">yield</span> <span class="n">Token</span><span class="p">(</span><span class="o">*</span><span class="n">ret</span><span class="p">)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>            <span class="k">elif</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">literals</span><span class="p">:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>                <span class="k">yield</span> <span class="n">Token</span><span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="n">char</span><span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>                <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>                <span class="k">raise</span> <span class="n">FilterIllegalCharError</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.filters.FilterSyntaxLexer.lex" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lex</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

<a href="#rustfava.core.filters.FilterSyntaxLexer.lex" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>A generator yielding all tokens in a given line.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string, the line to lex.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="Token (rustfava.core.filters.Token)" href="#rustfava.core.filters.Token">Token</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>All Tokens in the line.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="k">def</span><span class="w"> </span><span class="nf">lex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A generator yielding all tokens in a given line.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        data: A string, the line to lex.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        All Tokens in the line.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="n">ignore</span> <span class="o">=</span> <span class="s2">&quot; </span><span class="se">\t</span><span class="s2">&quot;</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="n">literals</span> <span class="o">=</span> <span class="s2">&quot;-,()&quot;</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="n">regex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex</span><span class="o">.</span><span class="n">match</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="k">while</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="n">char</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">ignore</span><span class="p">:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="k">continue</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">match</span> <span class="o">=</span> <span class="n">regex</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="n">pos</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="n">token</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">lastgroup</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Internal Error&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>            <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>                <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>                <span class="n">token</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>            <span class="n">ret</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>            <span class="k">yield</span> <span class="n">Token</span><span class="p">(</span><span class="o">*</span><span class="n">ret</span><span class="p">)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="k">elif</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">literals</span><span class="p">:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>            <span class="k">yield</span> <span class="n">Token</span><span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="n">char</span><span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="k">raise</span> <span class="n">FilterIllegalCharError</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.filters.Match" class="doc doc-heading">
            <code>Match</code>


<a href="#rustfava.core.filters.Match" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>Match a string.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="k">class</span><span class="w"> </span><span class="nc">Match</span><span class="p">:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Match a string.&quot;&quot;&quot;</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;match&quot;</span><span class="p">,)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="n">match</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">search</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span><span class="o">.</span><span class="n">search</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">match</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="k">except</span> <span class="n">re</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="o">==</span> <span class="n">search</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.filters.MatchAmount" class="doc doc-heading">
            <code>MatchAmount</code>


<a href="#rustfava.core.filters.MatchAmount" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>Matches an amount.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="k">class</span><span class="w"> </span><span class="nc">MatchAmount</span><span class="p">:</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Matches an amount.&quot;&quot;&quot;</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;match&quot;</span><span class="p">,)</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="n">match</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Decimal</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="k">if</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;=&quot;</span><span class="p">:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="n">value</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;&gt;=&quot;</span><span class="p">:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">value</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">value</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">value</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># op == &quot;&lt;&quot;:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">value</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="c1"># Compare to the absolute value to simplify this filter.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="n">number</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">number</span><span class="p">))</span> <span class="k">if</span> <span class="n">number</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.filters.FilterSyntaxParser" class="doc doc-heading">
            <code>FilterSyntaxParser</code>


<a href="#rustfava.core.filters.FilterSyntaxParser" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">










              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="k">class</span><span class="w"> </span><span class="nc">FilterSyntaxParser</span><span class="p">:</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="n">precedence</span> <span class="o">=</span> <span class="p">((</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;AND&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;UMINUS&quot;</span><span class="p">))</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">tokens</span> <span class="o">=</span> <span class="n">FilterSyntaxLexer</span><span class="o">.</span><span class="n">tokens</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">p_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="k">raise</span> <span class="n">FilterParseError</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">p_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        filter : expr</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">p_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        expr : simple_expr</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">p_expr_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        expr : ALL expr &#39;)&#39;</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="n">expr</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">_match_postings</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>            <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>                <span class="n">expr</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span> <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;postings&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>            <span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_match_postings</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">p_expr_any</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        expr : ANY expr &#39;)&#39;</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="n">expr</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">_match_postings</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="k">return</span> <span class="nb">any</span><span class="p">(</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>                <span class="n">expr</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span> <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;postings&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_match_postings</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">p_expr_parentheses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        expr : &#39;(&#39; expr &#39;)&#39;</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">p_expr_and</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        expr : expr expr %prec AND</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">_and</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>            <span class="k">return</span> <span class="n">left</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="ow">and</span> <span class="n">right</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>  <span class="c1"># type: ignore[no-any-return]</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_and</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">p_expr_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        expr : expr &#39;,&#39; expr</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">_or</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>            <span class="k">return</span> <span class="n">left</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="ow">or</span> <span class="n">right</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>  <span class="c1"># type: ignore[no-any-return]</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_or</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">p_expr_negated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        expr : &#39;-&#39; expr %prec UMINUS</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="n">func</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">_neg</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>            <span class="k">return</span> <span class="ow">not</span> <span class="n">func</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_neg</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">p_simple_expr_TAG</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># noqa: N802</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        simple_expr : TAG</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="n">tag</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">_tag</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>            <span class="n">tags</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>            <span class="k">return</span> <span class="p">(</span><span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">)</span> <span class="k">if</span> <span class="n">tags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_tag</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">p_simple_expr_LINK</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># noqa: N802</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        simple_expr : LINK</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="n">link</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">_link</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>            <span class="n">links</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;links&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>            <span class="k">return</span> <span class="p">(</span><span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">)</span> <span class="k">if</span> <span class="n">links</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_link</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">p_simple_expr_STRING</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># noqa: N802</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        simple_expr : STRING</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="n">string</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="n">match</span> <span class="o">=</span> <span class="n">Match</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">_string</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;narration&quot;</span><span class="p">,</span> <span class="s2">&quot;payee&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">):</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>                <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>                <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">match</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>                    <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_string</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">p_simple_expr_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">        simple_expr : KEY EQ_OP STRING</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">                    | KEY CMP_OP NUMBER</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>        <span class="n">key</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="n">match</span><span class="p">:</span> <span class="n">Match</span> <span class="o">|</span> <span class="n">MatchAmount</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>            <span class="n">Match</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">if</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;:&quot;</span> <span class="k">else</span> <span class="n">MatchAmount</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">_key</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>                <span class="k">return</span> <span class="n">match</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">:</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>                <span class="k">return</span> <span class="n">match</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_key</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">p_simple_expr_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        simple_expr : CMP_OP NUMBER</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="n">op</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="n">match</span> <span class="o">=</span> <span class="n">MatchAmount</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">_range</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>            <span class="k">return</span> <span class="nb">any</span><span class="p">(</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                <span class="k">match</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;postings&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="p">)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_range</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.filters.FilterSyntaxParser.p_filter" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_filter</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></code>

<a href="#rustfava.core.filters.FilterSyntaxParser.p_filter" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>filter : expr</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="k">def</span><span class="w"> </span><span class="nf">p_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">    filter : expr</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.filters.FilterSyntaxParser.p_expr" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_expr</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></code>

<a href="#rustfava.core.filters.FilterSyntaxParser.p_expr" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>expr : simple_expr</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="k">def</span><span class="w"> </span><span class="nf">p_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    expr : simple_expr</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.filters.FilterSyntaxParser.p_expr_all" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_expr_all</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></code>

<a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_all" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>expr : ALL expr ')'</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="k">def</span><span class="w"> </span><span class="nf">p_expr_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    expr : ALL expr &#39;)&#39;</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="n">expr</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_match_postings</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>            <span class="n">expr</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span> <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;postings&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_match_postings</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.filters.FilterSyntaxParser.p_expr_any" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_expr_any</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></code>

<a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_any" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>expr : ANY expr ')'</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="k">def</span><span class="w"> </span><span class="nf">p_expr_any</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">    expr : ANY expr &#39;)&#39;</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="n">expr</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_match_postings</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="n">expr</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span> <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;postings&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_match_postings</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.filters.FilterSyntaxParser.p_expr_parentheses" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_expr_parentheses</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></code>

<a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_parentheses" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>expr : '(' expr ')'</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="k">def</span><span class="w"> </span><span class="nf">p_expr_parentheses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">    expr : &#39;(&#39; expr &#39;)&#39;</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.filters.FilterSyntaxParser.p_expr_and" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_expr_and</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></code>

<a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_and" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>expr : expr expr %prec AND</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="k">def</span><span class="w"> </span><span class="nf">p_expr_and</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">    expr : expr expr %prec AND</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_and</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="k">return</span> <span class="n">left</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="ow">and</span> <span class="n">right</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>  <span class="c1"># type: ignore[no-any-return]</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_and</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.filters.FilterSyntaxParser.p_expr_or" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_expr_or</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></code>

<a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_or" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>expr : expr ',' expr</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="k">def</span><span class="w"> </span><span class="nf">p_expr_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">    expr : expr &#39;,&#39; expr</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_or</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="k">return</span> <span class="n">left</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="ow">or</span> <span class="n">right</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>  <span class="c1"># type: ignore[no-any-return]</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_or</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.filters.FilterSyntaxParser.p_expr_negated" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_expr_negated</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></code>

<a href="#rustfava.core.filters.FilterSyntaxParser.p_expr_negated" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>expr : '-' expr %prec UMINUS</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="k">def</span><span class="w"> </span><span class="nf">p_expr_negated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    expr : &#39;-&#39; expr %prec UMINUS</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="n">func</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_neg</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="k">return</span> <span class="ow">not</span> <span class="n">func</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_neg</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.filters.FilterSyntaxParser.p_simple_expr_TAG" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_simple_expr_TAG</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></code>

<a href="#rustfava.core.filters.FilterSyntaxParser.p_simple_expr_TAG" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>simple_expr : TAG</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="k">def</span><span class="w"> </span><span class="nf">p_simple_expr_TAG</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># noqa: N802</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">    simple_expr : TAG</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="n">tag</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_tag</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>        <span class="n">tags</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">)</span> <span class="k">if</span> <span class="n">tags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_tag</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.filters.FilterSyntaxParser.p_simple_expr_LINK" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_simple_expr_LINK</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></code>

<a href="#rustfava.core.filters.FilterSyntaxParser.p_simple_expr_LINK" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>simple_expr : LINK</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="k">def</span><span class="w"> </span><span class="nf">p_simple_expr_LINK</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># noqa: N802</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">    simple_expr : LINK</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>    <span class="n">link</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_link</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="n">links</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;links&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">)</span> <span class="k">if</span> <span class="n">links</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_link</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.filters.FilterSyntaxParser.p_simple_expr_STRING" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_simple_expr_STRING</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></code>

<a href="#rustfava.core.filters.FilterSyntaxParser.p_simple_expr_STRING" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>simple_expr : STRING</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="k">def</span><span class="w"> </span><span class="nf">p_simple_expr_STRING</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># noqa: N802</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">    simple_expr : STRING</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="n">string</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="n">match</span> <span class="o">=</span> <span class="n">Match</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_string</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;narration&quot;</span><span class="p">,</span> <span class="s2">&quot;payee&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">):</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>            <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">match</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_string</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.filters.FilterSyntaxParser.p_simple_expr_key" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_simple_expr_key</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></code>

<a href="#rustfava.core.filters.FilterSyntaxParser.p_simple_expr_key" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">



<details class="simple_expr-" open>
  <summary>KEY EQ_OP STRING</summary>
  <p>| KEY CMP_OP NUMBER</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="k">def</span><span class="w"> </span><span class="nf">p_simple_expr_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">    simple_expr : KEY EQ_OP STRING</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">                | KEY CMP_OP NUMBER</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="n">key</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="n">match</span><span class="p">:</span> <span class="n">Match</span> <span class="o">|</span> <span class="n">MatchAmount</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="n">Match</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">if</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;:&quot;</span> <span class="k">else</span> <span class="n">MatchAmount</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_key</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>            <span class="k">return</span> <span class="n">match</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">:</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>            <span class="k">return</span> <span class="n">match</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_key</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.filters.FilterSyntaxParser.p_simple_expr_units" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">p_simple_expr_units</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></code>

<a href="#rustfava.core.filters.FilterSyntaxParser.p_simple_expr_units" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>simple_expr : CMP_OP NUMBER</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="k">def</span><span class="w"> </span><span class="nf">p_simple_expr_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">    simple_expr : CMP_OP NUMBER</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="n">op</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="n">match</span> <span class="o">=</span> <span class="n">MatchAmount</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_range</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">Directive</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="k">return</span> <span class="nb">any</span><span class="p">(</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>            <span class="k">match</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>            <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;postings&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="p">)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_range</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.filters.EntryFilter" class="doc doc-heading">
            <code>EntryFilter</code>


<a href="#rustfava.core.filters.EntryFilter" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>



        <p>Filters a list of entries.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="k">class</span><span class="w"> </span><span class="nc">EntryFilter</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filters a list of entries.&quot;&quot;&quot;</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">]:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter a list of directives.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.filters.EntryFilter.apply" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#rustfava.core.filters.EntryFilter.apply" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Filter a list of directives.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">]:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter a list of directives.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.filters.TimeFilter" class="doc doc-heading">
            <code>TimeFilter</code>


<a href="#rustfava.core.filters.TimeFilter" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="EntryFilter (rustfava.core.filters.EntryFilter)" href="#rustfava.core.filters.EntryFilter">EntryFilter</a></code></p>



        <p>Filter by dates.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="k">class</span><span class="w"> </span><span class="nc">TimeFilter</span><span class="p">(</span><span class="n">EntryFilter</span><span class="p">):</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter by dates.&quot;&quot;&quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;date_range&quot;</span><span class="p">,)</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="n">options</span><span class="p">:</span> <span class="n">BeancountOptions</span><span class="p">,</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="n">fava_options</span><span class="p">:</span> <span class="n">RustfavaOptions</span><span class="p">,</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="k">del</span> <span class="n">options</span>  <span class="c1"># unused</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="n">begin</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">parse_date</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">fava_options</span><span class="o">.</span><span class="n">fiscal_year_end</span><span class="p">)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">begin</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">end</span><span class="p">:</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>            <span class="k">raise</span> <span class="n">TimeFilterParseError</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">date_range</span> <span class="o">=</span> <span class="n">DateRange</span><span class="p">(</span><span class="n">begin</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">]:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">rustfava.rustledger.engine</span><span class="w"> </span><span class="kn">import</span> <span class="n">RustledgerEngine</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">rustfava.rustledger.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">directives_from_json</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">rustfava.rustledger.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">directives_to_json</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="c1"># Use native rustledger clamp_entries</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>        <span class="n">engine</span> <span class="o">=</span> <span class="n">RustledgerEngine</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="n">entries_json</span> <span class="o">=</span> <span class="n">directives_to_json</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">entries</span><span class="p">))</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">clamp_entries</span><span class="p">(</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>            <span class="n">entries_json</span><span class="p">,</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">begin</span><span class="p">),</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">end</span><span class="p">),</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="k">return</span> <span class="n">directives_from_json</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;entries&quot;</span><span class="p">,</span> <span class="p">[]))</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.filters.AdvancedFilter" class="doc doc-heading">
            <code>AdvancedFilter</code>


<a href="#rustfava.core.filters.AdvancedFilter" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="EntryFilter (rustfava.core.filters.EntryFilter)" href="#rustfava.core.filters.EntryFilter">EntryFilter</a></code></p>



        <p>Filter by tags and links and keys.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="k">class</span><span class="w"> </span><span class="nc">AdvancedFilter</span><span class="p">(</span><span class="n">EntryFilter</span><span class="p">):</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter by tags and links and keys.&quot;&quot;&quot;</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_include&quot;</span><span class="p">,)</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>            <span class="n">tokens</span> <span class="o">=</span> <span class="n">LEXER</span><span class="o">.</span><span class="n">lex</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_include</span> <span class="o">=</span> <span class="n">PARSE</span><span class="p">(</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>                <span class="n">lexer</span><span class="o">=</span><span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>                <span class="n">tokenfunc</span><span class="o">=</span><span class="k">lambda</span> <span class="n">toks</span><span class="o">=</span><span class="n">tokens</span><span class="p">:</span> <span class="nb">next</span><span class="p">(</span><span class="n">toks</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>  <span class="c1"># ty:ignore[invalid-argument-type]</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>            <span class="p">)</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>        <span class="k">except</span> <span class="n">FilterError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>            <span class="n">exception</span><span class="o">.</span><span class="n">message</span> <span class="o">+=</span> <span class="n">value</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>            <span class="k">raise</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">]:</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="n">include</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_include</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">entry</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span> <span class="k">if</span> <span class="n">include</span><span class="p">(</span><span class="n">entry</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.filters.AccountFilter" class="doc doc-heading">
            <code>AccountFilter</code>


<a href="#rustfava.core.filters.AccountFilter" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="EntryFilter (rustfava.core.filters.EntryFilter)" href="#rustfava.core.filters.EntryFilter">EntryFilter</a></code></p>



        <p>Filter by account.</p>
<p>The filter string can either be a regular expression or a parent account.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="k">class</span><span class="w"> </span><span class="nc">AccountFilter</span><span class="p">(</span><span class="n">EntryFilter</span><span class="p">):</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter by account.</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">    The filter string can either be a regular expression or a parent account.</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_match&quot;</span><span class="p">,</span> <span class="s2">&quot;_value&quot;</span><span class="p">)</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_match</span> <span class="o">=</span> <span class="n">Match</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">]:</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>            <span class="k">return</span> <span class="n">entries</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="n">match</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_match</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>            <span class="n">entry</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>                <span class="n">_has_component</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">or</span> <span class="n">match</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">get_entry_accounts</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>            <span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.group_entries" class="doc doc-heading">
            <code>group_entries</code>


<a href="#rustfava.core.group_entries" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Entries grouped by type.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.group_entries.EntriesByType" class="doc doc-heading">
            <code>EntriesByType</code>


<a href="#rustfava.core.group_entries.EntriesByType" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>



        <p>Entries grouped by type.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/group_entries.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="k">class</span><span class="w"> </span><span class="nc">EntriesByType</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Entries grouped by type.&quot;&quot;&quot;</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">Balance</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Balance</span><span class="p">]</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">Close</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Close</span><span class="p">]</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="n">Commodity</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Commodity</span><span class="p">]</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="n">Custom</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Custom</span><span class="p">]</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="n">Document</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Document</span><span class="p">]</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="n">Event</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Event</span><span class="p">]</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="n">Note</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Note</span><span class="p">]</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="n">Open</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Open</span><span class="p">]</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="n">Pad</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Pad</span><span class="p">]</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">Price</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Price</span><span class="p">]</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">Query</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Query</span><span class="p">]</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">Transaction</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Transaction</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.group_entries.TransactionPosting" class="doc doc-heading">
            <code>TransactionPosting</code>


<a href="#rustfava.core.group_entries.TransactionPosting" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.NamedTuple">NamedTuple</span></code></p>



        <p>Pair of a transaction and a posting.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/group_entries.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="k">class</span><span class="w"> </span><span class="nc">TransactionPosting</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Pair of a transaction and a posting.&quot;&quot;&quot;</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">transaction</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Transaction</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">posting</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Posting</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="rustfava.core.group_entries.group_entries_by_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">group_entries_by_type</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>

<a href="#rustfava.core.group_entries.group_entries_by_type" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Group entries by type.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entries</code>
            </td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="rustfava.beans.abc.Directive">Directive</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of entries to group.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="EntriesByType (rustfava.core.group_entries.EntriesByType)" href="#rustfava.core.group_entries.EntriesByType">EntriesByType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A namedtuple containing the grouped lists of entries.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/group_entries.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="k">def</span><span class="w"> </span><span class="nf">group_entries_by_type</span><span class="p">(</span><span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Directive</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">EntriesByType</span><span class="p">:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Group entries by type.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        entries: A list of entries to group.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        A namedtuple containing the grouped lists of entries.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">entries_by_type</span> <span class="o">=</span> <span class="n">EntriesByType</span><span class="p">(</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="p">[],</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="p">[],</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="p">[],</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="p">[],</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="p">[],</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="p">[],</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="p">[],</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="p">[],</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="p">[],</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="p">[],</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="p">[],</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="p">[],</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="p">)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="c1"># Handle both beancount types (e.g., &quot;Transaction&quot;) and</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="c1"># rustledger types (e.g., &quot;RLTransaction&quot;)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="n">type_name</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="k">if</span> <span class="n">type_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;RL&quot;</span><span class="p">):</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>            <span class="n">type_name</span> <span class="o">=</span> <span class="n">type_name</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>  <span class="c1"># Strip &quot;RL&quot; prefix</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="nb">getattr</span><span class="p">(</span><span class="n">entries_by_type</span><span class="p">,</span> <span class="n">type_name</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="k">return</span> <span class="n">entries_by_type</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.group_entries.group_entries_by_account" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">group_entries_by_account</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>

<a href="#rustfava.core.group_entries.group_entries_by_account" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Group entries by account.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entries</code>
            </td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="rustfava.beans.abc.Directive">Directive</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of entries.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Mapping">Mapping</span>[<span title="str">str</span>, <span title="collections.abc.Sequence">Sequence</span>[<span title="rustfava.beans.abc.Directive">Directive</span> | <a class="autorefs autorefs-internal" title="TransactionPosting (rustfava.core.group_entries.TransactionPosting)" href="#rustfava.core.group_entries.TransactionPosting">TransactionPosting</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dict mapping account names to their entries.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/group_entries.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span>
<span class="normal"><a href="#__codelineno-0-96">96</a></span>
<span class="normal"><a href="#__codelineno-0-97">97</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="k">def</span><span class="w"> </span><span class="nf">group_entries_by_account</span><span class="p">(</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Directive</span><span class="p">],</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Directive</span> <span class="o">|</span> <span class="n">TransactionPosting</span><span class="p">]]:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Group entries by account.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        entries: A list of entries.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        A dict mapping account names to their entries.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">res</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">abc</span><span class="o">.</span><span class="n">Directive</span> <span class="o">|</span> <span class="n">TransactionPosting</span><span class="p">]]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="p">)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">Transaction</span><span class="p">):</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>            <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>                <span class="n">res</span><span class="p">[</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TransactionPosting</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">posting</span><span class="p">))</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>            <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="n">get_entry_accounts</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>                <span class="n">res</span><span class="p">[</span><span class="n">account</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.ingest" class="doc doc-heading">
            <code>ingest</code>


<a href="#rustfava.core.ingest" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Ingest helper functions.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.ingest.IngestError" class="doc doc-heading">
            <code>IngestError</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.ingest.IngestError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.BeancountError">BeancountError</span></code></p>



        <p>An error with one of the importers.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="k">class</span><span class="w"> </span><span class="nc">IngestError</span><span class="p">(</span><span class="n">BeancountError</span><span class="p">):</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;An error with one of the importers.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.ingest.ImporterMethodCallError" class="doc doc-heading">
            <code>ImporterMethodCallError</code>


<a href="#rustfava.core.ingest.ImporterMethodCallError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code></p>



        <p>Error calling one of the importer methods.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="k">class</span><span class="w"> </span><span class="nc">ImporterMethodCallError</span><span class="p">(</span><span class="n">RustfavaAPIError</span><span class="p">):</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Error calling one of the importer methods.&quot;&quot;&quot;</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>            <span class="sa">f</span><span class="s2">&quot;Error calling method on importer:</span><span class="se">\n\n</span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.ingest.ImporterInvalidTypeError" class="doc doc-heading">
            <code>ImporterInvalidTypeError</code>


<a href="#rustfava.core.ingest.ImporterInvalidTypeError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code></p>



        <p>One of the importer methods returned an unexpected type.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="k">class</span><span class="w"> </span><span class="nc">ImporterInvalidTypeError</span><span class="p">(</span><span class="n">RustfavaAPIError</span><span class="p">):</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;One of the importer methods returned an unexpected type.&quot;&quot;&quot;</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">expected</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">actual</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>            <span class="sa">f</span><span class="s2">&quot;Got unexpected type from importer as </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">:&quot;</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>            <span class="sa">f</span><span class="s2">&quot; expected </span><span class="si">{</span><span class="n">expected</span><span class="si">!s}</span><span class="s2">, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span><span class="si">!s}</span><span class="s2">:&quot;</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.ingest.ImporterExtractError" class="doc doc-heading">
            <code>ImporterExtractError</code>


<a href="#rustfava.core.ingest.ImporterExtractError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ImporterMethodCallError (rustfava.core.ingest.ImporterMethodCallError)" href="#rustfava.core.ingest.ImporterMethodCallError">ImporterMethodCallError</a></code></p>



        <p>Error calling extract for importer.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="k">class</span><span class="w"> </span><span class="nc">ImporterExtractError</span><span class="p">(</span><span class="n">ImporterMethodCallError</span><span class="p">):</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Error calling extract for importer.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.ingest.MissingImporterConfigError" class="doc doc-heading">
            <code>MissingImporterConfigError</code>


<a href="#rustfava.core.ingest.MissingImporterConfigError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code></p>



        <p>Missing import-config option.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="k">class</span><span class="w"> </span><span class="nc">MissingImporterConfigError</span><span class="p">(</span><span class="n">RustfavaAPIError</span><span class="p">):</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Missing import-config option.&quot;&quot;&quot;</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;Missing import-config option&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.ingest.MissingImporterDirsError" class="doc doc-heading">
            <code>MissingImporterDirsError</code>


<a href="#rustfava.core.ingest.MissingImporterDirsError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code></p>



        <p>You need to set at least one imports-dir.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span>
<span class="normal"><a href="#__codelineno-0-96">96</a></span>
<span class="normal"><a href="#__codelineno-0-97">97</a></span>
<span class="normal"><a href="#__codelineno-0-98">98</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="k">class</span><span class="w"> </span><span class="nc">MissingImporterDirsError</span><span class="p">(</span><span class="n">RustfavaAPIError</span><span class="p">):</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;You need to set at least one imports-dir.&quot;&quot;&quot;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;You need to set at least one imports-dir.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.ingest.ImportConfigLoadError" class="doc doc-heading">
            <code>ImportConfigLoadError</code>


<a href="#rustfava.core.ingest.ImportConfigLoadError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code></p>



        <p>Error on loading the import config.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="k">class</span><span class="w"> </span><span class="nc">ImportConfigLoadError</span><span class="p">(</span><span class="n">RustfavaAPIError</span><span class="p">):</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Error on loading the import config.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.ingest.FileImportInfo" class="doc doc-heading">
            <code>FileImportInfo</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.ingest.FileImportInfo" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>Info about one file/importer combination.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="k">class</span><span class="w"> </span><span class="nc">FileImportInfo</span><span class="p">:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Info about one file/importer combination.&quot;&quot;&quot;</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="n">importer_name</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="n">account</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="n">date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.ingest.FileImporters" class="doc doc-heading">
            <code>FileImporters</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.ingest.FileImporters" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>Importers for a file.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="k">class</span><span class="w"> </span><span class="nc">FileImporters</span><span class="p">:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Importers for a file.&quot;&quot;&quot;</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="n">basename</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="n">importers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FileImportInfo</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.ingest.WrappedImporter" class="doc doc-heading">
            <code>WrappedImporter</code>


<a href="#rustfava.core.ingest.WrappedImporter" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>A wrapper to safely call importer methods.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="k">class</span><span class="w"> </span><span class="nc">WrappedImporter</span><span class="p">:</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A wrapper to safely call importer methods.&quot;&quot;&quot;</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="n">importer</span><span class="p">:</span> <span class="n">BeanImporterProtocol</span> <span class="o">|</span> <span class="n">Importer</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">importer</span><span class="p">:</span> <span class="n">BeanImporterProtocol</span> <span class="o">|</span> <span class="n">Importer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">importer</span> <span class="o">=</span> <span class="n">importer</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="nd">@_catch_any</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of the importer.&quot;&quot;&quot;</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="n">importer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">importer</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="n">name</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="n">importer</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">importer</span><span class="p">,</span> <span class="n">Importer</span><span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>            <span class="k">else</span> <span class="n">importer</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="k">return</span> <span class="n">_assert_type</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="nd">@_catch_any</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">identify</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">WrappedImporter</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the importer is matching the file.&quot;&quot;&quot;</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="n">importer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">importer</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="n">matches</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="n">importer</span><span class="o">.</span><span class="n">identify</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">importer</span><span class="p">,</span> <span class="n">Importer</span><span class="p">)</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="k">else</span> <span class="n">importer</span><span class="o">.</span><span class="n">identify</span><span class="p">(</span><span class="n">get_cached_file</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="p">)</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="k">return</span> <span class="n">_assert_type</span><span class="p">(</span><span class="s2">&quot;identify&quot;</span><span class="p">,</span> <span class="n">matches</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="nd">@_catch_any</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">file_import_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FileImportInfo</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate info about a file with an importer.&quot;&quot;&quot;</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="n">importer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">importer</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">importer</span><span class="p">,</span> <span class="n">Importer</span><span class="p">):</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="n">str_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="n">account</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">account</span><span class="p">(</span><span class="n">str_path</span><span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="n">date</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="n">str_path</span><span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>            <span class="n">filename</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">filename</span><span class="p">(</span><span class="n">str_path</span><span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="n">file</span> <span class="o">=</span> <span class="n">get_cached_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>            <span class="n">account</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">file_account</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>            <span class="n">date</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">file_date</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>            <span class="n">filename</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">file_name</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="k">return</span> <span class="n">FileImportInfo</span><span class="p">(</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="n">_assert_type</span><span class="p">(</span><span class="s2">&quot;account&quot;</span><span class="p">,</span> <span class="n">account</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="n">_assert_type</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">date</span> <span class="ow">or</span> <span class="n">local_today</span><span class="p">(),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">),</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="n">_assert_type</span><span class="p">(</span><span class="s2">&quot;filename&quot;</span><span class="p">,</span> <span class="n">filename</span> <span class="ow">or</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="rustfava.core.ingest.WrappedImporter.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#rustfava.core.ingest.WrappedImporter.name" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Get the name of the importer.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h5 id="rustfava.core.ingest.WrappedImporter.identify" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">identify</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

<a href="#rustfava.core.ingest.WrappedImporter.identify" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Whether the importer is matching the file.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="nd">@_catch_any</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="k">def</span><span class="w"> </span><span class="nf">identify</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">WrappedImporter</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Whether the importer is matching the file.&quot;&quot;&quot;</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">importer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">importer</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">matches</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="n">importer</span><span class="o">.</span><span class="n">identify</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">importer</span><span class="p">,</span> <span class="n">Importer</span><span class="p">)</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="k">else</span> <span class="n">importer</span><span class="o">.</span><span class="n">identify</span><span class="p">(</span><span class="n">get_cached_file</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="p">)</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="k">return</span> <span class="n">_assert_type</span><span class="p">(</span><span class="s2">&quot;identify&quot;</span><span class="p">,</span> <span class="n">matches</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.ingest.WrappedImporter.file_import_info" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">file_import_info</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

<a href="#rustfava.core.ingest.WrappedImporter.file_import_info" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Generate info about a file with an importer.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="nd">@_catch_any</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="k">def</span><span class="w"> </span><span class="nf">file_import_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FileImportInfo</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate info about a file with an importer.&quot;&quot;&quot;</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="n">importer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">importer</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">importer</span><span class="p">,</span> <span class="n">Importer</span><span class="p">):</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">str_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="n">account</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">account</span><span class="p">(</span><span class="n">str_path</span><span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="n">date</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="n">str_path</span><span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="n">filename</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">filename</span><span class="p">(</span><span class="n">str_path</span><span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="n">file</span> <span class="o">=</span> <span class="n">get_cached_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">account</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">file_account</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="n">date</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">file_date</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="n">filename</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">file_name</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="k">return</span> <span class="n">FileImportInfo</span><span class="p">(</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="n">_assert_type</span><span class="p">(</span><span class="s2">&quot;account&quot;</span><span class="p">,</span> <span class="n">account</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="n">_assert_type</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">date</span> <span class="ow">or</span> <span class="n">local_today</span><span class="p">(),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">),</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="n">_assert_type</span><span class="p">(</span><span class="s2">&quot;filename&quot;</span><span class="p">,</span> <span class="n">filename</span> <span class="ow">or</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.ingest.IngestModule" class="doc doc-heading">
            <code>IngestModule</code>


<a href="#rustfava.core.ingest.IngestModule" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FavaModule (rustfava.core.module_base.FavaModule)" href="#rustfava.core.module_base.FavaModule">FavaModule</a></code></p>



        <p>Exposes ingest functionality.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="k">class</span><span class="w"> </span><span class="nc">IngestModule</span><span class="p">(</span><span class="n">FavaModule</span><span class="p">):</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Exposes ingest functionality.&quot;&quot;&quot;</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger</span><span class="p">:</span> <span class="n">RustfavaLedger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ledger</span><span class="p">)</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">importers</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WrappedImporter</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hooks</span><span class="p">:</span> <span class="n">Hooks</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mtime</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">IngestError</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">module_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The path to the importer configuration.&quot;&quot;&quot;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="n">config_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">import_config</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">config_path</span><span class="p">:</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="n">IngestError</span><span class="p">(</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>                <span class="p">{</span><span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module_path</span><span class="p">),</span> <span class="s2">&quot;lineno&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>                <span class="n">msg</span><span class="p">,</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>                <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="p">),</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="p">)</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="n">module_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">module_path</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="k">if</span> <span class="n">module_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>            <span class="k">return</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">module_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_error</span><span class="p">(</span><span class="s2">&quot;Import config does not exist&quot;</span><span class="p">)</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>            <span class="k">return</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="n">new_mtime</span> <span class="o">=</span> <span class="n">module_path</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime_ns</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="k">if</span> <span class="n">new_mtime</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">mtime</span><span class="p">:</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>            <span class="k">return</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">importers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hooks</span> <span class="o">=</span> <span class="n">load_import_config</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mtime</span> <span class="o">=</span> <span class="n">new_mtime</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="k">except</span> <span class="n">RustfavaAPIError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error in import config &#39;</span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">error</span><span class="si">!s}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">import_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">FileImporters</span><span class="p">]:</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Identify files and importers that can be imported.</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">            A list of :class:`.FileImportInfo`.</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">importers</span><span class="p">:</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>            <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="n">importers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">importers</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>        <span class="n">ret</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FileImporters</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">import_dirs</span><span class="p">:</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>            <span class="n">full_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>            <span class="n">ret</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">find_imports</span><span class="p">(</span><span class="n">importers</span><span class="p">,</span> <span class="n">full_path</span><span class="p">))</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>        <span class="k">return</span> <span class="n">ret</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">importer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Directive</span><span class="p">]:</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract entries from filename with the specified importer.</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">            filename: The full path to a file.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">            importer_name: The name of an importer that matched the file.</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">            A list of new imported entries.</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">module_path</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>            <span class="k">raise</span> <span class="n">MissingImporterConfigError</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>        <span class="c1"># reload (if changed)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>            <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>            <span class="n">importer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">importers</span><span class="p">[</span><span class="n">importer_name</span><span class="p">]</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>            <span class="n">new_entries</span> <span class="o">=</span> <span class="n">extract_from_file</span><span class="p">(</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>                <span class="n">importer</span><span class="p">,</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>                <span class="n">path</span><span class="p">,</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>                <span class="n">existing_entries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries</span><span class="p">,</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>            <span class="p">)</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>            <span class="k">raise</span> <span class="n">ImporterExtractError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="k">for</span> <span class="n">hook_fn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hooks</span><span class="p">:</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>            <span class="n">annotations</span> <span class="o">=</span> <span class="n">get_annotations</span><span class="p">(</span><span class="n">hook_fn</span><span class="p">)</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="s2">&quot;Importer&quot;</span> <span class="ow">in</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">annotations</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>                <span class="n">importer_info</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">file_import_info</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>                <span class="n">new_entries_list</span><span class="p">:</span> <span class="n">HookOutput</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>                    <span class="p">(</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>                        <span class="n">filename</span><span class="p">,</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>                        <span class="n">new_entries</span><span class="p">,</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>                        <span class="n">importer_info</span><span class="o">.</span><span class="n">account</span><span class="p">,</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>                        <span class="n">importer</span><span class="o">.</span><span class="n">importer</span><span class="p">,</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>                    <span class="p">)</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>                <span class="p">]</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>                <span class="n">new_entries_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">filename</span><span class="p">,</span> <span class="n">new_entries</span><span class="p">)]</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>            <span class="n">new_entries_list</span> <span class="o">=</span> <span class="n">hook_fn</span><span class="p">(</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>                <span class="n">new_entries_list</span><span class="p">,</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries</span><span class="p">,</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>            <span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>            <span class="n">new_entries</span> <span class="o">=</span> <span class="n">new_entries_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="k">return</span> <span class="n">new_entries</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="rustfava.core.ingest.IngestModule.module_path" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">module_path</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#rustfava.core.ingest.IngestModule.module_path" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>The path to the importer configuration.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h5 id="rustfava.core.ingest.IngestModule.import_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">import_data</span><span class="p">()</span></code>

<a href="#rustfava.core.ingest.IngestModule.import_data" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Identify files and importers that can be imported.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="FileImporters


  
      dataclass
   (rustfava.core.ingest.FileImporters)" href="#rustfava.core.ingest.FileImporters">FileImporters</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of :class:<code>.FileImportInfo</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="k">def</span><span class="w"> </span><span class="nf">import_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">FileImporters</span><span class="p">]:</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Identify files and importers that can be imported.</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">        A list of :class:`.FileImportInfo`.</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">importers</span><span class="p">:</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>        <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="n">importers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">importers</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>    <span class="n">ret</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FileImporters</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">import_dirs</span><span class="p">:</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="n">full_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="n">ret</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">find_imports</span><span class="p">(</span><span class="n">importers</span><span class="p">,</span> <span class="n">full_path</span><span class="p">))</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.ingest.IngestModule.extract" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">importer_name</span><span class="p">)</span></code>

<a href="#rustfava.core.ingest.IngestModule.extract" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Extract entries from filename with the specified importer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The full path to a file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>importer_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of an importer that matched the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="rustfava.beans.abc.Directive">Directive</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of new imported entries.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="k">def</span><span class="w"> </span><span class="nf">extract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">importer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Directive</span><span class="p">]:</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract entries from filename with the specified importer.</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">        filename: The full path to a file.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">        importer_name: The name of an importer that matched the file.</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">        A list of new imported entries.</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">module_path</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>        <span class="k">raise</span> <span class="n">MissingImporterConfigError</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="c1"># reload (if changed)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">load_file</span><span class="p">()</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="n">importer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">importers</span><span class="p">[</span><span class="n">importer_name</span><span class="p">]</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="n">new_entries</span> <span class="o">=</span> <span class="n">extract_from_file</span><span class="p">(</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>            <span class="n">importer</span><span class="p">,</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>            <span class="n">path</span><span class="p">,</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>            <span class="n">existing_entries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries</span><span class="p">,</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>        <span class="p">)</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="k">raise</span> <span class="n">ImporterExtractError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="k">for</span> <span class="n">hook_fn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hooks</span><span class="p">:</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="n">annotations</span> <span class="o">=</span> <span class="n">get_annotations</span><span class="p">(</span><span class="n">hook_fn</span><span class="p">)</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="s2">&quot;Importer&quot;</span> <span class="ow">in</span> <span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">annotations</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>            <span class="n">importer_info</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">file_import_info</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>            <span class="n">new_entries_list</span><span class="p">:</span> <span class="n">HookOutput</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>                <span class="p">(</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>                    <span class="n">filename</span><span class="p">,</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>                    <span class="n">new_entries</span><span class="p">,</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>                    <span class="n">importer_info</span><span class="o">.</span><span class="n">account</span><span class="p">,</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>                    <span class="n">importer</span><span class="o">.</span><span class="n">importer</span><span class="p">,</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>                <span class="p">)</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>            <span class="p">]</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>            <span class="n">new_entries_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">filename</span><span class="p">,</span> <span class="n">new_entries</span><span class="p">)]</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="n">new_entries_list</span> <span class="o">=</span> <span class="n">hook_fn</span><span class="p">(</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>            <span class="n">new_entries_list</span><span class="p">,</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries</span><span class="p">,</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">new_entries</span> <span class="o">=</span> <span class="n">new_entries_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>    <span class="k">return</span> <span class="n">new_entries</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="rustfava.core.ingest.walk_dir" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">walk_dir</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span></code>

<a href="#rustfava.core.ingest.walk_dir" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Walk through all files in dir.</p>
<p>Ignores common dot-directories like .git, .cache. .venv, see IGNORE_DIRS.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory to start in.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>All full paths under directory, ignoring some directories.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="k">def</span><span class="w"> </span><span class="nf">walk_dir</span><span class="p">(</span><span class="n">directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Path</span><span class="p">]:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Walk through all files in dir.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    Ignores common dot-directories like .git, .cache. .venv, see IGNORE_DIRS.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        directory: The directory to start in.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        All full paths under directory, ignoring some directories.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="n">dirs</span><span class="p">[:]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span> <span class="k">if</span> <span class="n">d</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">IGNORE_DIRS</span><span class="p">)</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">root_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">filenames</span><span class="p">):</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="k">yield</span> <span class="n">root_path</span> <span class="o">/</span> <span class="n">filename</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.ingest.get_cached_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_cached_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

<a href="#rustfava.core.ingest.get_cached_file" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get a cached FileMemo.</p>
<p>This checks the file's mtime before getting it from the Cache.
In addition to using the beangulp cache.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_cached_file</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FileMemo</span><span class="p">:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a cached FileMemo.</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    This checks the file&#39;s mtime before getting it from the Cache.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    In addition to using the beangulp cache.</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">mtime</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime_ns</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">filename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="n">cached</span> <span class="o">=</span> <span class="n">_CACHE</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="k">if</span> <span class="n">cached</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="n">mtime_cached</span><span class="p">,</span> <span class="n">memo_cached</span> <span class="o">=</span> <span class="n">cached</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="k">if</span> <span class="n">mtime</span> <span class="o">&lt;=</span> <span class="n">mtime_cached</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="k">return</span> <span class="n">memo_cached</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="n">memo</span><span class="p">:</span> <span class="n">FileMemo</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">_FileMemo</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>  <span class="c1"># noqa: SLF001</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="n">cache</span><span class="o">.</span><span class="n">_CACHE</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="n">memo</span>  <span class="c1"># noqa: SLF001</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="n">_CACHE</span><span class="p">[</span><span class="n">path</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">mtime</span><span class="p">,</span> <span class="n">memo</span><span class="p">)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="k">return</span> <span class="n">memo</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.ingest.find_imports" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_imports</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">directory</span><span class="p">)</span></code>

<a href="#rustfava.core.ingest.find_imports" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Pair files and matching importers.</p>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="FileImporters


  
      dataclass
   (rustfava.core.ingest.FileImporters)" href="#rustfava.core.ingest.FileImporters">FileImporters</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For each file in directory, a pair of its filename and the matching</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="FileImporters


  
      dataclass
   (rustfava.core.ingest.FileImporters)" href="#rustfava.core.ingest.FileImporters">FileImporters</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>importers.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="k">def</span><span class="w"> </span><span class="nf">find_imports</span><span class="p">(</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">WrappedImporter</span><span class="p">],</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Path</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">FileImporters</span><span class="p">]:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Pair files and matching importers.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        For each file in directory, a pair of its filename and the matching</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        importers.</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">walk_dir</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">stat</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="k">if</span> <span class="n">stat</span><span class="o">.</span><span class="n">st_size</span> <span class="o">&gt;</span> <span class="n">_FILE_TOO_LARGE_THRESHOLD</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="k">continue</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">importers</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="n">importer</span><span class="o">.</span><span class="n">file_import_info</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="k">for</span> <span class="n">importer</span> <span class="ow">in</span> <span class="n">config</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>            <span class="k">if</span> <span class="n">importer</span><span class="o">.</span><span class="n">identify</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="p">]</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="k">yield</span> <span class="n">FileImporters</span><span class="p">(</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>            <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">basename</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">importers</span><span class="o">=</span><span class="n">importers</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.ingest.extract_from_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_from_file</span><span class="p">(</span><span class="n">wrapped_importer</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">existing_entries</span><span class="p">)</span></code>

<a href="#rustfava.core.ingest.extract_from_file" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Import entries from a document.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>wrapped_importer</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="WrappedImporter (rustfava.core.ingest.WrappedImporter)" href="#rustfava.core.ingest.WrappedImporter">WrappedImporter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The importer instance to handle the document.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filesystem path to the document.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>existing_entries</code>
            </td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="rustfava.beans.abc.Directive">Directive</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Existing entries.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="rustfava.beans.abc.Directive">Directive</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of imported entries.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="k">def</span><span class="w"> </span><span class="nf">extract_from_file</span><span class="p">(</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="n">wrapped_importer</span><span class="p">:</span> <span class="n">WrappedImporter</span><span class="p">,</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="n">existing_entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">],</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Directive</span><span class="p">]:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Import entries from a document.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">      wrapped_importer: The importer instance to handle the document.</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">      path: Filesystem path to the document.</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">      existing_entries: Existing entries.</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">      The list of imported entries.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="n">filename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="n">importer</span> <span class="o">=</span> <span class="n">wrapped_importer</span><span class="o">.</span><span class="n">importer</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">importer</span><span class="p">,</span> <span class="n">Importer</span><span class="p">):</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="n">entries</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">existing</span><span class="o">=</span><span class="n">existing_entries</span><span class="p">)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="n">file</span> <span class="o">=</span> <span class="n">get_cached_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="n">entries</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>            <span class="n">importer</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">existing_entries</span><span class="o">=</span><span class="n">existing_entries</span><span class="p">)</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>            <span class="k">if</span> <span class="s2">&quot;existing_entries&quot;</span> <span class="ow">in</span> <span class="n">signature</span><span class="p">(</span><span class="n">importer</span><span class="o">.</span><span class="n">extract</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="k">else</span> <span class="n">importer</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="p">)</span> <span class="ow">or</span> <span class="p">[]</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">importer</span><span class="p">,</span> <span class="s2">&quot;sort&quot;</span><span class="p">):</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="n">importer</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="n">entries</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">_incomplete_sortkey</span><span class="p">)</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">importer</span><span class="p">,</span> <span class="n">Importer</span><span class="p">):</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="n">importer</span><span class="o">.</span><span class="n">deduplicate</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">existing</span><span class="o">=</span><span class="n">existing_entries</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="k">return</span> <span class="n">entries</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.ingest.load_import_config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_import_config</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span></code>

<a href="#rustfava.core.ingest.load_import_config" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Load the given import config and extract importers and hooks.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>module_path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the import config.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="collections.abc.Mapping">Mapping</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="WrappedImporter (rustfava.core.ingest.WrappedImporter)" href="#rustfava.core.ingest.WrappedImporter">WrappedImporter</a>], <span title="rustfava.core.ingest.Hooks">Hooks</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A pair of the importers (by name) and the list of hooks.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_import_config</span><span class="p">(</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="n">module_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WrappedImporter</span><span class="p">],</span> <span class="n">Hooks</span><span class="p">]:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the given import config and extract importers and hooks.</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">        module_path: Path to the import config.</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        A pair of the importers (by name) and the list of hooks.</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="n">mod</span> <span class="o">=</span> <span class="n">run_path</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">module_path</span><span class="p">))</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="n">message</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="k">raise</span> <span class="n">ImportConfigLoadError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">error</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="k">if</span> <span class="s2">&quot;CONFIG&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mod</span><span class="p">:</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;CONFIG is missing&quot;</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="k">raise</span> <span class="n">ImportConfigLoadError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mod</span><span class="p">[</span><span class="s2">&quot;CONFIG&quot;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;CONFIG is not a list&quot;</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="k">raise</span> <span class="n">ImportConfigLoadError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="n">config</span> <span class="o">=</span> <span class="n">mod</span><span class="p">[</span><span class="s2">&quot;CONFIG&quot;</span><span class="p">]</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="n">hooks</span> <span class="o">=</span> <span class="n">DEFAULT_HOOKS</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="k">if</span> <span class="s2">&quot;HOOKS&quot;</span> <span class="ow">in</span> <span class="n">mod</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="n">hooks</span> <span class="o">=</span> <span class="n">mod</span><span class="p">[</span><span class="s2">&quot;HOOKS&quot;</span><span class="p">]</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hooks</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>            <span class="nb">callable</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">hooks</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="p">):</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;HOOKS is not a list of callables&quot;</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>            <span class="k">raise</span> <span class="n">ImportConfigLoadError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="n">importers</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="k">for</span> <span class="n">importer</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>            <span class="n">importer</span><span class="p">,</span> <span class="p">(</span><span class="n">BeanImporterProtocol</span><span class="p">,</span> <span class="n">Importer</span><span class="p">)</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="p">):</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">importer</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>                <span class="sa">f</span><span class="s2">&quot;Importer class &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; in &#39;</span><span class="si">{</span><span class="n">module_path</span><span class="si">}</span><span class="s2">&#39; does &quot;</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>                <span class="s2">&quot;not satisfy importer protocol&quot;</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>            <span class="p">)</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>            <span class="k">raise</span> <span class="n">ImportConfigLoadError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="n">wrapped_importer</span> <span class="o">=</span> <span class="n">WrappedImporter</span><span class="p">(</span><span class="n">importer</span><span class="p">)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="k">if</span> <span class="n">wrapped_importer</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">importers</span><span class="p">:</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Duplicate importer name found: </span><span class="si">{</span><span class="n">wrapped_importer</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="k">raise</span> <span class="n">ImportConfigLoadError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="n">importers</span><span class="p">[</span><span class="n">wrapped_importer</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">wrapped_importer</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>    <span class="k">return</span> <span class="n">importers</span><span class="p">,</span> <span class="n">hooks</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.ingest.filepath_in_primary_imports_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filepath_in_primary_imports_folder</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ledger</span><span class="p">)</span></code>

<a href="#rustfava.core.ingest.filepath_in_primary_imports_folder" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>File path for a document to upload to the primary import folder.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filename of the document.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ledger</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="RustfavaLedger (rustfava.core.RustfavaLedger)" href="#rustfava.core.RustfavaLedger">RustfavaLedger</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The RustfavaLedger.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path that the document should be saved at.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/ingest.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="k">def</span><span class="w"> </span><span class="nf">filepath_in_primary_imports_folder</span><span class="p">(</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>    <span class="n">ledger</span><span class="p">:</span> <span class="n">RustfavaLedger</span><span class="p">,</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;File path for a document to upload to the primary import folder.</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">        filename: The filename of the document.</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">        ledger: The RustfavaLedger.</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">        The path that the document should be saved at.</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>    <span class="n">primary_imports_folder</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">import_dirs</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>    <span class="k">if</span> <span class="n">primary_imports_folder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>        <span class="k">raise</span> <span class="n">MissingImporterDirsError</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>    <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="k">if</span> <span class="n">altsep</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">altsep</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>    <span class="k">return</span> <span class="n">ledger</span><span class="o">.</span><span class="n">join_path</span><span class="p">(</span><span class="n">primary_imports_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.inventory" class="doc doc-heading">
            <code>inventory</code>


<a href="#rustfava.core.inventory" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Alternative implementation of Beancount's Inventory.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.inventory.SimpleCounterInventory" class="doc doc-heading">
            <code>SimpleCounterInventory</code>


<a href="#rustfava.core.inventory.SimpleCounterInventory" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="decimal.Decimal">Decimal</span>]</code></p>



        <p>A simple inventory mapping just strings to numbers.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/inventory.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="k">class</span><span class="w"> </span><span class="nc">SimpleCounterInventory</span><span class="p">(</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">]):</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A simple inventory mapping just strings to numbers.&quot;&quot;&quot;</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the inventory is empty.&quot;&quot;&quot;</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="k">return</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a number to key.&quot;&quot;&quot;</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="n">new_num</span> <span class="o">=</span> <span class="n">number</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ZERO</span><span class="p">)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="k">if</span> <span class="n">new_num</span> <span class="o">==</span> <span class="n">ZERO</span><span class="p">:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>            <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_num</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SimpleCounterInventory</span><span class="p">:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="k">return</span> <span class="n">SimpleCounterInventory</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="o">-</span><span class="n">num</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reduce</span><span class="p">(</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">reducer</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="n">Concatenate</span><span class="p">[</span><span class="n">Position</span><span class="p">,</span> <span class="n">P</span><span class="p">],</span> <span class="n">Amount</span><span class="p">],</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">args</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="o">**</span><span class="n">_kwargs</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SimpleCounterInventory</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Reduce inventory.&quot;&quot;&quot;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">counter</span> <span class="o">=</span> <span class="n">SimpleCounterInventory</span><span class="p">()</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="k">for</span> <span class="n">currency</span><span class="p">,</span> <span class="n">number</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>            <span class="n">pos</span> <span class="o">=</span> <span class="n">_Position</span><span class="p">(</span><span class="n">_Amount</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>            <span class="n">amount</span> <span class="o">=</span> <span class="n">reducer</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>  <span class="c1"># type: ignore[call-arg]</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>            <span class="n">counter</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">amount</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">amount</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="k">return</span> <span class="n">counter</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.inventory.SimpleCounterInventory.is_empty" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_empty</span><span class="p">()</span></code>

<a href="#rustfava.core.inventory.SimpleCounterInventory.is_empty" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Check if the inventory is empty.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/inventory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the inventory is empty.&quot;&quot;&quot;</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="k">return</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.inventory.SimpleCounterInventory.add" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span></code>

<a href="#rustfava.core.inventory.SimpleCounterInventory.add" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Add a number to key.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/inventory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a number to key.&quot;&quot;&quot;</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">new_num</span> <span class="o">=</span> <span class="n">number</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ZERO</span><span class="p">)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">if</span> <span class="n">new_num</span> <span class="o">==</span> <span class="n">ZERO</span><span class="p">:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_num</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.inventory.SimpleCounterInventory.reduce" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reduce</span><span class="p">(</span><span class="n">reducer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kwargs</span><span class="p">)</span></code>

<a href="#rustfava.core.inventory.SimpleCounterInventory.reduce" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Reduce inventory.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/inventory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="k">def</span><span class="w"> </span><span class="nf">reduce</span><span class="p">(</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">reducer</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="n">Concatenate</span><span class="p">[</span><span class="n">Position</span><span class="p">,</span> <span class="n">P</span><span class="p">],</span> <span class="n">Amount</span><span class="p">],</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">args</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="o">**</span><span class="n">_kwargs</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SimpleCounterInventory</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reduce inventory.&quot;&quot;&quot;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">counter</span> <span class="o">=</span> <span class="n">SimpleCounterInventory</span><span class="p">()</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="k">for</span> <span class="n">currency</span><span class="p">,</span> <span class="n">number</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">pos</span> <span class="o">=</span> <span class="n">_Position</span><span class="p">(</span><span class="n">_Amount</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">amount</span> <span class="o">=</span> <span class="n">reducer</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>  <span class="c1"># type: ignore[call-arg]</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="n">counter</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">amount</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">amount</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="k">return</span> <span class="n">counter</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.inventory.CounterInventory" class="doc doc-heading">
            <code>CounterInventory</code>


<a href="#rustfava.core.inventory.CounterInventory" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="dict">dict</span>[<span title="rustfava.core.inventory.InventoryKey">InventoryKey</span>, <span title="decimal.Decimal">Decimal</span>]</code></p>



        <p>A lightweight inventory.</p>
<p>This is intended as a faster alternative to Beancount's Inventory class.
Due to not using a list, for inventories with a lot of different positions,
inserting is much faster.</p>
<p>The keys should be tuples <code>(currency, cost)</code>.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/inventory.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="k">class</span><span class="w"> </span><span class="nc">CounterInventory</span><span class="p">(</span><span class="nb">dict</span><span class="p">[</span><span class="n">InventoryKey</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">]):</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A lightweight inventory.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    This is intended as a faster alternative to Beancount&#39;s Inventory class.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    Due to not using a list, for inventories with a lot of different positions,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    inserting is much faster.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    The keys should be tuples ``(currency, cost)``.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the inventory is empty.&quot;&quot;&quot;</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="k">return</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InventoryKey</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a number to key.&quot;&quot;&quot;</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="n">new_num</span> <span class="o">=</span> <span class="n">number</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ZERO</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="k">if</span> <span class="n">new_num</span> <span class="o">==</span> <span class="n">ZERO</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_num</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">InventoryKey</span><span class="p">]:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_strings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Print as a list of strings (e.g. for snapshot tests).&quot;&quot;&quot;</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="n">strings</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="k">for</span> <span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="n">cost</span><span class="p">),</span> <span class="n">number</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="k">if</span> <span class="n">cost</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>                <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">number</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">currency</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>                <span class="n">cost_str</span> <span class="o">=</span> <span class="n">cost_to_string</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>                <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">number</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">currency</span><span class="si">}</span><span class="s2"> </span><span class="se">{{</span><span class="si">{</span><span class="n">cost_str</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="k">return</span> <span class="n">strings</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reduce</span><span class="p">(</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="n">reducer</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="n">Concatenate</span><span class="p">[</span><span class="n">Position</span><span class="p">,</span> <span class="n">P</span><span class="p">],</span> <span class="n">Amount</span><span class="p">],</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">args</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="o">**</span><span class="n">_kwargs</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SimpleCounterInventory</span><span class="p">:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Reduce inventory.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        Note that this returns a simple :class:`CounterInventory` with just</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        currencies as keys.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">counter</span> <span class="o">=</span> <span class="n">SimpleCounterInventory</span><span class="p">()</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="k">for</span> <span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="n">cost</span><span class="p">),</span> <span class="n">number</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="n">pos</span> <span class="o">=</span> <span class="n">_Position</span><span class="p">(</span><span class="n">_Amount</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">),</span> <span class="n">cost</span><span class="p">)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="n">amount</span> <span class="o">=</span> <span class="n">reducer</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>  <span class="c1"># type: ignore[call-arg]</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="n">counter</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">amount</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">amount</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="k">return</span> <span class="n">counter</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_amount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="n">Amount</span><span class="p">,</span> <span class="n">cost</span><span class="p">:</span> <span class="n">Cost</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add an Amount to the inventory.&quot;&quot;&quot;</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">amount</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">cost</span><span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">amount</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">Position</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a Position or Posting to the inventory.&quot;&quot;&quot;</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="c1"># Skip positions with missing units (can happen with parse errors)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="k">if</span> <span class="n">pos</span><span class="o">.</span><span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>            <span class="k">return</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_amount</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">cost</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CounterInventory</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="k">return</span> <span class="n">CounterInventory</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="o">-</span><span class="n">num</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">CounterInventory</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CounterInventory</span><span class="p">:</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="n">counter</span> <span class="o">=</span> <span class="n">CounterInventory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="n">counter</span><span class="o">.</span><span class="n">add_inventory</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="k">return</span> <span class="n">counter</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">counter</span><span class="p">:</span> <span class="n">CounterInventory</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add another :class:`CounterInventory`.&quot;&quot;&quot;</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="n">self_get</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">counter</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>                <span class="n">new_num</span> <span class="o">=</span> <span class="n">num</span> <span class="o">+</span> <span class="n">self_get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ZERO</span><span class="p">)</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>                <span class="k">if</span> <span class="n">new_num</span> <span class="o">==</span> <span class="n">ZERO</span><span class="p">:</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                    <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_num</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.inventory.CounterInventory.is_empty" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_empty</span><span class="p">()</span></code>

<a href="#rustfava.core.inventory.CounterInventory.is_empty" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Check if the inventory is empty.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/inventory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the inventory is empty.&quot;&quot;&quot;</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="k">return</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.inventory.CounterInventory.add" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span></code>

<a href="#rustfava.core.inventory.CounterInventory.add" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Add a number to key.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/inventory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">InventoryKey</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a number to key.&quot;&quot;&quot;</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="n">new_num</span> <span class="o">=</span> <span class="n">number</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ZERO</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="k">if</span> <span class="n">new_num</span> <span class="o">==</span> <span class="n">ZERO</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_num</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.inventory.CounterInventory.to_strings" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_strings</span><span class="p">()</span></code>

<a href="#rustfava.core.inventory.CounterInventory.to_strings" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Print as a list of strings (e.g. for snapshot tests).</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/inventory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_strings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Print as a list of strings (e.g. for snapshot tests).&quot;&quot;&quot;</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="n">strings</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="k">for</span> <span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="n">cost</span><span class="p">),</span> <span class="n">number</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="k">if</span> <span class="n">cost</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">number</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">currency</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>            <span class="n">cost_str</span> <span class="o">=</span> <span class="n">cost_to_string</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">number</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">currency</span><span class="si">}</span><span class="s2"> </span><span class="se">{{</span><span class="si">{</span><span class="n">cost_str</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="k">return</span> <span class="n">strings</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.inventory.CounterInventory.reduce" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reduce</span><span class="p">(</span><span class="n">reducer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">_kwargs</span><span class="p">)</span></code>

<a href="#rustfava.core.inventory.CounterInventory.reduce" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Reduce inventory.</p>
<p>Note that this returns a simple :class:<code>CounterInventory</code> with just
currencies as keys.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/inventory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="k">def</span><span class="w"> </span><span class="nf">reduce</span><span class="p">(</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">reducer</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="n">Concatenate</span><span class="p">[</span><span class="n">Position</span><span class="p">,</span> <span class="n">P</span><span class="p">],</span> <span class="n">Amount</span><span class="p">],</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">args</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="o">**</span><span class="n">_kwargs</span><span class="p">:</span> <span class="n">P</span><span class="o">.</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SimpleCounterInventory</span><span class="p">:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reduce inventory.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    Note that this returns a simple :class:`CounterInventory` with just</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    currencies as keys.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">counter</span> <span class="o">=</span> <span class="n">SimpleCounterInventory</span><span class="p">()</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="k">for</span> <span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="n">cost</span><span class="p">),</span> <span class="n">number</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">pos</span> <span class="o">=</span> <span class="n">_Position</span><span class="p">(</span><span class="n">_Amount</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">),</span> <span class="n">cost</span><span class="p">)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">amount</span> <span class="o">=</span> <span class="n">reducer</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>  <span class="c1"># type: ignore[call-arg]</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="n">counter</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">amount</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">amount</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="k">return</span> <span class="n">counter</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.inventory.CounterInventory.add_amount" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_amount</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">cost</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#rustfava.core.inventory.CounterInventory.add_amount" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Add an Amount to the inventory.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/inventory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_amount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="n">Amount</span><span class="p">,</span> <span class="n">cost</span><span class="p">:</span> <span class="n">Cost</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add an Amount to the inventory.&quot;&quot;&quot;</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">amount</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">cost</span><span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">amount</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.inventory.CounterInventory.add_position" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_position</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></code>

<a href="#rustfava.core.inventory.CounterInventory.add_position" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Add a Position or Posting to the inventory.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/inventory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">Position</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a Position or Posting to the inventory.&quot;&quot;&quot;</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="c1"># Skip positions with missing units (can happen with parse errors)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="k">if</span> <span class="n">pos</span><span class="o">.</span><span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">return</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">add_amount</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">cost</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.inventory.CounterInventory.add_inventory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_inventory</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span></code>

<a href="#rustfava.core.inventory.CounterInventory.add_inventory" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Add another :class:<code>CounterInventory</code>.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/inventory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="k">def</span><span class="w"> </span><span class="nf">add_inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">counter</span><span class="p">:</span> <span class="n">CounterInventory</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Add another :class:`CounterInventory`.&quot;&quot;&quot;</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">self_get</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">counter</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="n">new_num</span> <span class="o">=</span> <span class="n">num</span> <span class="o">+</span> <span class="n">self_get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ZERO</span><span class="p">)</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="k">if</span> <span class="n">new_num</span> <span class="o">==</span> <span class="n">ZERO</span><span class="p">:</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_num</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.misc" class="doc doc-heading">
            <code>misc</code>


<a href="#rustfava.core.misc" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Some miscellaneous reports.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.misc.FavaError" class="doc doc-heading">
            <code>FavaError</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.misc.FavaError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.BeancountError">BeancountError</span></code></p>



        <p>Generic Fava-specific error.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/misc.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="k">class</span><span class="w"> </span><span class="nc">FavaError</span><span class="p">(</span><span class="n">BeancountError</span><span class="p">):</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generic Fava-specific error.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.misc.FavaMisc" class="doc doc-heading">
            <code>FavaMisc</code>


<a href="#rustfava.core.misc.FavaMisc" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FavaModule (rustfava.core.module_base.FavaModule)" href="#rustfava.core.module_base.FavaModule">FavaModule</a></code></p>



        <p>Provides access to some miscellaneous reports.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/misc.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="k">class</span><span class="w"> </span><span class="nc">FavaMisc</span><span class="p">(</span><span class="n">FavaModule</span><span class="p">):</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Provides access to some miscellaneous reports.&quot;&quot;&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger</span><span class="p">:</span> <span class="n">RustfavaLedger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ledger</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="c1">#: User-chosen links to show in the sidebar.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sidebar_links</span><span class="p">:</span> <span class="n">SidebarLinks</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="c1">#: Upcoming events in the next few days.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upcoming_events</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Event</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="n">custom_entries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Custom</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sidebar_links</span> <span class="o">=</span> <span class="n">sidebar_links</span><span class="p">(</span><span class="n">custom_entries</span><span class="p">)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upcoming_events</span> <span class="o">=</span> <span class="n">upcoming_events</span><span class="p">(</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Event</span><span class="p">,</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">upcoming_events</span><span class="p">,</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">FavaError</span><span class="p">]:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;An error if no operating currency is set.&quot;&quot;&quot;</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>            <span class="p">[]</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;operating_currency&quot;</span><span class="p">]</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>            <span class="k">else</span> <span class="p">[</span><span class="n">NO_OPERATING_CURRENCY_ERROR</span><span class="p">]</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="rustfava.core.misc.FavaMisc.errors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">errors</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#rustfava.core.misc.FavaMisc.errors" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>An error if no operating currency is set.</p>

    </div>

</div>






  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="rustfava.core.misc.sidebar_links" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sidebar_links</span><span class="p">(</span><span class="n">custom_entries</span><span class="p">)</span></code>

<a href="#rustfava.core.misc.sidebar_links" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Parse custom entries for links.</p>
<p>They have the following format:</p>
<p>2016-04-01 custom "fava-sidebar-link" "2014" "/income_statement/?time=2014"</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="k">def</span><span class="w"> </span><span class="nf">sidebar_links</span><span class="p">(</span><span class="n">custom_entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Custom</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">SidebarLinks</span><span class="p">:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse custom entries for links.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    They have the following format:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    2016-04-01 custom &quot;fava-sidebar-link&quot; &quot;2014&quot; &quot;/income_statement/?time=2014&quot;</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">sidebar_link_entries</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">entry</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">custom_entries</span> <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;fava-sidebar-link&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="p">]</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">sidebar_link_entries</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.misc.upcoming_events" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">upcoming_events</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">max_delta</span><span class="p">)</span></code>

<a href="#rustfava.core.misc.upcoming_events" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Parse entries for upcoming events.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>events</code>
            </td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="rustfava.beans.abc.Event">Event</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of events.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_delta</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of days that should be considered.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="rustfava.beans.abc.Event">Event</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of the Events in entries that are less than <code>max_delta</code> days</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="rustfava.beans.abc.Event">Event</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>away.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span>
<span class="normal"><a href="#__codelineno-0-96">96</a></span>
<span class="normal"><a href="#__codelineno-0-97">97</a></span>
<span class="normal"><a href="#__codelineno-0-98">98</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="k">def</span><span class="w"> </span><span class="nf">upcoming_events</span><span class="p">(</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">events</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Event</span><span class="p">],</span> <span class="n">max_delta</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Event</span><span class="p">]:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse entries for upcoming events.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        events: A list of events.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        max_delta: Number of days that should be considered.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        A list of the Events in entries that are less than `max_delta` days</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        away.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">today</span> <span class="o">=</span> <span class="n">local_today</span><span class="p">()</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">upcoming</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="n">delta</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">date</span> <span class="o">-</span> <span class="n">today</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="k">if</span> <span class="n">delta</span><span class="o">.</span><span class="n">days</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">delta</span><span class="o">.</span><span class="n">days</span> <span class="o">&lt;</span> <span class="n">max_delta</span><span class="p">:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>            <span class="n">upcoming</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="k">return</span> <span class="n">upcoming</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="rustfava.core.misc.align" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">align</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">currency_column</span><span class="p">)</span></code>

<a href="#rustfava.core.misc.align" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Align currencies in one column.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/beans/str.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="k">def</span><span class="w"> </span><span class="nf">align</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">currency_column</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Align currencies in one column.&quot;&quot;&quot;</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">output</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>        <span class="n">match</span> <span class="o">=</span> <span class="n">ALIGN_RE</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>            <span class="n">prefix</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">rest</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>            <span class="n">num_of_spaces</span> <span class="o">=</span> <span class="n">currency_column</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">number</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>            <span class="n">spaces</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">num_of_spaces</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>            <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="n">spaces</span> <span class="o">+</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">number</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">rest</span><span class="p">)</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>            <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.module_base" class="doc doc-heading">
            <code>module_base</code>


<a href="#rustfava.core.module_base" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Base class for the "modules" of rustfavaLedger.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.module_base.FavaModule" class="doc doc-heading">
            <code>FavaModule</code>


<a href="#rustfava.core.module_base.FavaModule" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>Base class for the "modules" of rustfavaLedger.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/module_base.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="k">class</span><span class="w"> </span><span class="nc">FavaModule</span><span class="p">:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for the &quot;modules&quot; of rustfavaLedger.&quot;&quot;&quot;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger</span><span class="p">:</span> <span class="n">RustfavaLedger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span> <span class="o">=</span> <span class="n">ledger</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run when the file has been (re)loaded.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.module_base.FavaModule.load_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_file</span><span class="p">()</span></code>

<a href="#rustfava.core.module_base.FavaModule.load_file" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Run when the file has been (re)loaded.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/module_base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run when the file has been (re)loaded.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.number" class="doc doc-heading">
            <code>number</code>


<a href="#rustfava.core.number" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Formatting numbers.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.number.DecimalFormatModule" class="doc doc-heading">
            <code>DecimalFormatModule</code>


<a href="#rustfava.core.number.DecimalFormatModule" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FavaModule (rustfava.core.module_base.FavaModule)" href="#rustfava.core.module_base.FavaModule">FavaModule</a></code></p>



        <p>Formatting numbers.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/number.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="k">class</span><span class="w"> </span><span class="nc">DecimalFormatModule</span><span class="p">(</span><span class="n">FavaModule</span><span class="p">):</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Formatting numbers.&quot;&quot;&quot;</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger</span><span class="p">:</span> <span class="n">RustfavaLedger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ledger</span><span class="p">)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_locale</span><span class="p">:</span> <span class="n">Locale</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_formatters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Formatter</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_default_pattern</span> <span class="o">=</span> <span class="n">get_locale_format</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">precisions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># noqa: D102</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="n">locale</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">locale_option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">locale</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;render_commas&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">locale_option</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="p">):</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>            <span class="n">locale_option</span> <span class="o">=</span> <span class="s2">&quot;en&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">fava_options</span><span class="o">.</span><span class="n">locale</span> <span class="o">=</span> <span class="n">locale_option</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="k">if</span> <span class="n">locale_option</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>            <span class="n">locale</span> <span class="o">=</span> <span class="n">Locale</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">locale_option</span><span class="p">)</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="n">dcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;dcontext&quot;</span><span class="p">]</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">precisions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="c1"># Both beancount&#39;s DisplayContext and RLDisplayContext have ccontexts</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="k">for</span> <span class="n">currency</span><span class="p">,</span> <span class="n">ccontext</span> <span class="ow">in</span> <span class="n">dcontext</span><span class="o">.</span><span class="n">ccontexts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>            <span class="n">prec</span> <span class="o">=</span> <span class="n">ccontext</span><span class="o">.</span><span class="n">get_fractional</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>            <span class="k">if</span> <span class="n">prec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>                <span class="n">precisions</span><span class="p">[</span><span class="n">currency</span><span class="p">]</span> <span class="o">=</span> <span class="n">prec</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="n">precisions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">commodities</span><span class="o">.</span><span class="n">precisions</span><span class="p">)</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_locale</span> <span class="o">=</span> <span class="n">locale</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_default_pattern</span> <span class="o">=</span> <span class="n">get_locale_format</span><span class="p">(</span><span class="n">locale</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_formatters</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>            <span class="n">currency</span><span class="p">:</span> <span class="n">get_locale_format</span><span class="p">(</span><span class="n">locale</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>            <span class="k">for</span> <span class="n">currency</span><span class="p">,</span> <span class="n">prec</span> <span class="ow">in</span> <span class="n">precisions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="p">}</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">precisions</span> <span class="o">=</span> <span class="n">precisions</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">currency</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Format a decimal to the right number of decimal digits with locale.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        Arguments:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            value: A decimal number.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            currency: A currency string or None.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            A string, the formatted decimal.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="k">if</span> <span class="n">currency</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_pattern</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formatters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_pattern</span><span class="p">)(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.number.DecimalFormatModule.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">currency</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#rustfava.core.number.DecimalFormatModule.__call__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Format a decimal to the right number of decimal digits with locale.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="decimal.Decimal">Decimal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A decimal number.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>currency</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A currency string or None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string, the formatted decimal.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/number.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">currency</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Format a decimal to the right number of decimal digits with locale.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        value: A decimal number.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        currency: A currency string or None.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        A string, the formatted decimal.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">if</span> <span class="n">currency</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_pattern</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formatters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_pattern</span><span class="p">)(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="rustfava.core.number.get_locale_format" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_locale_format</span><span class="p">(</span><span class="n">locale</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span></code>

<a href="#rustfava.core.number.get_locale_format" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Obtain formatting pattern for the given locale and precision.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>locale</code>
            </td>
            <td>
                  <code><span title="babel.core.Locale">Locale</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optional locale.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The precision.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="rustfava.core.number.Formatter">Formatter</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A function that renders Decimals to strings as desired.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/number.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_locale_format</span><span class="p">(</span><span class="n">locale</span><span class="p">:</span> <span class="n">Locale</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">precision</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Formatter</span><span class="p">:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Obtain formatting pattern for the given locale and precision.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        locale: An optional locale.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        precision: The precision.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        A function that renders Decimals to strings as desired.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="c1"># Set a maximum precision of 14, half the default precision of Decimal</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">precision</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">precision</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">if</span> <span class="n">locale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="n">fmt_string</span> <span class="o">=</span> <span class="s2">&quot;{:.&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;f}&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">fmt</span><span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>            <span class="k">return</span> <span class="n">fmt_string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="k">return</span> <span class="n">fmt</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">pattern</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">locale</span><span class="o">.</span><span class="n">decimal_formats</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">pattern</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Expected Locale to have a decimal format pattern&quot;</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">pattern</span><span class="o">.</span><span class="n">frac_prec</span> <span class="o">=</span> <span class="p">(</span><span class="n">precision</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">locale_fmt</span><span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="k">return</span> <span class="n">pattern</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">locale</span><span class="p">)</span>  <span class="c1"># type: ignore[no-any-return]</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="k">return</span> <span class="n">locale_fmt</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.query" class="doc doc-heading">
            <code>query</code>


<a href="#rustfava.core.query" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Query result types.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query.QueryResultTable" class="doc doc-heading">
            <code>QueryResultTable</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.query.QueryResultTable" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>Table query result.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="k">class</span><span class="w"> </span><span class="nc">QueryResultTable</span><span class="p">:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Table query result.&quot;&quot;&quot;</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="n">types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">BaseColumn</span><span class="p">]</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">rows</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">SerialisedQueryRowValue</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">t</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;table&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;table&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query.QueryResultText" class="doc doc-heading">
            <code>QueryResultText</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.query.QueryResultText" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>Text query result.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="k">class</span><span class="w"> </span><span class="nc">QueryResultText</span><span class="p">:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Text query result.&quot;&quot;&quot;</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">contents</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">t</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;string&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query.BaseColumn" class="doc doc-heading">
            <code>BaseColumn</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.query.BaseColumn" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>A query column.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="k">class</span><span class="w"> </span><span class="nc">BaseColumn</span><span class="p">:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A query column.&quot;&quot;&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">serialise</span><span class="p">(</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="n">val</span><span class="p">:</span> <span class="n">QueryRowValue</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SerialisedQueryRowValue</span><span class="p">:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Serialiseable version of the column value.&quot;&quot;&quot;</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="k">return</span> <span class="n">val</span>  <span class="c1"># type: ignore[no-any-return]</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.query.BaseColumn.serialise" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialise</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#rustfava.core.query.BaseColumn.serialise" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Serialiseable version of the column value.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/query.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="k">def</span><span class="w"> </span><span class="nf">serialise</span><span class="p">(</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">val</span><span class="p">:</span> <span class="n">QueryRowValue</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SerialisedQueryRowValue</span><span class="p">:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialiseable version of the column value.&quot;&quot;&quot;</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="k">return</span> <span class="n">val</span>  <span class="c1"># type: ignore[no-any-return]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query.BoolColumn" class="doc doc-heading">
            <code>BoolColumn</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.query.BoolColumn" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseColumn


  
      dataclass
   (rustfava.core.query.BaseColumn)" href="#rustfava.core.query.BaseColumn">BaseColumn</a></code></p>



        <p>A boolean query column.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="k">class</span><span class="w"> </span><span class="nc">BoolColumn</span><span class="p">(</span><span class="n">BaseColumn</span><span class="p">):</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A boolean query column.&quot;&quot;&quot;</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bool&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query.DecimalColumn" class="doc doc-heading">
            <code>DecimalColumn</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.query.DecimalColumn" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseColumn


  
      dataclass
   (rustfava.core.query.BaseColumn)" href="#rustfava.core.query.BaseColumn">BaseColumn</a></code></p>



        <p>A Decimal query column.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">class</span><span class="w"> </span><span class="nc">DecimalColumn</span><span class="p">(</span><span class="n">BaseColumn</span><span class="p">):</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A Decimal query column.&quot;&quot;&quot;</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Decimal&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query.IntColumn" class="doc doc-heading">
            <code>IntColumn</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.query.IntColumn" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseColumn


  
      dataclass
   (rustfava.core.query.BaseColumn)" href="#rustfava.core.query.BaseColumn">BaseColumn</a></code></p>



        <p>A int query column.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="k">class</span><span class="w"> </span><span class="nc">IntColumn</span><span class="p">(</span><span class="n">BaseColumn</span><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A int query column.&quot;&quot;&quot;</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;int&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query.StrColumn" class="doc doc-heading">
            <code>StrColumn</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.query.StrColumn" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseColumn


  
      dataclass
   (rustfava.core.query.BaseColumn)" href="#rustfava.core.query.BaseColumn">BaseColumn</a></code></p>



        <p>A str query column.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="k">class</span><span class="w"> </span><span class="nc">StrColumn</span><span class="p">(</span><span class="n">BaseColumn</span><span class="p">):</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A str query column.&quot;&quot;&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;str&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query.DateColumn" class="doc doc-heading">
            <code>DateColumn</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.query.DateColumn" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseColumn


  
      dataclass
   (rustfava.core.query.BaseColumn)" href="#rustfava.core.query.BaseColumn">BaseColumn</a></code></p>



        <p>A date query column.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="k">class</span><span class="w"> </span><span class="nc">DateColumn</span><span class="p">(</span><span class="n">BaseColumn</span><span class="p">):</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A date query column.&quot;&quot;&quot;</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;date&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query.PositionColumn" class="doc doc-heading">
            <code>PositionColumn</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.query.PositionColumn" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseColumn


  
      dataclass
   (rustfava.core.query.BaseColumn)" href="#rustfava.core.query.BaseColumn">BaseColumn</a></code></p>



        <p>A Position query column.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="k">class</span><span class="w"> </span><span class="nc">PositionColumn</span><span class="p">(</span><span class="n">BaseColumn</span><span class="p">):</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A Position query column.&quot;&quot;&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Position&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query.SetColumn" class="doc doc-heading">
            <code>SetColumn</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.query.SetColumn" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseColumn


  
      dataclass
   (rustfava.core.query.BaseColumn)" href="#rustfava.core.query.BaseColumn">BaseColumn</a></code></p>



        <p>A set query column.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="k">class</span><span class="w"> </span><span class="nc">SetColumn</span><span class="p">(</span><span class="n">BaseColumn</span><span class="p">):</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A set query column.&quot;&quot;&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;set&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query.AmountColumn" class="doc doc-heading">
            <code>AmountColumn</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.query.AmountColumn" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseColumn


  
      dataclass
   (rustfava.core.query.BaseColumn)" href="#rustfava.core.query.BaseColumn">BaseColumn</a></code></p>



        <p>An amount query column.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="k">class</span><span class="w"> </span><span class="nc">AmountColumn</span><span class="p">(</span><span class="n">BaseColumn</span><span class="p">):</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;An amount query column.&quot;&quot;&quot;</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Amount&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query.ObjectColumn" class="doc doc-heading">
            <code>ObjectColumn</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.query.ObjectColumn" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseColumn


  
      dataclass
   (rustfava.core.query.BaseColumn)" href="#rustfava.core.query.BaseColumn">BaseColumn</a></code></p>



        <p>An object query column.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="k">class</span><span class="w"> </span><span class="nc">ObjectColumn</span><span class="p">(</span><span class="n">BaseColumn</span><span class="p">):</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;An object query column.&quot;&quot;&quot;</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;object&quot;</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">serialise</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Serialise an object of unknown type to a string.&quot;&quot;&quot;</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.query.ObjectColumn.serialise" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialise</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#rustfava.core.query.ObjectColumn.serialise" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Serialise an object of unknown type to a string.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/query.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="k">def</span><span class="w"> </span><span class="nf">serialise</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialise an object of unknown type to a string.&quot;&quot;&quot;</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query.InventoryColumn" class="doc doc-heading">
            <code>InventoryColumn</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.query.InventoryColumn" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseColumn


  
      dataclass
   (rustfava.core.query.BaseColumn)" href="#rustfava.core.query.BaseColumn">BaseColumn</a></code></p>



        <p>An inventory query column.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="k">class</span><span class="w"> </span><span class="nc">InventoryColumn</span><span class="p">(</span><span class="n">BaseColumn</span><span class="p">):</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;An inventory query column.&quot;&quot;&quot;</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Inventory&quot;</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">serialise</span><span class="p">(</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="n">val</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SimpleCounterInventory</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Serialise an inventory.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        Rustledger returns inventory as a dict of currency -&gt; Decimal.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="c1"># Rustledger already converts to {currency: Decimal} format</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="kn">from</span><span class="w"> </span><span class="nn">rustfava.core.inventory</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleCounterInventory</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="k">return</span> <span class="n">SimpleCounterInventory</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="c1"># Fallback for beancount Inventory type (for backwards compat)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="k">return</span> <span class="n">UNITS</span><span class="o">.</span><span class="n">apply_inventory</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.query.InventoryColumn.serialise" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialise</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#rustfava.core.query.InventoryColumn.serialise" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Serialise an inventory.</p>
<p>Rustledger returns inventory as a dict of currency -&gt; Decimal.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/query.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="k">def</span><span class="w"> </span><span class="nf">serialise</span><span class="p">(</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="n">val</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SimpleCounterInventory</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialise an inventory.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    Rustledger returns inventory as a dict of currency -&gt; Decimal.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="c1"># Rustledger already converts to {currency: Decimal} format</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">rustfava.core.inventory</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleCounterInventory</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="k">return</span> <span class="n">SimpleCounterInventory</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="c1"># Fallback for beancount Inventory type (for backwards compat)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">return</span> <span class="n">UNITS</span><span class="o">.</span><span class="n">apply_inventory</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.query_shell" class="doc doc-heading">
            <code>query_shell</code>


<a href="#rustfava.core.query_shell" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>For running BQL queries in Fava.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query_shell.FavaShellError" class="doc doc-heading">
            <code>FavaShellError</code>


<a href="#rustfava.core.query_shell.FavaShellError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code></p>



        <p>An error in the Fava BQL shell, will be turned into a string.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query_shell.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="k">class</span><span class="w"> </span><span class="nc">FavaShellError</span><span class="p">(</span><span class="n">RustfavaAPIError</span><span class="p">):</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;An error in the Fava BQL shell, will be turned into a string.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query_shell.QueryNotFoundError" class="doc doc-heading">
            <code>QueryNotFoundError</code>


<a href="#rustfava.core.query_shell.QueryNotFoundError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FavaShellError (rustfava.core.query_shell.FavaShellError)" href="#rustfava.core.query_shell.FavaShellError">FavaShellError</a></code></p>



        <p>Query '{name}' not found.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query_shell.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="k">class</span><span class="w"> </span><span class="nc">QueryNotFoundError</span><span class="p">(</span><span class="n">FavaShellError</span><span class="p">):</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Query &#39;{name}&#39; not found.&quot;&quot;&quot;</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query_shell.TooManyRunArgsError" class="doc doc-heading">
            <code>TooManyRunArgsError</code>


<a href="#rustfava.core.query_shell.TooManyRunArgsError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FavaShellError (rustfava.core.query_shell.FavaShellError)" href="#rustfava.core.query_shell.FavaShellError">FavaShellError</a></code></p>



        <p>Too many args to run: '{args}'.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query_shell.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="k">class</span><span class="w"> </span><span class="nc">TooManyRunArgsError</span><span class="p">(</span><span class="n">FavaShellError</span><span class="p">):</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Too many args to run: &#39;{args}&#39;.&quot;&quot;&quot;</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Too many args to run: &#39;</span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query_shell.QueryCompilationError" class="doc doc-heading">
            <code>QueryCompilationError</code>


<a href="#rustfava.core.query_shell.QueryCompilationError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FavaShellError (rustfava.core.query_shell.FavaShellError)" href="#rustfava.core.query_shell.FavaShellError">FavaShellError</a></code></p>



        <p>Query compilation error.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query_shell.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="k">class</span><span class="w"> </span><span class="nc">QueryCompilationError</span><span class="p">(</span><span class="n">FavaShellError</span><span class="p">):</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Query compilation error.&quot;&quot;&quot;</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span> <span class="n">CompilationError</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query compilation error: </span><span class="si">{</span><span class="n">err</span><span class="si">!s}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query_shell.QueryParseError" class="doc doc-heading">
            <code>QueryParseError</code>


<a href="#rustfava.core.query_shell.QueryParseError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FavaShellError (rustfava.core.query_shell.FavaShellError)" href="#rustfava.core.query_shell.FavaShellError">FavaShellError</a></code></p>



        <p>Query parse error.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query_shell.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="k">class</span><span class="w"> </span><span class="nc">QueryParseError</span><span class="p">(</span><span class="n">FavaShellError</span><span class="p">):</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Query parse error.&quot;&quot;&quot;</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">err</span><span class="p">:</span> <span class="n">ParseError</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query parse error: </span><span class="si">{</span><span class="n">err</span><span class="si">!s}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query_shell.NonExportableQueryError" class="doc doc-heading">
            <code>NonExportableQueryError</code>


<a href="#rustfava.core.query_shell.NonExportableQueryError" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FavaShellError (rustfava.core.query_shell.FavaShellError)" href="#rustfava.core.query_shell.FavaShellError">FavaShellError</a></code></p>



        <p>Only queries that return a table can be printed to a file.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query_shell.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="k">class</span><span class="w"> </span><span class="nc">NonExportableQueryError</span><span class="p">(</span><span class="n">FavaShellError</span><span class="p">):</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Only queries that return a table can be printed to a file.&quot;&quot;&quot;</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>            <span class="s2">&quot;Only queries that return a table can be printed to a file.&quot;</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query_shell.FavaQueryRunner" class="doc doc-heading">
            <code>FavaQueryRunner</code>


<a href="#rustfava.core.query_shell.FavaQueryRunner" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>Runs BQL queries using rustledger.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query_shell.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="k">class</span><span class="w"> </span><span class="nc">FavaQueryRunner</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Runs BQL queries using rustledger.&quot;&quot;&quot;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger</span><span class="p">:</span> <span class="n">RustfavaLedger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span> <span class="o">=</span> <span class="n">ledger</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">],</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RLCursor</span> <span class="o">|</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run a query, returning cursor or text result.&quot;&quot;&quot;</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="c1"># Get the source from the ledger for queries</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="n">source</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="p">,</span> <span class="s2">&quot;_source&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="c1"># Create connection</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="n">conn</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>            <span class="s2">&quot;rustledger:&quot;</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>            <span class="n">entries</span><span class="o">=</span><span class="n">entries</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>            <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>            <span class="n">options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="p">)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">if</span> <span class="n">source</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>            <span class="n">conn</span><span class="o">.</span><span class="n">set_source</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="c1"># Parse the query to handle special commands</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="n">query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="n">query_lower</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="c1"># Handle noop commands (return fixed text)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="n">noop_doc</span> <span class="o">=</span> <span class="s2">&quot;Doesn&#39;t do anything in rustfava&#39;s query shell.&quot;</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="k">if</span> <span class="n">query_lower</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;.exit&quot;</span><span class="p">,</span> <span class="s2">&quot;.quit&quot;</span><span class="p">,</span> <span class="s2">&quot;exit&quot;</span><span class="p">,</span> <span class="s2">&quot;quit&quot;</span><span class="p">):</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="k">return</span> <span class="n">noop_doc</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="c1"># Handle .run or run command</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="k">if</span> <span class="n">query_lower</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;.run&quot;</span><span class="p">,</span> <span class="s2">&quot;run&quot;</span><span class="p">)):</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="c1"># Check if it&#39;s just &quot;run&quot; or &quot;.run&quot; (list queries) or &quot;run name&quot;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="k">if</span> <span class="n">query_lower</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="s2">&quot;.run&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">query_lower</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;run &quot;</span><span class="p">,</span> <span class="s2">&quot;.run &quot;</span><span class="p">)):</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_run</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="c1"># Handle help commands - return text</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="k">if</span> <span class="n">query_lower</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;.help&quot;</span><span class="p">,</span> <span class="s2">&quot;help&quot;</span><span class="p">)):</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>            <span class="c1"># &quot;.help exit&quot; or &quot;.help &lt;command&gt;&quot; returns noop doc</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>            <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">query_lower</span><span class="p">:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>                <span class="k">return</span> <span class="n">noop_doc</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_help_text</span><span class="p">()</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="c1"># Handle .explain - return placeholder</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="k">if</span> <span class="n">query_lower</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;.explain&quot;</span><span class="p">,</span> <span class="s2">&quot;explain&quot;</span><span class="p">)):</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;EXPLAIN: </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="c1"># Handle SELECT/BALANCES/JOURNAL queries</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="k">return</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="k">except</span> <span class="n">ParseError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>            <span class="k">raise</span> <span class="n">QueryParseError</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="k">except</span> <span class="n">CompilationError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>            <span class="k">raise</span> <span class="n">QueryCompilationError</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_handle_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">conn</span><span class="p">:</span> <span class="n">RLConnection</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RLCursor</span> <span class="o">|</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle .run command to execute stored queries.&quot;&quot;&quot;</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">queries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Query</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="c1"># Parse the run command</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">parts</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="c1"># Just &quot;run&quot; - list available queries</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="k">raise</span> <span class="n">TooManyRunArgsError</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">query_obj</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">q</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">queries</span> <span class="k">if</span> <span class="n">q</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">if</span> <span class="n">query_obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>            <span class="k">raise</span> <span class="n">QueryNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>            <span class="k">return</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query_obj</span><span class="o">.</span><span class="n">query_string</span><span class="p">)</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="k">except</span> <span class="n">ParseError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>            <span class="k">raise</span> <span class="n">QueryParseError</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="k">except</span> <span class="n">CompilationError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="k">raise</span> <span class="n">QueryCompilationError</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_help_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return help text for the query shell.&quot;&quot;&quot;</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="k">return</span> <span class="s2">&quot;&quot;&quot;Fava Query Shell</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="s2">Commands:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="s2">  SELECT ...     Run a BQL SELECT query</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="s2">  run &lt;name&gt;     Run a stored query by name</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="s2">  run            List all stored queries</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="s2">  help           Show this help message</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="s2">Example queries:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="s2">  SELECT account, sum(position) GROUP BY account</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="s2">  SELECT date, narration, position WHERE account ~ &quot;Expenses&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="s2">&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.query_shell.FavaQueryRunner.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span></code>

<a href="#rustfava.core.query_shell.FavaQueryRunner.run" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Run a query, returning cursor or text result.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/query_shell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">],</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RLCursor</span> <span class="o">|</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run a query, returning cursor or text result.&quot;&quot;&quot;</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="c1"># Get the source from the ledger for queries</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">source</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="p">,</span> <span class="s2">&quot;_source&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="c1"># Create connection</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">conn</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="s2">&quot;rustledger:&quot;</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="n">entries</span><span class="o">=</span><span class="n">entries</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="n">options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="p">)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="k">if</span> <span class="n">source</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="n">conn</span><span class="o">.</span><span class="n">set_source</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="c1"># Parse the query to handle special commands</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="n">query_lower</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="c1"># Handle noop commands (return fixed text)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">noop_doc</span> <span class="o">=</span> <span class="s2">&quot;Doesn&#39;t do anything in rustfava&#39;s query shell.&quot;</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="k">if</span> <span class="n">query_lower</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;.exit&quot;</span><span class="p">,</span> <span class="s2">&quot;.quit&quot;</span><span class="p">,</span> <span class="s2">&quot;exit&quot;</span><span class="p">,</span> <span class="s2">&quot;quit&quot;</span><span class="p">):</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="k">return</span> <span class="n">noop_doc</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="c1"># Handle .run or run command</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">if</span> <span class="n">query_lower</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;.run&quot;</span><span class="p">,</span> <span class="s2">&quot;run&quot;</span><span class="p">)):</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="c1"># Check if it&#39;s just &quot;run&quot; or &quot;.run&quot; (list queries) or &quot;run name&quot;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="k">if</span> <span class="n">query_lower</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="s2">&quot;.run&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">query_lower</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;run &quot;</span><span class="p">,</span> <span class="s2">&quot;.run &quot;</span><span class="p">)):</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_run</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="c1"># Handle help commands - return text</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="k">if</span> <span class="n">query_lower</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;.help&quot;</span><span class="p">,</span> <span class="s2">&quot;help&quot;</span><span class="p">)):</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="c1"># &quot;.help exit&quot; or &quot;.help &lt;command&gt;&quot; returns noop doc</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">query_lower</span><span class="p">:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="k">return</span> <span class="n">noop_doc</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_help_text</span><span class="p">()</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="c1"># Handle .explain - return placeholder</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">if</span> <span class="n">query_lower</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;.explain&quot;</span><span class="p">,</span> <span class="s2">&quot;explain&quot;</span><span class="p">)):</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;EXPLAIN: </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="c1"># Handle SELECT/BALANCES/JOURNAL queries</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="k">return</span> <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="k">except</span> <span class="n">ParseError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">raise</span> <span class="n">QueryParseError</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="k">except</span> <span class="n">CompilationError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="k">raise</span> <span class="n">QueryCompilationError</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.query_shell.QueryShell" class="doc doc-heading">
            <code>QueryShell</code>


<a href="#rustfava.core.query_shell.QueryShell" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FavaModule (rustfava.core.module_base.FavaModule)" href="#rustfava.core.module_base.FavaModule">FavaModule</a></code></p>



        <p>A Fava module to run BQL queries.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/query_shell.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="k">class</span><span class="w"> </span><span class="nc">QueryShell</span><span class="p">(</span><span class="n">FavaModule</span><span class="p">):</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A Fava module to run BQL queries.&quot;&quot;&quot;</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ledger</span><span class="p">:</span> <span class="n">RustfavaLedger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ledger</span><span class="p">)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="o">=</span> <span class="n">FavaQueryRunner</span><span class="p">(</span><span class="n">ledger</span><span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">execute_query_serialised</span><span class="p">(</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">],</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QueryResultTable</span> <span class="o">|</span> <span class="n">QueryResultText</span><span class="p">:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run a query and returns its serialised result.</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        Arguments:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">            entries: The entries to run the query on.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">            query: A query string.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">            Either a table or a text result (depending on the query).</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">            RustfavaAPIError: If the query response is an error.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>            <span class="n">QueryResultText</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">_serialise</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="p">)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">query_to_file</span><span class="p">(</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">],</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="n">query_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="n">result_format</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">]:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get query result as file.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        Arguments:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            entries: The entries to run the query on.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">            query_string: A string, the query to run.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">            result_format: The file format to save to.</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">            A tuple (name, data), where name is either &#39;query_result&#39; or the</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">            name of a custom query if the query string is &#39;run name_of_query&#39;.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">            ``data`` contains the file contents.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">            RustfavaAPIError: If the result format is not supported or the</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">            query failed.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;query_result&quot;</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="k">if</span> <span class="n">query_string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;.run&quot;</span><span class="p">,</span> <span class="s2">&quot;run &quot;</span><span class="p">)):</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="n">parts</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">query_string</span><span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>                <span class="k">raise</span> <span class="n">TooManyRunArgsError</span><span class="p">(</span><span class="n">query_string</span><span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>                <span class="n">name</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>                <span class="n">queries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Query</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>                <span class="n">query_obj</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">q</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">queries</span> <span class="k">if</span> <span class="n">q</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                <span class="k">if</span> <span class="n">query_obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>                    <span class="k">raise</span> <span class="n">QueryNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>                <span class="n">query_string</span> <span class="o">=</span> <span class="n">query_obj</span><span class="o">.</span><span class="n">query_string</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="k">raise</span> <span class="n">NonExportableQueryError</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="n">rrows</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="n">rtypes</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">description</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="c1"># Convert rows to exportable format</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">rows</span> <span class="o">=</span> <span class="n">_numberify_rows</span><span class="p">(</span><span class="n">rrows</span><span class="p">,</span> <span class="n">rtypes</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="k">if</span> <span class="n">result_format</span> <span class="o">==</span> <span class="s2">&quot;csv&quot;</span><span class="p">:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">to_csv</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rtypes</span><span class="p">),</span> <span class="n">rows</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">HAVE_EXCEL</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Result format not supported.&quot;</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>                <span class="k">raise</span> <span class="n">RustfavaAPIError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">to_excel</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rtypes</span><span class="p">),</span> <span class="n">rows</span><span class="p">,</span> <span class="n">result_format</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.query_shell.QueryShell.execute_query_serialised" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">execute_query_serialised</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span></code>

<a href="#rustfava.core.query_shell.QueryShell.execute_query_serialised" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Run a query and returns its serialised result.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entries</code>
            </td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="rustfava.beans.abc.Directive">Directive</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The entries to run the query on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A query string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="QueryResultTable


  
      dataclass
   (rustfava.core.query.QueryResultTable)" href="#rustfava.core.query.QueryResultTable">QueryResultTable</a> | <a class="autorefs autorefs-internal" title="QueryResultText


  
      dataclass
   (rustfava.core.query.QueryResultText)" href="#rustfava.core.query.QueryResultText">QueryResultText</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Either a table or a text result (depending on the query).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the query response is an error.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/query_shell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="k">def</span><span class="w"> </span><span class="nf">execute_query_serialised</span><span class="p">(</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">],</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QueryResultTable</span> <span class="o">|</span> <span class="n">QueryResultText</span><span class="p">:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Run a query and returns its serialised result.</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        entries: The entries to run the query on.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        query: A query string.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        Either a table or a text result (depending on the query).</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        RustfavaAPIError: If the query response is an error.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="n">QueryResultText</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">_serialise</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.query_shell.QueryShell.query_to_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">query_to_file</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">query_string</span><span class="p">,</span> <span class="n">result_format</span><span class="p">)</span></code>

<a href="#rustfava.core.query_shell.QueryShell.query_to_file" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Get query result as file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entries</code>
            </td>
            <td>
                  <code><span title="collections.abc.Sequence">Sequence</span>[<span title="rustfava.beans.abc.Directive">Directive</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The entries to run the query on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query_string</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string, the query to run.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>result_format</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file format to save to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple (name, data), where name is either 'query_result' or the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="io.BytesIO">BytesIO</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of a custom query if the query string is 'run name_of_query'.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="str">str</span>, <span title="io.BytesIO">BytesIO</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>data</code> contains the file contents.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="rustfava.helpers.RustfavaAPIError">RustfavaAPIError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the result format is not supported or the</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/query_shell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="k">def</span><span class="w"> </span><span class="nf">query_to_file</span><span class="p">(</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="n">entries</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Directive</span><span class="p">],</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="n">query_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="n">result_format</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">]:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get query result as file.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        entries: The entries to run the query on.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        query_string: A string, the query to run.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        result_format: The file format to save to.</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        A tuple (name, data), where name is either &#39;query_result&#39; or the</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        name of a custom query if the query string is &#39;run name_of_query&#39;.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        ``data`` contains the file contents.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        RustfavaAPIError: If the result format is not supported or the</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        query failed.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;query_result&quot;</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="k">if</span> <span class="n">query_string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;.run&quot;</span><span class="p">,</span> <span class="s2">&quot;run &quot;</span><span class="p">)):</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="n">parts</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">query_string</span><span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="k">raise</span> <span class="n">TooManyRunArgsError</span><span class="p">(</span><span class="n">query_string</span><span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="n">queries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">all_entries_by_type</span><span class="o">.</span><span class="n">Query</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="n">query_obj</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">q</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">queries</span> <span class="k">if</span> <span class="n">q</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>            <span class="k">if</span> <span class="n">query_obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>                <span class="k">raise</span> <span class="n">QueryNotFoundError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="n">query_string</span> <span class="o">=</span> <span class="n">query_obj</span><span class="o">.</span><span class="n">query_string</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="k">raise</span> <span class="n">NonExportableQueryError</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="n">rrows</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="n">rtypes</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">description</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="c1"># Convert rows to exportable format</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="n">rows</span> <span class="o">=</span> <span class="n">_numberify_rows</span><span class="p">(</span><span class="n">rrows</span><span class="p">,</span> <span class="n">rtypes</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="k">if</span> <span class="n">result_format</span> <span class="o">==</span> <span class="s2">&quot;csv&quot;</span><span class="p">:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">to_csv</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rtypes</span><span class="p">),</span> <span class="n">rows</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">HAVE_EXCEL</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Result format not supported.&quot;</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="k">raise</span> <span class="n">RustfavaAPIError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">to_excel</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rtypes</span><span class="p">),</span> <span class="n">rows</span><span class="p">,</span> <span class="n">result_format</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.tree" class="doc doc-heading">
            <code>tree</code>


<a href="#rustfava.core.tree" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>Account balance trees.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.tree.SerialisedTreeNode" class="doc doc-heading">
            <code>SerialisedTreeNode</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#rustfava.core.tree.SerialisedTreeNode" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>A serialised TreeNode.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/tree.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="k">class</span><span class="w"> </span><span class="nc">SerialisedTreeNode</span><span class="p">:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A serialised TreeNode.&quot;&quot;&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="n">account</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">balance</span><span class="p">:</span> <span class="n">SimpleCounterInventory</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="n">balance_children</span><span class="p">:</span> <span class="n">SimpleCounterInventory</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">children</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">SerialisedTreeNode</span><span class="p">]</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="n">has_txns</span><span class="p">:</span> <span class="nb">bool</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">cost</span><span class="p">:</span> <span class="n">SimpleCounterInventory</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">cost_children</span><span class="p">:</span> <span class="n">SimpleCounterInventory</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.tree.TreeNode" class="doc doc-heading">
            <code>TreeNode</code>


<a href="#rustfava.core.tree.TreeNode" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">



        <p>A node in the account tree.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/tree.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="k">class</span><span class="w"> </span><span class="nc">TreeNode</span><span class="p">:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A node in the account tree.&quot;&quot;&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;balance&quot;</span><span class="p">,</span> <span class="s2">&quot;balance_children&quot;</span><span class="p">,</span> <span class="s2">&quot;children&quot;</span><span class="p">,</span> <span class="s2">&quot;has_txns&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="c1">#: Account name.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">name</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="c1">#: A list of :class:`.TreeNode`, its children.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TreeNode</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="c1">#: The cumulative account balance.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">balance_children</span> <span class="o">=</span> <span class="n">CounterInventory</span><span class="p">()</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="c1">#: The account balance.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="n">CounterInventory</span><span class="p">()</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="c1">#: Whether the account has any transactions.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">has_txns</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">serialise</span><span class="p">(</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="n">conversion</span><span class="p">:</span> <span class="n">Conversion</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="n">prices</span><span class="p">:</span> <span class="n">RustfavaPriceMap</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">end</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">with_cost</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SerialisedTreeNode</span><span class="p">:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Serialise the account.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            conversion: The conversion to use.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">            prices: The price map to use.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            end: A date to use for cost conversions.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            with_cost: Additionally convert to cost.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">children</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>            <span class="n">child</span><span class="o">.</span><span class="n">serialise</span><span class="p">(</span><span class="n">conversion</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">with_cost</span><span class="o">=</span><span class="n">with_cost</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="p">]</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>            <span class="n">SerialisedTreeNode</span><span class="p">(</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>                <span class="n">conversion</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>                <span class="n">conversion</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance_children</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>                <span class="n">children</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">has_txns</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>                <span class="n">AT_COST</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">),</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>                <span class="n">AT_COST</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance_children</span><span class="p">),</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>            <span class="p">)</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>            <span class="k">if</span> <span class="n">with_cost</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="k">else</span> <span class="n">SerialisedTreeNode</span><span class="p">(</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>                <span class="n">conversion</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>                <span class="n">conversion</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance_children</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>                <span class="n">children</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">has_txns</span><span class="p">,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">serialise_with_context</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SerialisedTreeNode</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Serialise, getting all parameters from Flask context.&quot;&quot;&quot;</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialise</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="n">g</span><span class="o">.</span><span class="n">conv</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="n">g</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">prices</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="n">g</span><span class="o">.</span><span class="n">filtered</span><span class="o">.</span><span class="n">end_date</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="n">with_cost</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">conv</span> <span class="o">==</span> <span class="n">AT_VALUE</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.tree.TreeNode.serialise" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialise</span><span class="p">(</span><span class="n">conversion</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">with_cost</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#rustfava.core.tree.TreeNode.serialise" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Serialise the account.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>conversion</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Conversion (rustfava.core.conversion.Conversion)" href="#rustfava.core.conversion.Conversion">Conversion</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The conversion to use.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prices</code>
            </td>
            <td>
                  <code><span title="rustfava.beans.prices.RustfavaPriceMap">RustfavaPriceMap</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The price map to use.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end</code>
            </td>
            <td>
                  <code><span title="datetime.date">date</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A date to use for cost conversions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_cost</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additionally convert to cost.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/tree.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span>
<span class="normal"><a href="#__codelineno-0-96">96</a></span>
<span class="normal"><a href="#__codelineno-0-97">97</a></span>
<span class="normal"><a href="#__codelineno-0-98">98</a></span>
<span class="normal"><a href="#__codelineno-0-99">99</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="k">def</span><span class="w"> </span><span class="nf">serialise</span><span class="p">(</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">conversion</span><span class="p">:</span> <span class="n">Conversion</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">prices</span><span class="p">:</span> <span class="n">RustfavaPriceMap</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">end</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">with_cost</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SerialisedTreeNode</span><span class="p">:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialise the account.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        conversion: The conversion to use.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        prices: The price map to use.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        end: A date to use for cost conversions.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        with_cost: Additionally convert to cost.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">children</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="n">child</span><span class="o">.</span><span class="n">serialise</span><span class="p">(</span><span class="n">conversion</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">with_cost</span><span class="o">=</span><span class="n">with_cost</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="p">]</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="n">SerialisedTreeNode</span><span class="p">(</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>            <span class="n">conversion</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="n">conversion</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance_children</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="n">children</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">has_txns</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>            <span class="n">AT_COST</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">),</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>            <span class="n">AT_COST</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance_children</span><span class="p">),</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="p">)</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="k">if</span> <span class="n">with_cost</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="k">else</span> <span class="n">SerialisedTreeNode</span><span class="p">(</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>            <span class="n">conversion</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>            <span class="n">conversion</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance_children</span><span class="p">,</span> <span class="n">prices</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>            <span class="n">children</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">has_txns</span><span class="p">,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.tree.TreeNode.serialise_with_context" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialise_with_context</span><span class="p">()</span></code>

<a href="#rustfava.core.tree.TreeNode.serialise_with_context" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Serialise, getting all parameters from Flask context.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/tree.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="k">def</span><span class="w"> </span><span class="nf">serialise_with_context</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SerialisedTreeNode</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialise, getting all parameters from Flask context.&quot;&quot;&quot;</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">serialise</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">g</span><span class="o">.</span><span class="n">conv</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">g</span><span class="o">.</span><span class="n">ledger</span><span class="o">.</span><span class="n">prices</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="n">g</span><span class="o">.</span><span class="n">filtered</span><span class="o">.</span><span class="n">end_date</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="n">with_cost</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">conv</span> <span class="o">==</span> <span class="n">AT_VALUE</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.tree.Tree" class="doc doc-heading">
            <code>Tree</code>


<a href="#rustfava.core.tree.Tree" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="dict">dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="TreeNode (rustfava.core.tree.TreeNode)" href="#rustfava.core.tree.TreeNode">TreeNode</a>]</code></p>



        <p>Account tree.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entries</code>
            </td>
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<span title="rustfava.beans.abc.Directive">Directive</span> | <span title="beancount.core.data.Directive">Directive</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of entries to compute balances from.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>create_accounts</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of accounts that the tree should contain.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/tree.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="k">class</span><span class="w"> </span><span class="nc">Tree</span><span class="p">(</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">TreeNode</span><span class="p">]):</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Account tree.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        entries: A list of entries to compute balances from.</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        create_accounts: A list of accounts that the tree should contain.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">entries</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Directive</span> <span class="o">|</span> <span class="n">data</span><span class="o">.</span><span class="n">Directive</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">create_accounts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">if</span> <span class="n">create_accounts</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="n">create_accounts</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="k">if</span> <span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="n">account_balances</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">CounterInventory</span><span class="p">]</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="n">account_balances</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">CounterInventory</span><span class="p">)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Open</span><span class="p">):</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>                <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s2">&quot;postings&quot;</span><span class="p">,</span> <span class="p">[]):</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>                    <span class="n">account_balances</span><span class="p">[</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">]</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">balance</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">account_balances</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">balance</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">accounts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The accounts in this tree.&quot;&quot;&quot;</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">ancestors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">TreeNode</span><span class="p">]:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Ancestors of an account.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            name: An account name.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        Yields:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            The ancestors of the given account from the bottom up.</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="k">while</span> <span class="n">name</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">account_parent</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">balance</span><span class="p">:</span> <span class="n">CounterInventory</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Insert account with a balance.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        Insert account and update its balance and the balances of its</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        ancestors.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            name: An account name.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">            balance: The balance of the account.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="n">node</span><span class="o">.</span><span class="n">balance</span><span class="o">.</span><span class="n">add_inventory</span><span class="p">(</span><span class="n">balance</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="n">node</span><span class="o">.</span><span class="n">balance_children</span><span class="o">.</span><span class="n">add_inventory</span><span class="p">(</span><span class="n">balance</span><span class="p">)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="n">node</span><span class="o">.</span><span class="n">has_txns</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="k">for</span> <span class="n">parent_node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ancestors</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>            <span class="n">parent_node</span><span class="o">.</span><span class="n">balance_children</span><span class="o">.</span><span class="n">add_inventory</span><span class="p">(</span><span class="n">balance</span><span class="p">)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span>  <span class="c1"># type: ignore[override]</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="n">insert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TreeNode</span><span class="p">:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an account.</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">            name: An account name.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">            insert: If True, insert the name into the tree if it does not</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">                exist.</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">            TreeNode: The account of that name or an empty account if the</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">            account is not in the tree.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>            <span class="n">node</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>            <span class="k">if</span> <span class="n">insert</span><span class="p">:</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                    <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">account_parent</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                    <span class="n">parent</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="k">return</span> <span class="n">node</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">net_profit</span><span class="p">(</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="n">options</span><span class="p">:</span> <span class="n">BeancountOptions</span><span class="p">,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="n">account_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TreeNode</span><span class="p">:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the net profit.</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">            options: The Beancount options.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">            account_name: The name to use for the account containing the net</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">                profit.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="n">income</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_income&quot;</span><span class="p">])</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="n">expenses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_expenses&quot;</span><span class="p">])</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">net_profit</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">net_profit</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="n">account_name</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="n">income</span><span class="o">.</span><span class="n">balance_children</span> <span class="o">+</span> <span class="n">expenses</span><span class="o">.</span><span class="n">balance_children</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="k">return</span> <span class="n">net_profit</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="n">BeancountOptions</span><span class="p">,</span> <span class="n">unrealized_account</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Transfer Income and Expenses, add conversions and unrealized gains.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">            options: The Beancount options.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">            unrealized_account: The name of the account to post unrealized</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">                gains to (as a subaccount of Equity).</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="n">equity</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_equity&quot;</span><span class="p">]</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">conversions</span> <span class="o">=</span> <span class="n">CounterInventory</span><span class="p">(</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="p">{</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>                <span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span> <span class="o">-</span><span class="n">number</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>                <span class="k">for</span> <span class="n">currency</span><span class="p">,</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">AT_COST</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">balance_children</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>                <span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>            <span class="p">},</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="p">)</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="c1"># Add conversions</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>            <span class="n">equity</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;account_current_conversions&quot;</span><span class="p">],</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="n">conversions</span><span class="p">,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="c1"># Insert unrealized gains.</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>            <span class="n">equity</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">unrealized_account</span><span class="p">,</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">balance_children</span><span class="p">,</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="p">)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="c1"># Transfer Income and Expenses</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>            <span class="n">equity</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;account_current_earnings&quot;</span><span class="p">],</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_income&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">balance_children</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="p">)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>            <span class="n">equity</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;account_current_earnings&quot;</span><span class="p">],</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_expenses&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">balance_children</span><span class="p">,</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="rustfava.core.tree.Tree.accounts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">accounts</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#rustfava.core.tree.Tree.accounts" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>The accounts in this tree.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h5 id="rustfava.core.tree.Tree.ancestors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ancestors</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#rustfava.core.tree.Tree.ancestors" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Ancestors of an account.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An account name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="TreeNode (rustfava.core.tree.TreeNode)" href="#rustfava.core.tree.TreeNode">TreeNode</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ancestors of the given account from the bottom up.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/tree.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="k">def</span><span class="w"> </span><span class="nf">ancestors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">TreeNode</span><span class="p">]:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Ancestors of an account.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        name: An account name.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        The ancestors of the given account from the bottom up.</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="k">while</span> <span class="n">name</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">account_parent</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.tree.Tree.insert" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">insert</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">balance</span><span class="p">)</span></code>

<a href="#rustfava.core.tree.Tree.insert" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Insert account with a balance.</p>
<p>Insert account and update its balance and the balances of its
ancestors.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An account name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>balance</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CounterInventory (rustfava.core.inventory.CounterInventory)" href="#rustfava.core.inventory.CounterInventory">CounterInventory</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The balance of the account.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/tree.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="k">def</span><span class="w"> </span><span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">balance</span><span class="p">:</span> <span class="n">CounterInventory</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert account with a balance.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    Insert account and update its balance and the balances of its</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">    ancestors.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        name: An account name.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        balance: The balance of the account.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">node</span><span class="o">.</span><span class="n">balance</span><span class="o">.</span><span class="n">add_inventory</span><span class="p">(</span><span class="n">balance</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">node</span><span class="o">.</span><span class="n">balance_children</span><span class="o">.</span><span class="n">add_inventory</span><span class="p">(</span><span class="n">balance</span><span class="p">)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="n">node</span><span class="o">.</span><span class="n">has_txns</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="k">for</span> <span class="n">parent_node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ancestors</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">parent_node</span><span class="o">.</span><span class="n">balance_children</span><span class="o">.</span><span class="n">add_inventory</span><span class="p">(</span><span class="n">balance</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.tree.Tree.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#rustfava.core.tree.Tree.get" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Get an account.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An account name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>insert</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, insert the name into the tree if it does not
exist.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>TreeNode</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="TreeNode (rustfava.core.tree.TreeNode)" href="#rustfava.core.tree.TreeNode">TreeNode</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The account of that name or an empty account if the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="TreeNode (rustfava.core.tree.TreeNode)" href="#rustfava.core.tree.TreeNode">TreeNode</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>account is not in the tree.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/tree.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span>  <span class="c1"># type: ignore[override]</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="n">insert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TreeNode</span><span class="p">:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get an account.</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        name: An account name.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        insert: If True, insert the name into the tree if it does not</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">            exist.</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        TreeNode: The account of that name or an empty account if the</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        account is not in the tree.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="n">node</span> <span class="o">=</span> <span class="n">TreeNode</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="k">if</span> <span class="n">insert</span><span class="p">:</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">account_parent</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">insert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                <span class="n">parent</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="k">return</span> <span class="n">node</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.tree.Tree.net_profit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">net_profit</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">account_name</span><span class="p">)</span></code>

<a href="#rustfava.core.tree.Tree.net_profit" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Calculate the net profit.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>options</code>
            </td>
            <td>
                  <code><span title="rustfava.beans.types.BeancountOptions">BeancountOptions</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Beancount options.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>account_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name to use for the account containing the net
profit.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/tree.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="k">def</span><span class="w"> </span><span class="nf">net_profit</span><span class="p">(</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="n">options</span><span class="p">:</span> <span class="n">BeancountOptions</span><span class="p">,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="n">account_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TreeNode</span><span class="p">:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the net profit.</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        options: The Beancount options.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        account_name: The name to use for the account containing the net</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">            profit.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">income</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_income&quot;</span><span class="p">])</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="n">expenses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_expenses&quot;</span><span class="p">])</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="n">net_profit</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="n">net_profit</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="n">account_name</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="n">income</span><span class="o">.</span><span class="n">balance_children</span> <span class="o">+</span> <span class="n">expenses</span><span class="o">.</span><span class="n">balance_children</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="k">return</span> <span class="n">net_profit</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.tree.Tree.cap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cap</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">unrealized_account</span><span class="p">)</span></code>

<a href="#rustfava.core.tree.Tree.cap" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Transfer Income and Expenses, add conversions and unrealized gains.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>options</code>
            </td>
            <td>
                  <code><span title="rustfava.beans.types.BeancountOptions">BeancountOptions</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Beancount options.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unrealized_account</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the account to post unrealized
gains to (as a subaccount of Equity).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/tree.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="k">def</span><span class="w"> </span><span class="nf">cap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="n">BeancountOptions</span><span class="p">,</span> <span class="n">unrealized_account</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Transfer Income and Expenses, add conversions and unrealized gains.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        options: The Beancount options.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">        unrealized_account: The name of the account to post unrealized</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">            gains to (as a subaccount of Equity).</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="n">equity</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_equity&quot;</span><span class="p">]</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="n">conversions</span> <span class="o">=</span> <span class="n">CounterInventory</span><span class="p">(</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="p">{</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span> <span class="o">-</span><span class="n">number</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>            <span class="k">for</span> <span class="n">currency</span><span class="p">,</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">AT_COST</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">balance_children</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="p">},</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="p">)</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="c1"># Add conversions</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="n">equity</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;account_current_conversions&quot;</span><span class="p">],</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="n">conversions</span><span class="p">,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="c1"># Insert unrealized gains.</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="n">equity</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">unrealized_account</span><span class="p">,</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">balance_children</span><span class="p">,</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="p">)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="c1"># Transfer Income and Expenses</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="n">equity</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;account_current_earnings&quot;</span><span class="p">],</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_income&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">balance_children</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="p">)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="n">equity</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;account_current_earnings&quot;</span><span class="p">],</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;name_expenses&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">balance_children</span><span class="p">,</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="rustfava.core.watcher" class="doc doc-heading">
            <code>watcher</code>


<a href="#rustfava.core.watcher" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

        <p>A simple file and folder watcher.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="rustfava.core.watcher.WatcherBase" class="doc doc-heading">
            <code>WatcherBase</code>


<a href="#rustfava.core.watcher.WatcherBase" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>



        <p>ABC for rustfava ledger file watchers.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/watcher.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="k">class</span><span class="w"> </span><span class="nc">WatcherBase</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;ABC for rustfava ledger file watchers.&quot;&quot;&quot;</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">last_checked</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Timestamp of the latest change noticed by the file watcher.&quot;&quot;&quot;</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="n">last_notified</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Timestamp of the latest change that the watcher was notified of.&quot;&quot;&quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span> <span class="n">folders</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the folders/files to watch.</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">            files: A list of file paths.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">            folders: A list of paths to folders.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check for changes.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">            `True` if there was a file change in one of the files or folders,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">            `False` otherwise.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="n">latest_mtime</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_latest_mtime</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_notified</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="n">has_higher_mtime</span> <span class="o">=</span> <span class="n">latest_mtime</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_checked</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="k">if</span> <span class="n">has_higher_mtime</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_checked</span> <span class="o">=</span> <span class="n">latest_mtime</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="k">return</span> <span class="n">has_higher_mtime</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">notify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Notify the watcher of a change to a path.&quot;&quot;&quot;</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="n">change_mtime</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime_ns</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>            <span class="n">change_mtime</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_notified</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_checked</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_notified</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_notified</span><span class="p">,</span> <span class="n">change_mtime</span><span class="p">)</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_latest_mtime</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the latest change mtime.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="rustfava.core.watcher.WatcherBase.last_checked" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">last_checked</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#rustfava.core.watcher.WatcherBase.last_checked" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Timestamp of the latest change noticed by the file watcher.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="rustfava.core.watcher.WatcherBase.last_notified" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">last_notified</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#rustfava.core.watcher.WatcherBase.last_notified" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Timestamp of the latest change that the watcher was notified of.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h5 id="rustfava.core.watcher.WatcherBase.update" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">folders</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#rustfava.core.watcher.WatcherBase.update" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Update the folders/files to watch.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>files</code>
            </td>
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of file paths.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>folders</code>
            </td>
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of paths to folders.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/watcher.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span> <span class="n">folders</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the folders/files to watch.</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        files: A list of file paths.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        folders: A list of paths to folders.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.watcher.WatcherBase.check" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check</span><span class="p">()</span></code>

<a href="#rustfava.core.watcher.WatcherBase.check" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Check for changes.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if there was a file change in one of the files or folders,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>False</code> otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/watcher.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="k">def</span><span class="w"> </span><span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check for changes.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        `True` if there was a file change in one of the files or folders,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        `False` otherwise.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">latest_mtime</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_latest_mtime</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_notified</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">has_higher_mtime</span> <span class="o">=</span> <span class="n">latest_mtime</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_checked</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">if</span> <span class="n">has_higher_mtime</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_checked</span> <span class="o">=</span> <span class="n">latest_mtime</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="k">return</span> <span class="n">has_higher_mtime</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="rustfava.core.watcher.WatcherBase.notify" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">notify</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

<a href="#rustfava.core.watcher.WatcherBase.notify" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Notify the watcher of a change to a path.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/watcher.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="k">def</span><span class="w"> </span><span class="nf">notify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Notify the watcher of a change to a path.&quot;&quot;&quot;</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">change_mtime</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime_ns</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">change_mtime</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_notified</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_checked</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">last_notified</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_notified</span><span class="p">,</span> <span class="n">change_mtime</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.watcher.WatchfilesWatcher" class="doc doc-heading">
            <code>WatchfilesWatcher</code>


<a href="#rustfava.core.watcher.WatchfilesWatcher" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="WatcherBase (rustfava.core.watcher.WatcherBase)" href="#rustfava.core.watcher.WatcherBase">WatcherBase</a></code></p>



        <p>A file and folder watcher using the watchfiles library.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/watcher.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="k">class</span><span class="w"> </span><span class="nc">WatchfilesWatcher</span><span class="p">(</span><span class="n">WatcherBase</span><span class="p">):</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A file and folder watcher using the watchfiles library.&quot;&quot;&quot;</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_checked</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_notified</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_paths</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span> <span class="nb">set</span><span class="p">[</span><span class="n">Path</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_WatchfilesThread</span><span class="p">,</span> <span class="n">_WatchfilesThread</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>            <span class="kc">None</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span> <span class="n">folders</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the folders/files to watch.&quot;&quot;&quot;</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="n">files_set</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">files</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">exists</span><span class="p">()}</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="n">folders_set</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">folders</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">is_dir</span><span class="p">()}</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="n">new_paths</span> <span class="o">=</span> <span class="p">(</span><span class="n">files_set</span><span class="p">,</span> <span class="n">folders_set</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span> <span class="ow">and</span> <span class="n">new_paths</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_paths</span><span class="p">:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="k">return</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_paths</span> <span class="o">=</span> <span class="n">new_paths</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span><span class="p">:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="n">_FilesWatchfilesThread</span><span class="p">(</span><span class="n">files_set</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_checked</span><span class="p">),</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="n">_WatchfilesThread</span><span class="p">(</span><span class="n">folders_set</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_checked</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="p">)</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="k">pass</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="n">exc_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">exc_value</span><span class="p">:</span> <span class="ne">BaseException</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">traceback</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">TracebackType</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_latest_mtime</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mtime</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mtime</span><span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.watcher.WatchfilesWatcher.update" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">folders</span><span class="p">)</span></code>

<a href="#rustfava.core.watcher.WatchfilesWatcher.update" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Update the folders/files to watch.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/watcher.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span> <span class="n">folders</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the folders/files to watch.&quot;&quot;&quot;</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="n">files_set</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">files</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">exists</span><span class="p">()}</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="n">folders_set</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">folders</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">is_dir</span><span class="p">()}</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="n">new_paths</span> <span class="o">=</span> <span class="p">(</span><span class="n">files_set</span><span class="p">,</span> <span class="n">folders_set</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span> <span class="ow">and</span> <span class="n">new_paths</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_paths</span><span class="p">:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="k">return</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_paths</span> <span class="o">=</span> <span class="n">new_paths</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span><span class="p">:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">_FilesWatchfilesThread</span><span class="p">(</span><span class="n">files_set</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_checked</span><span class="p">),</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">_WatchfilesThread</span><span class="p">(</span><span class="n">folders_set</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_checked</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="p">)</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_watchers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="rustfava.core.watcher.Watcher" class="doc doc-heading">
            <code>Watcher</code>


<a href="#rustfava.core.watcher.Watcher" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="WatcherBase (rustfava.core.watcher.WatcherBase)" href="#rustfava.core.watcher.WatcherBase">WatcherBase</a></code></p>



        <p>A simple file and folder watcher.</p>
<p>For folders, only checks mtime of the folder and all subdirectories.
So a file change won't be noticed, but only new/deleted files.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/rustfava/core/watcher.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="k">class</span><span class="w"> </span><span class="nc">Watcher</span><span class="p">(</span><span class="n">WatcherBase</span><span class="p">):</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A simple file and folder watcher.</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    For folders, only checks mtime of the folder and all subdirectories.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    So a file change won&#39;t be noticed, but only new/deleted files.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_checked</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_notified</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_folders</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span> <span class="n">folders</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the folders/files to watch.&quot;&quot;&quot;</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_folders</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">folders</span><span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_mtimes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>                <span class="k">yield</span> <span class="n">path</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime_ns</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>                <span class="k">yield</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_notified</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_checked</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_folders</span><span class="p">:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="k">for</span> <span class="n">dirpath</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>                <span class="k">yield</span> <span class="n">Path</span><span class="p">(</span><span class="n">dirpath</span><span class="p">)</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime_ns</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_latest_mtime</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mtimes</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="rustfava.core.watcher.Watcher.update" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">folders</span><span class="p">)</span></code>

<a href="#rustfava.core.watcher.Watcher.update" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Update the folders/files to watch.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/core/watcher.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span> <span class="n">folders</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the folders/files to watch.&quot;&quot;&quot;</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_folders</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">folders</span><span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div><h2 id="application">Application<a class="headerlink" href="#application" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<h2 id="rustfava.application" class="doc doc-heading">
            <code>rustfava.application</code>


<a href="#rustfava.application" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>rustfava's main WSGI application.</p>
<p>you can use <code>create_app</code> to create a rustfava WSGI app for a given list of files.
To start a simple server::</p>
<div class="highlight"><pre><span></span><code>from rustfava.application import create_app

app = create_app([&#39;/path/to/file.beancount&#39;])
app.run(&#39;localhost&#39;, 5000)
</code></pre></div>










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="rustfava.application.static_url" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">static_url</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

<a href="#rustfava.application.static_url" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a static url with an mtime query string for cache busting.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/application.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="k">def</span><span class="w"> </span><span class="nf">static_url</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a static url with an mtime query string for cache busting.&quot;&quot;&quot;</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;static&quot;</span> <span class="o">/</span> <span class="n">filename</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="n">mtime</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">file_path</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime</span><span class="p">))</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">mtime</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="k">return</span> <span class="n">url_for</span><span class="p">(</span><span class="s2">&quot;static&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">mtime</span><span class="o">=</span><span class="n">mtime</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rustfava.application.url_for" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">url_for</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="o">**</span><span class="n">values</span><span class="p">)</span></code>

<a href="#rustfava.application.url_for" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Wrap flask.url_for using a cache.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/application.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="k">def</span><span class="w"> </span><span class="nf">url_for</span><span class="p">(</span><span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrap flask.url_for using a cache.&quot;&quot;&quot;</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="n">_inject_filters</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="k">return</span> <span class="n">_cached_url_for</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="o">**</span><span class="n">values</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rustfava.application.translations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">translations</span><span class="p">()</span></code>

<a href="#rustfava.application.translations" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get translations catalog.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/application.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="k">def</span><span class="w"> </span><span class="nf">translations</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get translations catalog.&quot;&quot;&quot;</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="n">catalog</span> <span class="o">=</span> <span class="n">get_translations</span><span class="p">()</span><span class="o">.</span><span class="n">_catalog</span>  <span class="c1"># noqa: SLF001</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">catalog</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">k</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rustfava.application.create_app" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_app</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">load</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">incognito</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">poll_watcher</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#rustfava.application.create_app" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a rustfava Flask application.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>files</code>
            </td>
            <td>
                  <code><span title="collections.abc.Iterable">Iterable</span>[<span title="pathlib.Path">Path</span> | <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list of Beancount files (paths).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>load</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to load the Beancount files directly.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>incognito</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to run in incognito mode.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>read_only</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to run in read-only mode.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>poll_watcher</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use old poll watcher</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/application.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_app</span><span class="p">(</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="n">files</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>    <span class="n">load</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>    <span class="n">incognito</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>    <span class="n">read_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>    <span class="n">poll_watcher</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Flask</span><span class="p">:</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a rustfava Flask application.</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">        files: The list of Beancount files (paths).</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">        load: Whether to load the Beancount files directly.</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">        incognito: Whether to run in incognito mode.</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">        read_only: Whether to run in read-only mode.</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">        poll_watcher: Whether to use old poll watcher</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>    <span class="n">fava_app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="s2">&quot;rustfava&quot;</span><span class="p">)</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>    <span class="n">fava_app</span><span class="o">.</span><span class="n">register_blueprint</span><span class="p">(</span><span class="n">json_api</span><span class="p">,</span> <span class="n">url_prefix</span><span class="o">=</span><span class="s2">&quot;/&lt;bfile&gt;/api&quot;</span><span class="p">)</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>    <span class="n">fava_app</span><span class="o">.</span><span class="n">json</span> <span class="o">=</span> <span class="n">RustfavaJSONProvider</span><span class="p">(</span><span class="n">fava_app</span><span class="p">)</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>    <span class="n">fava_app</span><span class="o">.</span><span class="n">app_ctx_globals_class</span> <span class="o">=</span> <span class="n">Context</span>  <span class="c1"># type: ignore[assignment]</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>    <span class="n">_setup_template_config</span><span class="p">(</span><span class="n">fava_app</span><span class="p">,</span> <span class="n">incognito</span><span class="o">=</span><span class="n">incognito</span><span class="p">)</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="n">_setup_babel</span><span class="p">(</span><span class="n">fava_app</span><span class="p">)</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>    <span class="n">_setup_filters</span><span class="p">(</span><span class="n">fava_app</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="n">read_only</span><span class="p">)</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>    <span class="n">_setup_routes</span><span class="p">(</span><span class="n">fava_app</span><span class="p">)</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>    <span class="n">fava_app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;HAVE_EXCEL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HAVE_EXCEL</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>    <span class="n">fava_app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;BEANCOUNT_FILES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">]</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>    <span class="n">fava_app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;INCOGNITO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">incognito</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>    <span class="n">fava_app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;LEDGERS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_LedgerSlugLoader</span><span class="p">(</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="n">fava_app</span><span class="p">,</span> <span class="n">load</span><span class="o">=</span><span class="n">load</span><span class="p">,</span> <span class="n">poll_watcher</span><span class="o">=</span><span class="n">poll_watcher</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>    <span class="p">)</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>    <span class="k">return</span> <span class="n">fava_app</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="cli">CLI<a class="headerlink" href="#cli" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<h2 id="rustfava.cli" class="doc doc-heading">
            <code>rustfava.cli</code>


<a href="#rustfava.cli" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>The command-line interface for rustfava.</p>










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="rustfava.cli.main" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">main</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">filenames</span><span class="o">=</span><span class="p">(),</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">incognito</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">profile_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">poll_watcher</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#rustfava.cli.main" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Start Rustfava for FILENAMES on http://<host>:<port>.</p>
<p>If the <code>BEANCOUNT_FILE</code> environment variable is set, Rustfava will use the
files (delimited by ';' on Windows and ':' on POSIX) given there in
addition to FILENAMES.</p>
<p>Note you can also specify command-line options via environment variables
with the <code>RUSTFAVA_</code> prefix. For example, <code>--host=0.0.0.0</code> is equivalent to
setting the environment variable <code>RUSTFAVA_HOST=0.0.0.0</code>.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/rustfava/cli.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">context_settings</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;auto_envvar_prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;RUSTFAVA&quot;</span><span class="p">})</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="nd">@click</span><span class="o">.</span><span class="n">argument</span><span class="p">(</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="s2">&quot;filenames&quot;</span><span class="p">,</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="n">nargs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="nb">type</span><span class="o">=</span><span class="n">click</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">exists</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dir_okay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resolve_path</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="s2">&quot;-p&quot;</span><span class="p">,</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="s2">&quot;--port&quot;</span><span class="p">,</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">default</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">show_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&lt;port&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The port to listen on.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="s2">&quot;-H&quot;</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="s2">&quot;--host&quot;</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">default</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">show_default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;&lt;host&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The host to listen on.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;--prefix&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Set an URL prefix.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="s2">&quot;--incognito&quot;</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">is_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Run in incognito mode and obscure all numbers.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="s2">&quot;--read-only&quot;</span><span class="p">,</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">is_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Run in read-only mode, disable any change through rustfava.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;-d&quot;</span><span class="p">,</span> <span class="s2">&quot;--debug&quot;</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Turn on debugging.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="s2">&quot;--profile&quot;</span><span class="p">,</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">is_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Turn on profiling. Implies --debug.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="p">)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="s2">&quot;--profile-dir&quot;</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="nb">type</span><span class="o">=</span><span class="n">click</span><span class="o">.</span><span class="n">Path</span><span class="p">(),</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Output directory for profiling data.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="s2">&quot;--poll-watcher&quot;</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Use old polling-based watcher.&quot;</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="p">)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="nd">@click</span><span class="o">.</span><span class="n">version_option</span><span class="p">(</span><span class="n">package_name</span><span class="o">=</span><span class="s2">&quot;rustfava&quot;</span><span class="p">)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="n">filenames</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="n">incognito</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="n">read_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="n">profile</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">profile_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="n">poll_watcher</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Start Rustfava for FILENAMES on http://&lt;host&gt;:&lt;port&gt;.</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    If the `BEANCOUNT_FILE` environment variable is set, Rustfava will use the</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    files (delimited by &#39;;&#39; on Windows and &#39;:&#39; on POSIX) given there in</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    addition to FILENAMES.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    Note you can also specify command-line options via environment variables</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    with the `RUSTFAVA_` prefix. For example, `--host=0.0.0.0` is equivalent to</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    setting the environment variable `RUSTFAVA_HOST=0.0.0.0`.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">all_filenames</span> <span class="o">=</span> <span class="n">_add_env_filenames</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">all_filenames</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="k">raise</span> <span class="n">NoFileSpecifiedError</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">rustfava.application</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_app</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">app</span> <span class="o">=</span> <span class="n">create_app</span><span class="p">(</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">all_filenames</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">incognito</span><span class="o">=</span><span class="n">incognito</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="n">read_only</span><span class="o">=</span><span class="n">read_only</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">poll_watcher</span><span class="o">=</span><span class="n">poll_watcher</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="k">if</span> <span class="n">prefix</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">werkzeug.middleware.dispatcher</span><span class="w"> </span><span class="kn">import</span> <span class="n">DispatcherMiddleware</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">rustfava.util</span><span class="w"> </span><span class="kn">import</span> <span class="n">simple_wsgi</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span> <span class="o">=</span> <span class="n">DispatcherMiddleware</span><span class="p">(</span>  <span class="c1"># type: ignore[method-assign]</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>            <span class="n">simple_wsgi</span><span class="p">,</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="p">{</span><span class="n">prefix</span><span class="p">:</span> <span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span><span class="p">},</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="c1"># ensure that cheroot does not use IP6 for localhost</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">host</span> <span class="o">=</span> <span class="s2">&quot;127.0.0.1&quot;</span> <span class="k">if</span> <span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;localhost&quot;</span> <span class="k">else</span> <span class="n">host</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="c1"># Debug mode if profiling is active</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span> <span class="ow">or</span> <span class="n">profile</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting Fava on http://</span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">debug</span><span class="p">:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">cheroot.wsgi</span><span class="w"> </span><span class="kn">import</span> <span class="n">Server</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">),</span> <span class="n">app</span><span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="n">server</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s2">&quot;Keyboard interrupt received: stopping Fava&quot;</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="n">server</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="k">if</span> <span class="s2">&quot;No socket could be created&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>                <span class="k">raise</span> <span class="n">AddressInUse</span><span class="p">(</span><span class="n">port</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">error</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="k">raise</span> <span class="n">click</span><span class="o">.</span><span class="n">Abort</span> <span class="kn">from</span><span class="w"> </span><span class="nn">error</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">werkzeug.middleware.profiler</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProfilerMiddleware</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">rustfava.util</span><span class="w"> </span><span class="kn">import</span> <span class="n">setup_debug_logging</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="n">setup_debug_logging</span><span class="p">()</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="k">if</span> <span class="n">profile</span><span class="p">:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span> <span class="o">=</span> <span class="n">ProfilerMiddleware</span><span class="p">(</span>  <span class="c1"># type: ignore[method-assign]</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>                <span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>                <span class="n">restrictions</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,),</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>                <span class="n">profile_dir</span><span class="o">=</span><span class="n">profile_dir</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>            <span class="p">)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">app</span><span class="o">.</span><span class="n">jinja_env</span><span class="o">.</span><span class="n">auto_reload</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>            <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">debug</span><span class="p">)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>            <span class="k">if</span> <span class="n">error</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errno</span><span class="o">.</span><span class="n">EADDRINUSE</span><span class="p">:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>                <span class="k">raise</span> <span class="n">AddressInUse</span><span class="p">(</span><span class="n">port</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">error</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.sections", "navigation.expand", "content.code.copy"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>